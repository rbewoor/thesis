
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

				EVALUTATION - SURVEY

Hi. As part of my master thesis work, I have created a program to output short stories that accompany some images. I request your help in evaluating the suitability of these stories for an adult versus a young child of around 5-8 years age. On a scale of 0 to 10 with 0 being least and 10 being maximum, please rate each story based on the questions below. Thank you very much for your time.

1) Could this story have been written by a human?
2) Does the story make sense with respect to the accompanying images?
3) Is the story and images suitable for an adult?
4) Is the story and images suitable for a yound child (5-8 years old)?


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

				MIC INPUT AND STT WITH GUI + ID KEYWORDS AND GUI SELECTION + QUERY DB AND GUI IMAGE SELECTION + IMAGE CAPTIONING AND GUI SELECTION

		OPTION 1 - Running with mic input. Specify micYorN parameter = Y.
python3 comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.py -micYorN "Y" -sw_here "/home/rohit/PyWDUbuntu/thesis/audio/wavs/fromMic/" -file4STT "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/mic_input_wavfiles_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -file4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -logfileloc "./LOG_comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.LOG"

		OPTION 2 - Bypass mic input logic, directly execute STT inference logic. Specify micYorN parameter = N.
				   Note that file4STT parameter file MUST exist already and the wav files should be present in the locations specified in this file.
python3 comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.py -micYorN "N" -sw_here "/home/rohit/PyWDUbuntu/thesis/audio/wavs/fromMic/" -file4STT "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/mic_input_wavfiles_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -file4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -logfileloc "./LOG_comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.LOG"



				EXECUTING STORY GENERATOR LOGIC

python3 StyGen_Inference_4A.py -ipf4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -ckptdir "/home/rohit/PyWDUbuntu/thesis/StyGen/checkpoint/" -run "Run2_File11_2_checkpoint_run2" -op_res_file "/home/rohit/PyWDUbuntu/thesis/combined_execution/StyGen/op_sty_gen_1.txt" -logfileloc "./LOG_StyGen_Inference_4A.LOG" -nsamp "1" -batsz "1" -len "300" -temp "0.95" -topk "40"


			TESTING THE FINAL SCRIPT - FOR EVALUATION OF RESULTS

labels = ['aeroplane', 'apple', 'backpack', 'banana', 'baseball bat', 'baseball glove', \
          'bear', 'bed', 'bench', 'bicycle', 'bird', 'boat', 'book', 'bottle', 'bowl', \
          'broccoli', 'bus', 'cake', 'car', 'carrot', 'cat', 'cell phone', 'chair', \
          'clock', 'cow', 'cup', 'diningtable', 'dog', 'donut', 'elephant', 'fire hydrant', \
          'fork', 'frisbee', 'giraffe', 'hair drier', 'handbag', 'horse', 'hot dog', \
          'keyboard', 'kite', 'knife', 'laptop', 'microwave', 'motorbike', 'mouse', \
          'orange', 'oven', 'parking meter', 'person', 'pizza', 'pottedplant', \
          'refrigerator', 'remote', 'sandwich', 'scissors', 'sheep', 'sink', 'skateboard', 'skis', \
          'snowboard', 'sofa', 'spoon', 'sports ball', 'stop sign', 'suitcase', 'surfboard', \
          'teddy bear', 'tennis racket', 'tie', 'toaster', 'toilet', 'toothbrush', 'traffic light', \
          'train', 'truck', 'tvmonitor', 'umbrella', 'vase', 'wine glass', 'zebra']


					THESIS_INPUT_1
					THESIS_INPUT_1
					THESIS_INPUT_1
				Sentences without pronouns linking the sentences.
				Sentences are coherent progressively.
		
A person reads a book.
Next the person plays video games on his television monitor
A dining table with lots of food.

mic_stt_module_results = ['a person reads a book', 'next the person plays video games on his tvmonitor', 'a diningtable with lord of food']

id_elements_module_results = [['person', 'book'], ['person', 'tvmonitor']]

				Sent 3 has no hits from neo4j
			Images selected:
			2 retained of 20 from Sent 1, 3 retained of 20 from sent 2, no images returned for sent 3 from db
		db image selection
	Sent 1:
000000467509.jpg
000000415683.jpg

	Sent 2:
000000214645.jpg
000000438521.jpg
000000287296.jpg

	Sent 1:
	------ Query images info AFTER::
[{'Image': '000000467509.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000415683.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000473668.jpg', 'Source': 'coco_test_2017'}, {'Image': '352023925.jpg', 'Source': 'flickr30k'}, {'Image': '4748496940.jpg', 'Source': 'flickr30k'}]
	Sent 2:
	------ Query images info AFTER::
[{'Image': '000000369555.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000214645.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000382917.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000438521.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000287296.jpg', 'Source': 'coco_test_2017'}]


			NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.
			Selections made: 
			Sent 1: 2 of 2 images retained
			Sent 2: 3 of 3 images retained
			Sent 3: NA

		caption selection with NO editing
Sent 1: ['book', 'person']
Sent_1 - Img_1 : COCO_test/000000467509.jpg
Orig_No_Attn: 'woman is sitting on couch with her cell phone'
Orig_WITH_Attn: 'a man sitting on a couch with a laptop'
Sent_1 - Img_2 : COCO_test/000000415683.jpg
Orig_No_Attn: 'woman is cutting cake with knife'
Orig_WITH_Attn: 'a man is sitting at a book on a book'


Sent 2: ['tvmonitor', 'person']
Sent_2 - Img_1 : COCO_test/000000214645.jpg
Orig_No_Attn: 'man and woman playing video game together'
Orig_WITH_Attn: 'a woman is cutting a remote and a woman'
Sent_2 - Img_2 : COCO_test/000000438521.jpg
Orig_No_Attn: 'man and woman are playing video game'
Orig_WITH_Attn: 'two men playing wii in a living room'
Sent_2 - Img_3 : COCO_test/000000287296.jpg
Orig_No_Attn: 'young boy standing in front of tv playing video game'
Orig_WITH_Attn: 'a man playing a game with a wii remote'


gui_img_cap_module_results =
[{'key_elements': ['book', 'person'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000467509.jpg', 'woman is sitting on couch with her cell phone'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000415683.jpg', 'woman is cutting cake with knife']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000467509.jpg', 'a man sitting on a couch with a laptop'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000415683.jpg', 'a man is sitting at a book on a book']]}, {'key_elements': ['tvmonitor', 'person'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000214645.jpg', 'man and woman playing video game together'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000438521.jpg', 'man and woman are playing video game'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000287296.jpg', 'young boy standing in front of tv playing video game']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000214645.jpg', 'a woman is cutting a remote and a woman'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000438521.jpg', 'two men playing wii in a living room'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000287296.jpg', 'a man playing a game with a wii remote']]}]


			WITH CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.
			Selections made: same as in case of no corrections

		caption selection WITH editing
Sent 1: ['book', 'person']
Sent_1 - Img_1 : COCO_test/000000467509.jpg
Orig_No_Attn: 'woman is sitting on couch with her cell phone'
Edited_No_Attn: 'a woman is sitting on a couch with a book'
Orig_WITH_Attn: 'a man sitting on a couch with a laptop'
Edited_WITH_Attn: 'a woman sitting on a couch with a book'
Sent_1 - Img_2 : COCO_test/000000415683.jpg
Orig_No_Attn: 'woman is cutting cake with knife'
Edited_No_Attn: 'a girl is reading a book'
Orig_WITH_Attn: 'a man is sitting at a book on a book'
Edited_WITH_Attn: 'a girl is reading a book'

Sent 2: ['tvmonitor', 'person']
Sent_2 - Img_1 : COCO_test/000000214645.jpg
Orig_No_Attn: 'man and woman playing video game together'
Edited_No_Attn: 'an old man and an old woman are playing a video game together'
Orig_WITH_Attn: 'a woman is cutting a remote and a woman'
Edited_WITH_Attn: 'a woman is playing a video game'
Sent_2 - Img_2 : COCO_test/000000438521.jpg
Orig_No_Attn: 'man and woman are playing video game'
Edited_No_Attn: 'a man and his friend are playing a video game'
Orig_WITH_Attn: 'two men playing wii in a living room'
Edited_WITH_Attn: 'two men are playing a wii video game in a living room'
Sent_2 - Img_3 : COCO_test/000000287296.jpg
Orig_No_Attn: 'young boy standing in front of tv playing video game'
Edited_No_Attn: 'a young girl is standing in front of a tv playing a video game'
Orig_WITH_Attn: 'a man playing a game with a wii remote'
Edited_WITH_Attn: 'a girl is playing a video game with a wii remote'

gui_img_cap_module_results =
[{'key_elements': ['person', 'book'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000467509.jpg', 'a woman is sitting on a couch with a book'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000415683.jpg', 'a girl is reading a book']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000467509.jpg', 'a woman sitting on a couch with a book'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000415683.jpg', 'a girl is reading a book']]}, {'key_elements': ['person', 'tvmonitor'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000214645.jpg', 'an old man and an old woman are playing a video game together'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000438521.jpg', 'a man and his friend are playing a video game'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000287296.jpg', 'a young girl is standing in front of a tv playing a video game']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000214645.jpg', 'a woman is playing a video game'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000438521.jpg', 'two men are playing a wii video game in a living room'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000287296.jpg', 'a girl is playing a video game with a wii remote']]}]






					THESIS_INPUT_2
					THESIS_INPUT_2
					THESIS_INPUT_2
		Totally unrelated sentences.
		Agains sentences without pronouns.
		
Some persons are standing near a truck.
A person goes riding on a bicylcle.
Some persons are eating a pizza together.

mic_stt_module_results = ['some persons are standing near a truck', 'a person goes riding on a bicycle', 'some persons are eating a pizza together']

id_elements_module_results = [['person', 'truck'], ['bicycle', 'person'], ['person', 'pizza']]

			All queries had hits returned from neo4j
			Images selected:
			5 of 20 retained from Sent 1, 5 of 20 retained from sent 2, 5 of 20 retained from sent 3
		db image selection
	Sent 1:
000000169542.jpg
000000526988.jpg
000000079789.jpg
000000121451.jpg
000000279257.jpg

	Sent 2:
000000155758.jpg
000000503231.jpg
000000214602.jpg
000000499654.jpg
000000056139.jpg

	Sent 3:
000000492564.jpg
000000469453.jpg
000000254053.jpg
000000005354.jpg
000000160075.jpg

	Sent 1:
	------ Query images info AFTER::
[{'Image': '000000169542.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000526988.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000079789.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000121451.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000279257.jpg', 'Source': 'coco_test_2017'}]
	Sent 2:
	------ Query images info AFTER::
[{'Image': '000000155758.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000503231.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000214602.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000499654.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000056139.jpg', 'Source': 'coco_test_2017'}]
	Sent 3:
[{'Image': '000000492564.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000469453.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000254053.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000005354.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000160075.jpg', 'Source': 'coco_test_2017'}]




			NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.
			Selections made: 
			Sent 1: 2 of 5 images retained
			Sent 2: 2 of 5 images retained
			Sent 3: 3 of 5 images selected

		caption selection with NO editing
Sent 1: ['person', 'truck']
Sent_1 - Img_1 : COCO_test/000000121451.jpg
Orig_No_Attn: 'truck is parked in front of building'
Orig_WITH_Attn: 'a man standing next to a large truck'
Sent_1 - Img_2 : COCO_test/000000279257.jpg
Orig_No_Attn: ''group of people standing next to each other on street'
Orig_WITH_Attn: 'a man standing outside a food truck'

Sent 2: ['bicycle', 'person']
Sent_2 - Img_1 : COCO_test/000000155758.jpg
Orig_No_Attn: 'man riding bike on the side of the road'
Orig_WITH_Attn: 'a man and woman are riding a bike with a dog'
Sent_2 - Img_2 : COCO_test/000000503231.jpg
Orig_No_Attn: 'person riding bike on the side of the road'
Orig_WITH_Attn: 'a man on a bike down a bike'

Sent 3: ['pizza', 'person']
Sent_3 - Img_1 : COCO_test/000000469453.jpg
Orig_No_Attn: 'woman sitting at table with pizza and drink'
Orig_WITH_Attn: 'a group of people sitting at a table with a plate of food'
Sent_3 - Img_2 : COCO_test/000000005354.jpg
Orig_No_Attn: 'group of people sitting at table with plates of food'
Orig_WITH_Attn: 'a group of people sitting at a table with pizza'
Sent_3 - Img_3 : COCO_test/000000160075.jpg
Orig_No_Attn: 'group of people sitting at table with pizza'
Orig_WITH_Attn: 'a group of people sitting at a table eating pizza'


gui_img_cap_module_results =
[{'key_elements': ['person', 'truck'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000121451.jpg', 'truck is parked in front of building'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000279257.jpg', 'group of people standing next to each other on street']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000121451.jpg', 'a man standing next to a large truck'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000279257.jpg', 'a man standing outside a food truck']]}, {'key_elements': ['bicycle', 'person'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155758.jpg', 'man riding bike on the side of the road'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000503231.jpg', 'person riding bike on the side of the road']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155758.jpg', 'a man and woman are riding a bike with a dog'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000503231.jpg', 'a man on a bike down a bike']]}, {'key_elements': ['pizza', 'person'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000469453.jpg', 'woman sitting at table with pizza and drink'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000005354.jpg', 'group of people sitting at table with plates of food'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000160075.jpg', 'group of people sitting at table with pizza']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000469453.jpg', 'a group of people sitting at a table with a plate of food'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000005354.jpg', 'a group of people sitting at a table with pizza'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000160075.jpg', 'a group of people sitting at a table eating pizza']]}]


			WITH CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.		NO CORRECTIONS TO CAPTIONS.
			Selections made: same as in case of no corrections
			Sent 1: 2 of 5 images retained
			Sent 2: 2 of 5 images retained
			Sent 3: 3 of 5 images selected

		caption selection with editing
Sent 1: ['person', 'truck']
Sent_1 - Img_1 : COCO_test/000000121451.jpg
Orig_No_Attn: 'truck is parked in front of building'
Edited_No_Attn: 'persons are standing next to a truck parked in front of a building'
Orig_WITH_Attn: 'a man standing next to a large truck'
Edited_WITH_Attn: 'a group of men standing next to a large truck'
Sent_1 - Img_2 : COCO_test/000000279257.jpg
Orig_No_Attn: 'group of people standing next to each other on street'
Edited_No_Attn: 'a group of people standing around a truck'
Orig_WITH_Attn: 'a man standing outside a food truck'
Edited_WITH_Attn: 'a group of people standing outside a food truck'

Sent 2: ['bicycle', 'person']
Sent_2 - Img_1 : COCO_test/000000155758.jpg
Orig_No_Attn: 'man riding bike on the side of the road'
Edited_No_Attn: 'a man is riding a bike down a road'
Orig_WITH_Attn: 'a man and woman are riding a bike with a dog'
Edited_WITH_Attn: 'a man and child are riding a bike and there are some dogs far behind'
Sent_2 - Img_2 : COCO_test/000000503231.jpg
Orig_No_Attn: 'person riding bike on the side of the road'
Edited_No_Attn: 'a person is riding a bike on the side of the road'
Orig_WITH_Attn: 'a man on a bike down a bike'
Edited_WITH_Attn: 'a man on a bike down a road'

Sent 3: ['pizza', 'person']
Sent_3 - Img_1 : COCO_test/000000469453.jpg
Orig_No_Attn: 'woman sitting at table with pizza and drink'
Edited_No_Attn: 'two women are sitting at a table with pizza and drink'
Orig_WITH_Attn: 'a group of people sitting at a table with a plate of food'
Edited_WITH_Attn: 'a group of people sitting at a table with a plate of food'
Sent_3 - Img_2 : COCO_test/000000005354.jpg
Orig_No_Attn: 'group of people sitting at table with plates of food'
Edited_No_Attn: 'a group of people sitting at a table with plates of food'
Orig_WITH_Attn: 'a group of people sitting at a table with pizza'
Edited_WITH_Attn: NO EDITING DONE AT ALL: 'a group of people sitting at a table with pizza'
Sent_3 - Img_3 : COCO_test/000000160075.jpg
Orig_No_Attn: 'group of people sitting at table with pizza'
Edited_No_Attn: 'a group of people sitting at a table with pizza'
Orig_WITH_Attn: 'a group of people sitting at a table eating pizza'
Edited_WITH_Attn: NO EDITING DONE AT ALL: 'a group of people sitting at a table eating pizza'

gui_img_cap_module_results =
[{'key_elements': ['person', 'truck'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000121451.jpg', 'persons are standing next to a truck parked in front of a building'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000279257.jpg', 'a group of people standing around a truck']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000121451.jpg', 'a group of men standing next to a large truck'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000279257.jpg', 'a group of people standing outside a food truck']]}, {'key_elements': ['bicycle', 'person'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155758.jpg', 'a man is riding a bike down a road'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000503231.jpg', 'a person is riding a bike on the side of the road']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155758.jpg', 'a man and child are riding a bike and there are some dogs far behind'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000503231.jpg', 'a man on a bike down a road']]}, {'key_elements': ['person', 'pizza'], 'selected_images_no_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000469453.jpg', 'two women are sitting at a table with pizza and drink'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000005354.jpg', 'a group of people sitting at a table with plates of food'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000160075.jpg', 'a group of people sitting at a table with pizza']], 'selected_images_with_attn': [['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000469453.jpg', 'a group of people sitting at a table with a plate of food'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000005354.jpg', 'a group of people sitting at a table with pizza'], ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000160075.jpg', 'a group of people sitting at a table eating pizza']]}]




xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx



					https://www.kaggle.com/questions-and-answers/88728

import smtplib
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication
from email.mime.multipart import MIMEMultipart
from email.header import Header

def send_email(filename):
    sender = 'xxxx@xx.com' # your email address
    receivers = ['xxxx@xx.com']
    mail_host = 'smtp.xx.com' # check your email provider's doc
    mail_host_port = 123

    # email and passwd
    mail_user = 'xxxx@xx.com' # your email address
    mail_pass = 'qwert12345' # password

    # email
    message = MIMEMultipart()
    message['To'] =  Header('xxxx', 'utf-8') # receive's name, optional
    message['Subject'] = Header('xxxx', 'utf-8') # email subject
    message.attach(MIMEText('xxxx', 'plain', 'utf-8')) # email body

    # attachment
    att1 = MIMEApplication(open(filename, 'rb').read())
    att1.add_header('Content-Disposition', 'attachment', filename=filename)
    # att1['Content-Type'] = 'application/octet-stream'
    # att1["Content-Disposition"] = 'attachment; filename="simnet.pt"'
    message.attach(att1)

    try:
        smtpObj = smtplib.SMTP_SSL()
        smtpObj = smtplib.SMTP_SSL(mail_host,  mail_host_port)
        smtpObj.helo(mail_host)
        smtpObj.ehlo(mail_host)
        smtpObj.login(mail_user, mail_pass)  
        smtpObj.sendmail(sender, receivers, message.as_string())
    except smtplib.SMTPException:
        print('failed!')
    else:
        print('email sent!')



					https://www.siteground.com/kb/google_free_smtp_server/
Google SMTP server - how to send emails for free?
Google’s Gmail SMTP server is a free SMTP service which anyone who has a Gmail account can use to send emails. You can use it with personal emails, or even with your website if you are sending emails for things such as contact forms, newsletter blasts, or notifications.

To use Gmail’s SMTP server, the following settings are needed for your outgoing emails:

Outgoing Mail (SMTP) Server: smtp.gmail.com
Use Authentication: Yes
Use Secure Connection: Yes (TLS or SSL depending on your mail client/website SMTP plugin)
Username: your Gmail account (e.g. user@gmail.com)
Password: your Gmail password
Port: 465 (SSL required) or 587 (TLS required)





EMAIL FAILED - SMTPException - for epoch 9
(534, b'5.7.14 <https://accounts.google.com/signin/continue?sarp=1&scc=1&plt=AKgnsbt\n5.7.14 WnXOgN54fvA6gMPuhfu59xDS8jV6UE08ziO8BLGkPj8lJv3-g7M6Ew3xsUD656QMQUwqp\n5.7.14 pFtnzjuCxNXZMNiMmNKKtSupBJGhyp-KsotW_oUWzKFlf84aIMaMRkT1IcqKjcMK>\n5.7.14 Please log in via your web browser and then try again.\n5.7.14  Learn more at\n5.7.14  https://support.google.com/mail/answer/78754 u141sm234134vsc.2 - gsmtp')




Incoming Mail (IMAP) Server	
imap.gmail.com

Requires SSL: Yes

Port: 993

Outgoing Mail (SMTP) Server	
smtp.gmail.com

Requires SSL: Yes

Requires TLS: Yes (if available)

Requires Authentication: Yes

Port for SSL: 465

Port for TLS/STARTTLS: 587

Full Name or Display Name	Your name
Account Name, User name, or Email address	Your full email address
Password	Your Gmail password




			TAR last level folder contents

rohit@rohitu2004lts:~/Desktop/checkpoints_run4_TRAIN/kaggle/working$ tar -cvzf /home/rohit/Desktop/Thesis_ImgCapATTENTION_ChkPts_In_Run4_Ep19.tar.gz chkpt_out
chkpt_out/
chkpt_out/ckpt-18.index
chkpt_out/checkpoint
chkpt_out/ckpt-15.data-00000-of-00001
chkpt_out/ckpt-19.data-00000-of-00001
chkpt_out/ckpt-17.index
chkpt_out/ckpt-19.index
chkpt_out/ckpt-16.data-00000-of-00001
chkpt_out/ckpt-16.index
chkpt_out/ckpt-15.index
chkpt_out/ckpt-17.data-00000-of-00001
chkpt_out/ckpt-18.data-00000-of-00001
rohit@rohitu2004lts:~/Desktop/checkpoints_run4_TRAIN/kaggle/working$ 









			FIND NUMBER OF FILES WHERE HUGE NUMBER OF FILES AND SO SIMPLY DOING
ls *.jpg | wc -l		FAILS
	had to do like this
find /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k/ -name "*.npy" | xargs -i ls {} | wc -l

			COPY HUGE NUMBER OF FILES FROM SOURCE TO DEST FOLDER
	first tried normal cp command
cp /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCapAttention/SavedData/Thesis_ImgCapATTENTION_saved_encodings_TRAIN/*.npy /media/rohit/DATA/EverythingDf/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k
	but got below error
bash: /bin/cp: Argument list too long
	had to do this method
find source/ -name "*.txt" | xargs -i cp {} target/

		source folder = 97000 .npy files of the saved encodings
		dest folder initially = 118287 jpg (all the coco 2017 train images)
		after copy, dest folder has = 118287 + 97000 = 215287 files as expected

find /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCapAttention/SavedData/Thesis_ImgCapATTENTION_saved_encodings_TRAIN/ -name "*.npy" | xargs -i cp {} /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k/


			REMOVE HUGE NUMBER OF FILES FROM FOLDER
find /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k/ -name "*.npy" | xargs -i rm {}

find /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k/ -name "*.npy" | xargs -i cp {} /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCapAttention/SavedData/saved_encd_ATTEND_CocoTrain_118k/

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

multiprocessing package check:
RQ: https://pypi.org/project/multi-rq/
workflows
celery

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		UPLOAD TO GOOGLE DRIVE
		
		40670 in /media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017

python3 test_gdrive_upload_1.py

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		SIDDY notebook
%cd "/content/gdrive/My Drive/ThesisStoryGen/Data"
import os
os.mkdir('coco_val_2017')
%cd "coco_val_2017"
!sudo wget http://images.cocodataset.org/zips/val2017.zip
!ls
!unzip val2017.zip
!ls
%cd val2017/
len(os.listdir(os.getcwd()))



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		STT USING DEEPSPEECH

	version 0.7.3
https://deepspeech.readthedocs.io/en/v0.7.3/?badge=latest

# Create anaconda env
conda create -n ce4ds1 python=3.7
	# Create and activate a virtualenv
	virtualenv -p python3 $HOME/tmp/deepspeech-venv/
	source $HOME/tmp/deepspeech-venv/bin/activate
			
conda install jupyter
(ce4ds1) rohit@rohitu2004lts:~$ pip install deepspeech
Collecting deepspeech
  Downloading deepspeech-0.7.3-cp37-cp37m-manylinux1_x86_64.whl (9.7 MB)
     |████████████████████████████████| 9.7 MB 7.7 MB/s 
Collecting numpy>=1.14.5
  Downloading numpy-1.18.5-cp37-cp37m-manylinux1_x86_64.whl (20.1 MB)
     |████████████████████████████████| 20.1 MB 282 kB/s 
Installing collected packages: numpy, deepspeech
Successfully installed deepspeech-0.7.3 numpy-1.18.5
(ce4ds1) rohit@rohitu2004lts:~$
# Download pre-trained English model files
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.7.3/deepspeech-0.7.3-models.pbmm
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.7.3/deepspeech-0.7.3-models.scorer

		INFERENCE comamnd
deepspeech --model /home/rohit/deepspeech/pretrained/v073/deepspeech-0.7.3-models.pbmm --scorer /home/rohit/deepspeech/pretrained/v073/deepspeech-0.7.3-models.scorer --audio /home/rohit/PyWDUbuntu/thesis/audio/wavs/input1.wav

input1.wav
Make me a story about persons sitting at a table. They are playing cards.
INFERENCE: me me a tory about persons sitting at table the blanchards

input2.wav
I want a story about a car on the road. A child plays with a toy.
INFERENCE: i want a story about a car on the road a child plays with a toy

input3.wav
Generate a story about persons walking on the street. A truck is on the road.
INFERENCE: generate a story about persons walking on the street a truck is on the road


			stt_wav_files_loc_1.txt  contents
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input1.wav
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input2.wav
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input3.wav

python3 stt_transcribe_1.py -wavlocfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_wav_files_loc_1.txt" -opfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt"





xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		OBJECT DETECTION WITH YOLOV3

https://medium.com/data-science-in-your-pocket/all-about-yolo-object-detection-and-its-3-versions-paper-summary-and-codes-2742d24f56e

Different Versions
								VERSION 1
YOLO requires a Neural Network framework for training and for this we have used DarkNet.The first version has 26 layers in total, with 24 Convolution Layers followed by 2 Fully Connected layers. The major problem with YOLOv1 is its inability to detect very small objects.

After the first version, 2 more versions for YOLO released that are:

YOLO9000 / YOLOv2:				VERSION 2
Inclusion of batch Normalization layers after each Conv Layer
It has 30 layers in comparison to YOLO v1 26 layers.
Anchor Boxes were introduced.
Anchor boxes are predefined boxes provided by the user to Darknet which gives the network an idea about the relative position and dimensions of the objects to be detected. It has to be calculated using the training set Objects.
No fully connected layer present
Random dimensions were taken for training images ranging from 320–608
Multiple labels might be provided to the same objects, but still a multiclass problem(WordTree concept) i.e either the parent or child be the final label and not both.
Still bad with small objects

								VERSION 3
YOLOv3:
106 layers neural network
Detection on 3 scales for detecting objects of small to very large size
9 anchor boxes taken; 3 per scale. Hence more bounding boxes are predicted than YOLO9000 & YOLOv1
MultiClass problem turned in MultiLabel problem
Certain changes in the Error function.
Quite good with small objects


https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/

The “You Only Look Once,” or YOLO, family of models are a series of end-to-end deep learning models designed for fast object detection, developed by Joseph Redmon, et al. and first described in the 2015 paper titled “You Only Look Once: Unified, Real-Time Object Detection.”

The approach involves a single deep convolutional neural network (originally a version of GoogLeNet, later updated and called DarkNet based on VGG) that splits the input into a grid of cells and each cell directly predicts a bounding box and object classification. The result is a large number of candidate bounding boxes that are consolidated into a final prediction by a post-processing step.

There are three main variations of the approach, at the time of writing; they are YOLOv1, YOLOv2, and YOLOv3. The first version proposed the general architecture, whereas the second version refined the design and made use of predefined anchor boxes to improve bounding box proposal, and version three further refined the model architecture and training process.

Although the accuracy of the models is close but not as good as Region-Based Convolutional Neural Networks (R-CNNs), they are popular for object detection because of their detection speed, often demonstrated in real-time on video or with camera feed input.

			using KERAS for YOLOv3

Instead of developing this code from scratch, we can use a third-party implementation. There are many third-party implementations designed for using YOLO with Keras, and none appear to be standardized and designed to be used as a library.

The YAD2K project was a de facto standard for YOLOv2 and provided scripts to convert the pre-trained weights into Keras format, use the pre-trained model to make predictions, and provided the code required to distill interpret the predicted bounding boxes. Many other third-party developers have used this code as a starting point and updated it to support YOLOv3.

Perhaps the most widely used project for using pre-trained the YOLO models is called “keras-yolo3: Training and Detecting Objects with YOLO3” by Huynh Ngoc Anh or experiencor. The code in the project has been made available under a permissive MIT open source license. Like YAD2K, it provides scripts to both load and use pre-trained YOLO models as well as transfer learning for developing YOLOv3 models on new datasets.

He also has a keras-yolo2 project that provides similar code for YOLOv2 as well as detailed tutorials on how to use the code in the repository. The keras-yolo3 project appears to be an updated version of that project.

We will use experiencor’s keras-yolo3 project as the basis for performing object detection with a YOLOv3 model in this tutorial.


			yolo3_one_file_to_detect_them_all.py           - directly create a model and use it
In this section, we will use a pre-trained model to perform object detection on an unseen photograph. This capability is available in a single Python file in the repository called “yolo3_one_file_to_detect_them_all.py” that has about 435 lines. This script is, in fact, a program that will use pre-trained weights to prepare a model and use that model to perform object detection and output a model. It also depends upon OpenCV.



			get the pre-trained weights file for YOLOv3
From this link: https://pjreddie.com/media/files/yolov3.weights
/home/rohit/PyWDUbuntu/DA4_1/keras-yolo3-master/yoloWeights/yolov3.weights

Images to detect are here:
/home/rohit/PyWDUbuntu/DA4_1/Imgs2Detect/


			ENVIRONMENT SETUP - ANACONDA - for only neo4j db writing
conda create -n ce2da41 python=3.7
conda install jupyter
conda install pandas
pip install neo4j
conda install pytz
conda install -c conda-forge opencv   ## used opencv 3.4.2
conda install keras
conda install pydot

			env yml file using conda tool
Output of: conda env export

			MULTI processing		MULTI processing		MULTI processing		MULTI processing		MULTI processing


python3 TEST_yolo3_process_coco_py2neo_multiproc_1.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect -isrc coco80 -sf 2 -nipt 2 -opfilelocneo home/rohit/PyWDUbuntu/thesis/Imgs2Detect_op4neo

python3 TEST_yolo3_process_coco_py2neo_multiproc_3.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect -isrc coco80 -sf 2 -nipt 4 -opfilelocneo home/rohit/PyWDUbuntu/thesis/Imgs2Detect_op4neo

		use version 4 to only save the model
python3 TEST_yolo3_process_coco_py2neo_multiproc_4.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3.saved.model

		use version 5 as multiprocessing using reloaded model
python3 TEST_yolo3_process_coco_py2neo_multiproc_5.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3.saved.model -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect -isrc coco80 -sf 5 -nipt 4 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_op4neo
---------------------------------------------------------------------------------------------------------------------------------------------
	
		BUILD AND SAVE MODEL
python3 detection_yolov3_build_save_model_1.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3.saved.model

		MULTIPROCESSING PROCESS IMAGES AND SAVE JOB NEO ARRAYS
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3.saved.model -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more -isrc coco80 -sf 3 -nipt 20 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more_op4neo

		PICK SAVED NEO ARRAYS OF JOBS AND UPDATE NEO4J GRAPH DB
python3 detection_update_neo_1.py -sf 3 -iploc /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more_op4neo

python3 detection_update_neo_1.py -sf 20 -iploc /home/rohit/PyWDUbuntu/thesis/COCO_val2017_5k_images_op4neo

python3 detection_update_neo_1.py -sf 20 -iploc /home/rohit/PyWDUbuntu/thesis/flickr30k_images_op4neo


/home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more

    savedmodelpath = args.savedmodelpath       # -smp parameter, location of the saved kears model for pre-trained yolov3 model
    image_path     = args.imagefolder          # -if parameter, where to pick the images from to process
    img_dataset    = args.imgsource            # -isrc parameter, image node property value for dataset
    status_freq    = args.statusfrequency      # -sf parameter, after how many images info is processed for neo4j inserts should a status message be shown
    nipt           = args.numberimagespertask  # -nipt parameter, how many images files to be processed in each task
    opfilelocneo   = args.ouputfilelocationneo # -opfileneo parameter, location where dump of neo4j array of each task should be written to file
---------------------------------------------------------------------------------------------------------------------------------------------
			TEST on small set of 127 images
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more" -isrc coco80 -sf 2 -nipt 5 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more_op4neo


			FLICKR data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/flickr30k_images/flickr30k_images" : 31783 images
			CHANGE THE dataset property to flickr30k
			/home/rohit/PyWDUbuntu/thesis/flickr30k_images_op4neo
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/flickr30k_images/flickr30k_images" -isrc flickr30k -sf 25 -nipt 250 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/flickr30k_images_op4neo


			COCO VAL 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_val2017_5k/val2017" : 5000 images
			/home/rohit/PyWDUbuntu/thesis/COCO_val2017_5k_images_op4neo
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_val2017_5k/val2017" -isrc coco_val_2017 -sf 25 -nipt 125 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/COCO_val2017_5k_images_op4neo


			COCO VAL 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 40670 images
		on PC
			/home/rohit/PyWDUbuntu/thesis/COCO_test2017_40k_images_op4neo
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf x -nipt x -opfilelocneo /home/rohit/PyWDUbuntu/thesis/COCO_test2017_40k_images_op4neo


			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 5000 images
			10k to 15k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_10k_15k
python3 detection_yolo3_process_images_multiproc_1_cocotest_10k_15k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_10k_15k


			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 5000 images
			15k to 20k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_15k_20k
python3 detection_yolo3_process_images_multiproc_1_cocotest_15k_20k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 100 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_15k_20k

			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 5000 images
			20k to 25k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_20k_25k
python3 detection_yolo3_process_images_multiproc_1_cocotest_20k_25k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 100 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_20k_25k

			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 10000 images
			25k to 35k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_25k_35k
python3 detection_yolo3_process_images_multiproc_1_cocotest_25k_35k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 100 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_25k_35k

			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 5000 images
			5k to 10k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_5k_10k
python3 detection_yolo3_process_images_multiproc_1_cocotest_20k_25k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 100 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_5k_10k

			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 10000 images
			1 to 10k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_1_10k
python3 detection_yolo3_process_images_multiproc_1_cocotest_1_10k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 100 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_1_10k

			COCO TEST 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" : 5000 images
			35k to 40k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_1_10k
python3 detection_yolo3_process_images_multiproc_1_cocotest_35k_40k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017" -isrc coco_test_2017 -sf 10 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_test_2017_40k_images_op4neo_1_35k_40k


			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 10000 images
			1 to 10k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_1_10k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_1_20k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_1_10k

			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 10000 images
			10k to 20k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_10k_20k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_10k_20k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_10k_20k

			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 5000 images
			20k to 25k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_20k_25k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_25k_35k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_20k_25k

			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 5000 images
			25k to 30k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_25k_30k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_25k_30k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_25k_30k

			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 5000 images
			30k to 35k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_30k_35k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_30k_35k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_30k_35k

			COCO TRAIN 2017 data set processing : "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" : 5000 images
			35k to 40k
		on PC
			/home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_35k_40k
python3 detection_yolo3_process_images_multiproc_1_cocotrain_35k_40k.py -smp /home/rohit/PyWDUbuntu/thesis/saved_keras_model/yolov3_coco80.saved.model -if "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_train2017_118k" -isrc coco_train_2017 -sf 15 -nipt 50 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/coco_train_2017_118k_images_op4neo_1_35k_40k


		on Google COLAB
			/home/rohit/PyWDUbuntu/thesis/COCO_test2017_40k_images_op4neo
-smp r"/content/gdrive/My Drive/ThesisStoryGen/Data/saved_keras_model/yolov3_coco80.saved.model"
-if r"/content/gdrive/My Drive/ThesisStoryGen/Data/coco_test2017_wget_1/test2017"
-isrc r"coco_test_2017"
-if r"/content/gdrive/My Drive/ThesisStoryGen/Data/Imgs2Detect"
-isrc r"testrun"
-sf 10
-nipt 100
-opfilelocneo r"/content/gdrive/My Drive/ThesisStoryGen/Data/coco_test_2017_40k_images_op4neo"
-opfilelocneo r"/content/gdrive/My Drive/ThesisStoryGen/Data/Imgs2Detect_op4neo"


					INSERT TO Neo4j
		FLICKR30K
python3 detection_update_neo_2.py -sf 25 -iploc /home/rohit/PyWDUbuntu/thesis/flickr30k_images_op4neo_corrected

		COCO VAL 5K
python3 detection_update_neo_2.py -sf 25 -iploc /home/rohit/PyWDUbuntu/thesis/COCO_val2017_5k_images_op4neo


		COCO TEST 41K
	coco_test_2017_40k_images_op4neo_1_1_10k
	coco_test_2017_40k_images_op4neo_1_10k_15k
	coco_test_2017_40k_images_op4neo_1_15k_20k
	coco_test_2017_40k_images_op4neo_1_20k_25k
	coco_test_2017_40k_images_op4neo_1_25k_35k
	coco_test_2017_40k_images_op4neo_1_35k_40k
python3 detection_update_neo_2.py -sf 25 -iploc coco_test_2017_40k_images_op4neo_1_15k_20k



			SINGLE processing		SINGLE processing		SINGLE processing		SINGLE processing		SINGLE processing
python3 TEST_yolo3_process_coco_py2neo_2.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect -isrc coco80 -sf 2

python3 TEST_yolo3_process_coco_py2neo_2.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect_more -isrc coco80 -sf 5
	Yolo processing stats:
	Total images = 127
	Success = 111
	Failed = 16
	After inserting 111 images info in Neo: Image nodes = 111, Object nodes = 37, HAS = 596

Yolo inference and Neo4j inserts
Inference on images with Yolo v3
All images in specified input folder processed.
May fail during pre-process step due to image size issued and such images will be rejected.
Successfully processed image results inserted to Neo4j db


python3 TEST_yolo3_process_coco_py2neo_3.py -w /home/rohit/PyWDUbuntu/thesis/yoloWeights/yolov3.weights -if /home/rohit/PyWDUbuntu/thesis/Imgs2Detect -isrc coco80 -sf 2

		my model visualize script    my_yolo3_model_stats_1.py
python3 my_yolo3_model_stats_1.py -w /home/rohit/PyWDUbuntu/DA4_1/keras-yolo3-master/yoloWeights/yolov3.weights


Visualize model with Keras tools.
Using functions:
plot_model() to save as png image file.
model.summary() for textual description (to console and to a file).


		Output of plot_model function
Output of plot_model function

		Output of model.summary function
Output of model.summary function captured to file.


		data structure to hold info for neo4j
# Info about objects detected to be stored in a multi-dimensional array.
# E.g. suppose two images, each image with two objects detected will be stored as:
# [{"img_name": "img1.jpg", "detections": [["label1", "label1_score"], ["label2", "label2_score"] ] } ,
#  {"img_name": "img2.jpg", "detections": [["label3", "label3_score"], ["label4", "label4_score"] ] } ]
[{"img_name": "img1.jpg", "detections": [["label1", "label1_score"], ["label2", "label2_score"] ] } , {"img_name": "img2.jpg", "detections": [["label3", "label3_score"], ["label4", "label4_score"] ] } ]


[{'img_name': '65567.jpg', 'detections': [['person', 96.35], ['person', 99.99], ['person', 99.65], ['person', 56.89], ['tie', 58.39], ['person', 61.28], ['tie', 91.13]]}, {'img_name': '36979.jpg', 'detections': [['person', 99.46], ['person', 98.9], ['person', 99.7], ['person', 99.91], ['person', 89.37], ['cup', 54.63]]}]

def make_db_entry(tx, imgFile, objDetected):
    tx.run("MATCH (i:Image{name: $imgFile}) "
	       "MATCH (o:Object{name: $objDetected}) "
	       "MERGE (i)-[:HAS_OBJECT{score:'95.34'}]->(o) ")


			Github description notes for the python script
Yolo inference and Neo4j inserts
Inference on images with Yolo v3
All images in specified input folder processed.
May fail during pre-process step due to image size issued and such images will be rejected.
Successfully processed image results inserted to Neo4j db

			Github project Readme.md
# DataAnalytics4_Project
1) Masters program coursework for Data Analytics 4 module.

2) Topic assigned: YOLO

3) Use case is to present new images to pre-trained YOLO v3 model. Capture the inference (class names and confidence score) for all image, and then put into a Neo4j database. Using Neo4j Desktop v1.2.8.

4) Anaconda environment setup notes. Below are the commands entered manually in the order specified.
Create Python 3.7 environment (e.g. conda create -n ce2da41 python=3.7)
conda install jupyter
pip install neo4j
conda instlall pytz
conda install keras
-- Refer environment.yml file for output of command: conda env export > environment.yml

5) References used in the project:
Webiste: https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/
Github: On 05.06.2020, forked from https://github.com/jbrownlee/keras-yolo3 to https://github.com/rbewoor/keras-yolo3
Yolo weights link: link: https://pjreddie.com/media/files/yolov3.weights

6) Script: my_yolo3_one_file_to_detect_them_all_6.py
Action: Uses pre-trained Yolo v3 model for inference on images. The inference data is stored in a Neo4j database in the form of (:Image)-[:HAS]->(:Object). User provides a folder which contains all the images to process. Note: some images cannot be processed due to resizing issues and will be skipped.

7) Script: my_yolo3_model_stats_1.py
Action: Uses the model.summary and plot_model functionality of Keras to output a textual and visual description of the YOLO v3 model.



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

			ENVIRONMENT SETUP - ANACONDA - for only neo4j db writing
conda create -n conenv2da41 python=3.8
conda install jupyter
conda install pandas

	pip install neo4j
		OR
	pip install py2neo
conda install pytz



from neo4j import GraphDatabase
print("Yes")



https://sharing.luminis.eu/blog/neo4j-for-python-users-and-broken-pipe-error/
from neo4j import GraphDatabase
uri = "bolt://localhost:7687", user="neo4j", password="abc"
driver = GraphDatabase.driver(uri, auth=(user, password))
with driver.session() as session:
	session.run("CREATE (w:MyNode {Name : 'John', Title : 'President', Age : 22}) RETURN id(w)")
	session.close()




https://github.com/neo4j-examples/movies-python-bolt/blob/master/movies.py
import os
from neo4j import GraphDatabase, basic_auth
url = os.getenv("NEO4J_URL","bolt://localhost")
password = os.getenv("NEO4J_PASSWORD","test")
driver = GraphDatabase.driver(url,auth=basic_auth("neo4j", password),encrypted=False)





from neo4j import GraphDatabase

uri = "neo4j://localhost:7687"
driver = GraphDatabase.driver(uri, auth=("neo4j", "abc"))

def create_friend_of(tx, name, friend):
    tx.run("CREATE (a:Person)-[:KNOWS]->(f:Person {name: $friend}) "
           "WHERE a.name = $name "
           "RETURN f.name AS friend", name=name, friend=friend)"

with driver.session() as session:
    session.write_transaction(create_friend_of, "Alice", "Bob")

with driver.session() as session:
    session.write_transaction(create_friend_of, "Alice", "Carl")

driver.close()



MERGE (:Image {name: "1.jpg"})
MERGE (:Object {name: "person"})

MATCH (i1:Image{name: "1.jpg"}), (o1:Object{name: "person"})
CREATE (i1)-[:HAS{score: 98.45}]->(o1)

MATCH (i1:Image), (o1:Object)
WHERE i1.name = "1.jpg" AND o1.name = "person"
CREATE (i1)-[:HAS{score: 98.45}]->(o1)

'MATCH (i1:Image{name: ' + in_imgFile + '}), (o1:Object{name: ' + str(in_objDetected) + '}) CREATE (i1)-[:HAS{score: ' + in_detScore1 + '}]->(o1)'

MATCH (n)
DETACH DELETE n

MATCH (n)
RETURN (n)
LIMIT 200



KARAM inputs:
in a chrome browser run     http://localhost:7474/browser/


check service running ?

sudo service neo4j-service status
sudo service neo4j status

systemctl {start|stop|restart} neo4j
systemctl start neo4j

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx



		CHANGES TO PROPOSAL

1) Database only consists of images tagged with the COCO 80 classes. So the user input must only cover these specific classes.
2) Add motivation
3) Voice input simulated using wav files to represent each of the three sentences. These need to be recorded separately and then presented to the transcription model.
4) Each sentence to include maximum three classes. This will increase chance of finding a suitable image with all the objects present. Better will be to include only two classes per sentence.
5) Sentence to consist of active voice and not passive voice (person is walking his dog, NOT dog is being walked by a person)
6) 


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


							QUERYING THE NEO4J GRAPH DB

labels = ['aeroplane', 'apple', 'backpack', 'banana', 'baseball bat', 'baseball glove', \
          'bear', 'bed', 'bench', 'bicycle', 'bird', 'boat', 'book', 'bottle', 'bowl', \
          'broccoli', 'bus', 'cake', 'car', 'carrot', 'cat', 'cell phone', 'chair', \
          'clock', 'cow', 'cup', 'diningtable', 'dog', 'donut', 'elephant', 'fire hydrant', \
          'fork', 'frisbee', 'giraffe', 'hair drier', 'handbag', 'horse', 'hot dog', \
          'keyboard', 'kite', 'knife', 'laptop', 'microwave', 'motorbike', 'mouse', \
          'orange', 'oven', 'parking meter', 'person', 'pizza', 'pottedplant', \
          'refrigerator', 'remote', 'sandwich', 'scissors', 'sheep', 'sink', 'skateboard', 'skis', \
          'snowboard', 'sofa', 'spoon', 'sports ball', 'stop sign', 'suitcase', 'surfboard', \
          'teddy bear', 'tennis racket', 'tie', 'toaster', 'toilet', 'toothbrush', 'traffic light', \
          'train', 'truck', 'tvmonitor', 'umbrella', 'vase', 'wine glass', 'zebra']


	image 000000548113.jpg of coco test has all three objects 'cat' 'dog' 'person'
MATCH (o1:Object)--(i:Image)--(o2:Object)--(i)--(o3:Object)
WHERE o1.name = 'dog' AND o2.name = 'cat' AND o3.name = 'person'
RETURN i.name, i.dataset
LIMIT 20


[ ["clock", "book"], ["person", "bird", "clock"]]
[ ["dog", "cat"], ["person", "book"], ["person", "car"] ]

python3 query_neo_2.py -objarrfile "/home/rohit/PyWDUbuntu/thesis/queryDb/query_db_input_test_3_dblquote.txt"




xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


							IDENTIFY KEY ELEMENTS
	SPACY better than NLTK. Even better is BERT from google. Twitter HUGGING FACES join the group have their own tool.
	
	
	Another option may be as per this link: DeepCorrection 1: Sentence Segmentation of unpunctuated text.
https://medium.com/@praneethbedapudi/deepcorrection-1-sentence-segmentation-of-unpunctuated-text-a1dbc0db4e98

python3 id_elements_1.py -ipfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/IdElements/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/IdElements/key_elements_1.txt"

python3 id_elements_2.py -ipfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/IdElements/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/IdElements/key_elements_1.txt"

python3 id_elements_3.py -ipfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/IdElements/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/IdElements/key_elements_1.txt"


				GUI version
python3 id_elements_4_gui.py -ipfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/IdElements/gui_ver_output/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/IdElements/gui_ver_output/key_elements_1.txt"


				GUI version -  disables proceed to grid selection if no words. No need for label_error in root window.
python3 id_elements_5_gui.py -ipfile "/home/rohit/PyWDUbuntu/thesis/SttTranscribe/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/IdElements/gui_ver_output/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/IdElements/gui_ver_output/key_elements_1.txt"


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

			USING NLTK

conda create -n ce6idelements1 python=3.7
conda activate ce6idelements1
conda install jupyter
conda install nltk
conda install -c conda-forge spacy
		one time		https://spacy.io/models/en
python3 -m spacy download en_core_web_lg

-----------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------

			SETUP NLTK DATA MANUALLY
	https://www.nltk.org/data.html
Manual installation
Create a folder nltk_data, e.g. C:\nltk_data, or /usr/local/share/nltk_data, and subfolders chunkers, grammars, misc, sentiment, taggers, corpora, help, models, stemmers, tokenizers.

Download individual packages from http://nltk.org/nltk_data/ (see the “download” links). Unzip them to the appropriate subfolder. For example, the Brown Corpus, found at: https://raw.githubusercontent.com/nltk/nltk_data/gh-pages/packages/corpora/brown.zip is to be unzipped to nltk_data/corpora/brown.

Set your NLTK_DATA environment variable to point to your top level nltk_data folder.

--------------------------------------------

			DOWNLOAD DATA LINK
http://www.nltk.org/nltk_data/
/home/rohit/nltk_data

5. Porter Stemmer Test Files [ download | source ]
id: porter_test; size: 200510; author: ; copyright: ; license: ;

18. Averaged Perceptron Tagger [ download | source ]
id: averaged_perceptron_tagger; size: 2526731; author: ; copyright: ; license: ;

20. Mappings to the Universal Part-of-Speech Tagset [ download | source ]
id: universal_tagset; size: 19095; author: ; copyright: ; license: ;

37. Project Gutenberg Selections [ download | source ]
id: gutenberg; size: 4251829; author: ; copyright: public domain; license: public domain;

70. Stopwords Corpus [ download | source ]
id: stopwords; size: 23047; author: ; copyright: ; license: ;

-----------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------

			Tokenization
Tokenization is the first step in text analytics. The process of breaking down a text paragraph into smaller chunks such as words or sentence is called Tokenization. Token is a single entity that is building blocks for sentence or paragraph.

	Sentence Tokenization
Sentence tokenizer breaks text paragraph into sentences.

	Word Tokenization
Word tokenizer breaks text paragraph into words.

			Stopwords
Stopwords considered as noise in the text. Text may contain stop words such as is, am, are, this, a, an, the, etc.
In NLTK for removing stopwords, you need to create a list of stopwords and filter out your list of tokens from these words.

			Lexicon Normalization
Lexicon normalization considers another type of noise in the text. For example, connection, connected, connecting word reduce to a common word "connect". It reduces derivationally related forms of a word to a common root word.

	Stemming
Stemming is a process of linguistic normalization, which reduces words to their word root word or chops off the derivational affixes. For example, connection, connected, connecting word reduce to a common word "connect".

	Lemmatization
Lemmatization reduces words to their base word, which is linguistically correct lemmas. It transforms root word with the use of vocabulary and morphological analysis. Lemmatization is usually more sophisticated than stemming. Stemmer works on an individual word without knowledge of the context. For example, The word "better" has "good" as its lemma. This thing will miss by stemming because it requires a dictionary look-up.


			POS Tagging
The primary target of Part-of-Speech(POS) tagging is to identify the grammatical group of a given word. Whether it is a NOUN, PRONOUN, ADJECTIVE, VERB, ADVERBS, etc. based on the context. POS Tagging looks for relationships within the sentence and assigns a corresponding tag to the word.


			Sentiment Analysis
Sentiments are combination words, tone, and writing style. As a data analyst, It is more important to understand our sentiments, what it really means?
There are mainly two approaches for performing sentiment analysis.
Lexicon-based: count number of positive and negative words in given text and the larger count will be the sentiment of text.
Machine learning based approach: Develop a classification model, which is trained using the pre-labeled dataset of positive, negative, and neutral.
In this Tutorial, you will use the second approach(Machine learning based approach). This is how you learn sentiment and text classification with a single example.


			Text Classification
Text classification is one of the important tasks of text mining. It is a supervised approach. Identifying category or class of given text such as a blog, book, web page, news articles, and tweets. It has various application in today's computer world such as spam detection, task categorization in CRM services, categorizing products on E-retailer websites, classifying the content of websites for a search engine, sentiments of customer feedback, etc. In the next section, you will learn how you can do text classification in python.


-----------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------

			pdf extraction code snippets

from nltk import sent_tokenize, word_tokenize
# https://www.datacamp.com/community/tutorials/text-analytics-beginners-nltk
# https://medium.com/analytics-vidhya/sentence-extraction-using-textrank-algorithm-7f5c8fd568cd


sentencesOnPage = sent_tokenize(fullSentOnPage)
for word in word_tokenize(outSentAdv)

-----------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------

https://pythonprogramming.net/stemming-nltk-tutorial/

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

			USING NLTK

conda create -n ce6idelements1 python=3.7
conda activate ce6idelements1
conda install jupyter
conda install -c conda-forge spacy
		one time		https://spacy.io/models/en download the en_core_web     _lg is large, there are options for small and medium too.
python3 -m spacy download en_core_web_lg


-----------------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------------------------

			Stopwords removal



			Lemmatization
Lemmatization reduces words to their base word, which is linguistically correct lemmas. It transforms root word with the use of vocabulary and morphological analysis. Lemmatization is usually more sophisticated than stemming. Stemmer works on an individual word without knowledge of the context. For example, The word "better" has "good" as its lemma. This thing will miss by stemming because it requires a dictionary look-up.



			POS Tagging
The primary target of Part-of-Speech(POS) tagging is to identify the grammatical group of a given word. Whether it is a NOUN, PRONOUN, ADJECTIVE, VERB, ADVERBS, etc. based on the context. POS Tagging looks for relationships within the sentence and assigns a corresponding tag to the word.



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
		ENVIRONMENT 1
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


		SETTING UP ANACONDA ENVIRONMENT FOR STORY GENERATION INFERENCE ONLY AS IT NEEDS TENSORFLOW 1.X
		FOR    STORY GENERATOR ONLY

		SETTING UP ENVIRONMENT FOR      STORY GENERATOR WITH TF 1.X

	*** create new environment
conda create -n --newENV python=3.7

	*** general stuff
conda install jupyter

	*** Story Generation
conda install numpy
conda install requests
conda install regex
pip install tensorflow==1.15.2
##pip install toposort - not required as functionality is not being used
pip install gpt-2-simple			## Successfully installed gpt-2-simple-0.7.1 regex-2020.10.23 toposort-1.5
conda install matplotlib
##conda install -c conda-forge opencv=3.4.2   ## used opencv 3.4.2


		PYTHON VERSION CHECK = 3.7.9
(ce13stygen1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ python --version
Python 3.7.9
(ce13stygen1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$


		CONDA LIST AFTER ABOVE STEPS
(ce13stygen1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ conda list
# packages in environment at /home/rohit/anaconda3/envs/ce13stygen1:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                        main  
absl-py                   0.10.0                   pypi_0    pypi
argon2-cffi               20.1.0           py37h7b6447c_1  
astor                     0.8.1                    pypi_0    pypi
async_generator           1.10             py37h28b3542_0  
attrs                     20.2.0                     py_0  
backcall                  0.2.0                      py_0  
blas                      1.0                         mkl  
bleach                    3.2.1                      py_0  
brotlipy                  0.7.0           py37h7b6447c_1000  
bzip2                     1.0.8                h516909a_3    conda-forge
ca-certificates           2020.6.20            hecda079_0    conda-forge
cairo                     1.14.12              h8948797_3  
certifi                   2020.6.20        py37he5f6b98_2    conda-forge
cffi                      1.14.3           py37he30daa8_0  
chardet                   3.0.4                 py37_1003  
cryptography              3.1.1            py37h1ba5d50_0  
cycler                    0.10.0                   py37_0  
dbus                      1.13.18              hb2f20db_0  
decorator                 4.4.2                      py_0  
defusedxml                0.6.0                      py_0  
entrypoints               0.3                      py37_0  
expat                     2.2.10               he6710b0_2  
ffmpeg                    4.0                  hcdf2ecd_0  
fontconfig                2.13.0               h9420a91_0  
freeglut                  3.0.0             hf484d3e_1005    conda-forge
freetype                  2.10.4               h5ab3b9f_0  
gast                      0.2.2                    pypi_0    pypi
glib                      2.66.1               h92f7085_0  
google-pasta              0.2.0                    pypi_0    pypi
gpt-2-simple              0.7.1                    pypi_0    pypi
graphite2                 1.3.13            h58526e2_1001    conda-forge
grpcio                    1.33.1                   pypi_0    pypi
gst-plugins-base          1.14.0               hbbd80ab_1  
gstreamer                 1.14.0               hb31296c_0  
h5py                      2.10.0                   pypi_0    pypi
harfbuzz                  1.8.8                hffaf4a1_0  
hdf5                      1.10.2               hc401514_3    conda-forge
icu                       58.2                 he6710b0_3  
idna                      2.10                       py_0  
importlib-metadata        2.0.0                      py_1  
importlib_metadata        2.0.0                         1  
intel-openmp              2020.2                      254  
ipykernel                 5.3.4            py37h5ca1d4c_0  
ipython                   7.18.1           py37h5ca1d4c_0  
ipython_genutils          0.2.0                    py37_0  
ipywidgets                7.5.1                      py_1  
jasper                    2.0.14               h07fcdf6_1  
jedi                      0.17.2                   py37_0  
jinja2                    2.11.2                     py_0  
jpeg                      9b                   h024ee3a_2  
jsonschema                3.2.0                      py_2  
jupyter                   1.0.0                    py37_7  
jupyter_client            6.1.7                      py_0  
jupyter_console           6.2.0                      py_0  
jupyter_core              4.6.3                    py37_0  
jupyterlab_pygments       0.1.2                      py_0  
keras-applications        1.0.8                    pypi_0    pypi
keras-preprocessing       1.1.2                    pypi_0    pypi
kiwisolver                1.3.0            py37h2531618_0  
lcms2                     2.11                 h396b838_0  
ld_impl_linux-64          2.33.1               h53a641e_7  
libedit                   3.1.20191231         h14c3975_1  
libffi                    3.3                  he6710b0_2  
libgcc-ng                 9.1.0                hdf63c60_0  
libgfortran               3.0.0                         1    conda-forge
libglu                    9.0.0             he1b5a44_1001    conda-forge
libopencv                 3.4.2                hb342d67_1  
libopus                   1.3.1                h7b6447c_0  
libpng                    1.6.37               hbc83047_0  
libsodium                 1.0.18               h7b6447c_0  
libstdcxx-ng              9.1.0                hdf63c60_0  
libtiff                   4.1.0                h2733197_1  
libuuid                   1.0.3                h1bed415_2  
libvpx                    1.7.0                h439df22_0  
libxcb                    1.14                 h7b6447c_0  
libxml2                   2.9.10               hb55368b_3  
lz4-c                     1.9.2                heb0550a_3  
markdown                  3.3.3                    pypi_0    pypi
markupsafe                1.1.1            py37h14c3975_1  
matplotlib                3.3.2                         0  
matplotlib-base           3.3.2            py37h817c723_0  
mistune                   0.8.4           py37h14c3975_1001  
mkl                       2020.2                      256  
mkl-service               2.3.0            py37he904b0f_0  
mkl_fft                   1.2.0            py37h23d657b_0  
mkl_random                1.1.1            py37h0573a6f_0  
nbclient                  0.5.1                      py_0  
nbconvert                 6.0.7                    py37_0  
nbformat                  5.0.8                      py_0  
ncurses                   6.2                  he6710b0_1  
nest-asyncio              1.4.1                      py_0  
notebook                  6.1.4                    py37_0  
numpy                     1.19.2           py37h54aff64_0  
numpy-base                1.19.2           py37hfa32c7d_0  
olefile                   0.46                     py37_0  
opencv                    3.4.2            py37h6fd60c2_1  
openssl                   1.1.1h               h516909a_0    conda-forge
opt-einsum                3.3.0                    pypi_0    pypi
packaging                 20.4                       py_0  
pandoc                    2.11                 hb0f4dca_0  
pandocfilters             1.4.2                    py37_1  
parso                     0.7.0                      py_0  
pcre                      8.44                 he6710b0_0  
pexpect                   4.8.0                    py37_1  
pickleshare               0.7.5                 py37_1001  
pillow                    8.0.1            py37he98fc37_0  
pip                       20.2.4                   py37_0  
pixman                    0.40.0               h36c2ea0_0    conda-forge
prometheus_client         0.8.0                      py_0  
prompt-toolkit            3.0.8                      py_0  
prompt_toolkit            3.0.8                         0  
protobuf                  3.13.0                   pypi_0    pypi
ptyprocess                0.6.0                    py37_0  
py-opencv                 3.4.2            py37hb342d67_1  
pycparser                 2.20                       py_2  
pygments                  2.7.1                      py_0  
pyopenssl                 19.1.0                     py_1  
pyparsing                 2.4.7                      py_0  
pyqt                      5.9.2            py37h05f1152_2  
pyrsistent                0.17.3           py37h7b6447c_0  
pysocks                   1.7.1                    py37_1  
python                    3.7.9                h7579374_0  
python-dateutil           2.8.1                      py_0  
python_abi                3.7                     1_cp37m    conda-forge
pyzmq                     19.0.2           py37he6710b0_1  
qt                        5.9.7                h5867ecd_1  
qtconsole                 4.7.7                      py_0  
qtpy                      1.9.0                      py_0  
readline                  8.0                  h7b6447c_0  
regex                     2020.10.15       py37h7b6447c_0  
requests                  2.24.0                     py_0  
send2trash                1.5.0                    py37_0  
setuptools                50.3.0           py37hb0f4dca_1  
sip                       4.19.8           py37hf484d3e_0  
six                       1.15.0                     py_0  
sqlite                    3.33.0               h62c20be_0  
tensorboard               1.15.0                   pypi_0    pypi
tensorflow                1.15.2                   pypi_0    pypi
tensorflow-estimator      1.15.1                   pypi_0    pypi
termcolor                 1.1.0                    pypi_0    pypi
terminado                 0.9.1                    py37_0  
testpath                  0.4.4                      py_0  
tk                        8.6.10               hbc83047_0  
toposort                  1.5                      pypi_0    pypi
tornado                   6.0.4            py37h7b6447c_1  
tqdm                      4.51.0                   pypi_0    pypi
traitlets                 5.0.5                      py_0  
urllib3                   1.25.11                    py_0  
wcwidth                   0.2.5                      py_0  
webencodings              0.5.1                    py37_1  
werkzeug                  1.0.1                    pypi_0    pypi
wheel                     0.35.1                     py_0  
widgetsnbextension        3.5.1                    py37_0  
wrapt                     1.12.1                   pypi_0    pypi
xorg-fixesproto           5.0               h14c3975_1002    conda-forge
xorg-inputproto           2.3.2             h14c3975_1002    conda-forge
xorg-kbproto              1.0.7             h14c3975_1002    conda-forge
xorg-libx11               1.6.12               h516909a_0    conda-forge
xorg-libxau               1.0.9                h14c3975_0    conda-forge
xorg-libxext              1.3.4                h516909a_0    conda-forge
xorg-libxfixes            5.0.3             h516909a_1004    conda-forge
xorg-libxi                1.7.10               h516909a_0    conda-forge
xorg-xextproto            7.3.0             h14c3975_1002    conda-forge
xorg-xproto               7.0.31            h14c3975_1007    conda-forge
xz                        5.2.5                h7b6447c_0  
zeromq                    4.3.3                he6710b0_3  
zipp                      3.3.1                      py_0  
zlib                      1.2.11               h7b6447c_3  
zstd                      1.4.5                h9ceee32_0  
(ce13stygen1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
		ENVIRONMENT 2
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		SETTING UP ANACONDA ENVIRONMENT FOR COMBINED EXECUTION
		FOR    MIC INPUT TO GUI IMAGE CAP SHOW/EDIT
		MIC INPUT, STT, ID KEY ELEMENTS, QUERY DB, IMAGE CAP INFERENCE


	*** create new environment
conda create -n --newENV python=3.7

	*** general stuff
conda install jupyter
conda install pandas
conda install matplotlib

	*** speech to text transcription
pip install deepspeech==0.7.3
		ONE TIME ONLY	*** # Download pre-trained English model files
	/home/rohit/deepspeech/pretrained/v073 - into this folder downloaded the scorer and pbmm
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.7.3/deepspeech-0.7.3-models.pbmm
curl -LO https://github.com/mozilla/DeepSpeech/releases/download/v0.7.3/deepspeech-0.7.3-models.scorer

	*** id key elements
conda install -c conda-forge spacy
		EACH TIME FOR NEW ENV	https://spacy.io/models/en download the en_core_web     _lg is large, there are options for small and medium too.
python3 -m spacy download en_core_web_lg

	*** query database neo4j
pip install py2neo

	*** neo4j db insertions
**pip install py2neo				## not required as should already be there from earlier steps
**conda install pytz				## not required as should already be there from earlier steps
conda install -c conda-forge opencv=3.4.2   ## used opencv 3.4.2
conda install keras=2.3.1					## used keras  2.3.1
conda install pydot

	*** GUI - with Tkinter
**conda install tk      ## pip install python-tk	## not required as should already be there from earlier steps
**conda install pillow  ##pip install pillow	## not required as should already be there from earlier steps

	*** MS Azure TTS   -- currently is part of totally new environment
					pre-requisite
			sudo apt-get update
			sudo apt-get install libssl1.0.0 libasound2
pip install azure-cognitiveservices-speech      ## used azure-cognitiveservices-speech  1.13.0
conda install requests                          ## used requests  2.24.0

	*** Image Captioning Inference
conda install scikit-learn

	*** GUI Image Captions Display and/or edit
nothing new required

	*** Mic input for input sentences and save as wav files
## using pyaudio - which has dependency for portaudio which is installed automatically
conda install pyaudio				## used pyaudio		0.2.11
**conda install portaudio			## used portaudio		19.6.0		## not required as should already be there from earlier steps


		PYTHON VERSION CHECK = 3.7.9
(ce11comb2) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ 
(ce11comb2) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ python --version
Python 3.7.9
(ce11comb2) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ 


		CONDA LIST AFTER ABOVE STEPS
(ce12comb3) rohit@rohitu2004lts:/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017$ conda list
# packages in environment at /home/rohit/anaconda3/envs/ce12comb3:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                        main  
_tflow_select             2.3.0                       mkl  
absl-py                   0.10.0                   py37_0  
aiohttp                   3.6.3            py37h7b6447c_0  
argon2-cffi               20.1.0           py37h7b6447c_1  
astor                     0.8.1                    py37_0  
async-timeout             3.0.1                    py37_0  
async_generator           1.10             py37h28b3542_0  
attrs                     20.2.0                     py_0  
azure-cognitiveservices-speech 1.13.0                   pypi_0    pypi
backcall                  0.2.0                      py_0  
blas                      1.0                         mkl  
bleach                    3.2.1                      py_0  
blinker                   1.4                      py37_0  
brotlipy                  0.7.0           py37hb5d75c8_1001    conda-forge
bzip2                     1.0.8                h516909a_3    conda-forge
c-ares                    1.16.1               h7b6447c_0  
ca-certificates           2020.10.14                    0  
cachetools                4.1.1                      py_0  
cairo                     1.14.12              h8948797_3  
catalogue                 1.0.0                      py_0    conda-forge
certifi                   2020.6.20                py37_0  
cffi                      1.14.3           py37he30daa8_0  
chardet                   3.0.4           py37he5f6b98_1008    conda-forge
click                     7.1.2                      py_0  
cryptography              3.1.1            py37hff6837a_1    conda-forge
cycler                    0.10.0                   py37_0  
cymem                     2.0.3            py37h3340039_3    conda-forge
cython-blis               0.4.1            py37h8f50634_1    conda-forge
dbus                      1.13.18              hb2f20db_0  
decorator                 4.4.2                      py_0  
deepspeech                0.7.3                    pypi_0    pypi
defusedxml                0.6.0                      py_0  
docker                    4.3.1                    pypi_0    pypi
en-core-web-lg            2.3.1                    pypi_0    pypi
english                   2020.7.0                 pypi_0    pypi
entrypoints               0.3                      py37_0  
expat                     2.2.10               he6710b0_2  
ffmpeg                    4.0                  hcdf2ecd_0  
fontconfig                2.13.0               h9420a91_0  
freeglut                  3.0.0             hf484d3e_1005    conda-forge
freetype                  2.10.4               h5ab3b9f_0  
gast                      0.2.2                    py37_0  
glib                      2.66.1               h92f7085_0  
google-auth               1.22.1                     py_0  
google-auth-oauthlib      0.4.1                      py_2  
google-pasta              0.2.0                      py_0  
graphite2                 1.3.13            he1b5a44_1001    conda-forge
grpcio                    1.31.0           py37hf8bcb03_0  
gst-plugins-base          1.14.0               hbbd80ab_1  
gstreamer                 1.14.0               hb31296c_0  
h5py                      2.8.0            py37h989c5e5_3  
harfbuzz                  1.8.8                hffaf4a1_0  
hdf5                      1.10.2               hc401514_3    conda-forge
icu                       58.2                 he6710b0_3  
idna                      2.10               pyh9f0ad1d_0    conda-forge
importlib-metadata        2.0.0                      py_1  
importlib_metadata        2.0.0                         1  
intel-openmp              2020.2                      254  
ipykernel                 5.3.4            py37h5ca1d4c_0  
ipython                   7.18.1           py37h5ca1d4c_0  
ipython_genutils          0.2.0                    py37_0  
ipywidgets                7.5.1                      py_1  
jasper                    2.0.14               h07fcdf6_1  
jedi                      0.17.2                   py37_0  
jinja2                    2.11.2                     py_0  
joblib                    0.17.0                     py_0  
jpeg                      9b                   h024ee3a_2  
jsonschema                3.2.0                      py_2  
jupyter                   1.0.0                    py37_7  
jupyter_client            6.1.7                      py_0  
jupyter_console           6.2.0                      py_0  
jupyter_core              4.6.3                    py37_0  
jupyterlab_pygments       0.1.2                      py_0  
keras                     2.3.1                         0  
keras-applications        1.0.8                      py_1  
keras-base                2.3.1                    py37_0  
keras-preprocessing       1.1.0                      py_1  
kiwisolver                1.2.0            py37hfd86e86_0  
lcms2                     2.11                 h396b838_0  
ld_impl_linux-64          2.33.1               h53a641e_7  
libedit                   3.1.20191231         h14c3975_1  
libffi                    3.3                  he6710b0_2  
libgcc-ng                 9.1.0                hdf63c60_0  
libgfortran               3.0.0                         1    conda-forge
libgfortran-ng            7.3.0                hdf63c60_0  
libglu                    9.0.0             he1b5a44_1001    conda-forge
libopencv                 3.4.2                hb342d67_1  
libopus                   1.3.1                h7b6447c_0  
libpng                    1.6.37               hbc83047_0  
libprotobuf               3.13.0.1             hd408876_0  
libsodium                 1.0.18               h7b6447c_0  
libstdcxx-ng              9.1.0                hdf63c60_0  
libtiff                   4.1.0                h2733197_1  
libuuid                   1.0.3                h1bed415_2  
libvpx                    1.7.0                h439df22_0  
libxcb                    1.14                 h7b6447c_0  
libxml2                   2.9.10               hb55368b_3  
lz4-c                     1.9.2                heb0550a_3  
markdown                  3.3.2                    py37_0  
markupsafe                1.1.1            py37h14c3975_1  
matplotlib                3.3.2                         0  
matplotlib-base           3.3.2            py37h817c723_0  
mistune                   0.8.4           py37h14c3975_1001  
mkl                       2020.2                      256  
mkl-service               2.3.0            py37he904b0f_0  
mkl_fft                   1.2.0            py37h23d657b_0  
mkl_random                1.1.1            py37h0573a6f_0  
monotonic                 1.5                      pypi_0    pypi
multidict                 4.7.6            py37h7b6447c_1  
murmurhash                1.0.0            py37h3340039_1    conda-forge
nbclient                  0.5.1                      py_0  
nbconvert                 6.0.7                    py37_0  
nbformat                  5.0.8                      py_0  
ncurses                   6.2                  he6710b0_1  
neotime                   1.7.4                    pypi_0    pypi
nest-asyncio              1.4.1                      py_0  
notebook                  6.1.4                    py37_0  
numpy                     1.19.2           py37h54aff64_0  
numpy-base                1.19.2           py37hfa32c7d_0  
oauthlib                  3.1.0                      py_0  
olefile                   0.46                     py37_0  
opencv                    3.4.2            py37h6fd60c2_1  
openssl                   1.1.1h               h7b6447c_0  
opt_einsum                3.1.0                      py_0  
packaging                 20.4                       py_0  
pandas                    1.1.3            py37he6710b0_0  
pandoc                    2.11                 hb0f4dca_0  
pandocfilters             1.4.2                    py37_1  
pansi                     2020.7.3                 pypi_0    pypi
parso                     0.7.0                      py_0  
pcre                      8.44                 he6710b0_0  
pexpect                   4.8.0                    py37_1  
pickleshare               0.7.5                 py37_1001  
pillow                    8.0.0            py37h9a89aac_0  
pip                       20.2.4                   py37_0  
pixman                    0.38.0            h516909a_1003    conda-forge
plac                      0.9.6                    py37_1  
portaudio                 19.6.0               h7b6447c_4  
preshed                   3.0.2            py37h3340039_4    conda-forge
prometheus_client         0.8.0                      py_0  
prompt-toolkit            2.0.10                   pypi_0    pypi
prompt_toolkit            3.0.8                         0  
protobuf                  3.13.0.1         py37he6710b0_1  
ptyprocess                0.6.0                    py37_0  
py-opencv                 3.4.2            py37hb342d67_1  
py2neo                    2020.0.0                 pypi_0    pypi
pyasn1                    0.4.8                      py_0  
pyasn1-modules            0.2.8                      py_0  
pyaudio                   0.2.11           py37h7b6447c_2  
pycparser                 2.20                       py_2  
pydot                     1.3.0                    py37_0  
pygments                  2.7.1                      py_0  
pyjwt                     1.7.1                    py37_0  
pyopenssl                 19.1.0                     py_1    conda-forge
pyparsing                 2.4.7                      py_0  
pyqt                      5.9.2            py37h05f1152_2  
pyrsistent                0.17.3           py37h7b6447c_0  
pysocks                   1.7.1            py37he5f6b98_2    conda-forge
python                    3.7.9                h7579374_0  
python-dateutil           2.8.1                      py_0  
python_abi                3.7                     1_cp37m    conda-forge
pytz                      2020.1                     py_0  
pyyaml                    5.3.1            py37h7b6447c_1  
pyzmq                     19.0.2           py37he6710b0_1  
qt                        5.9.7                h5867ecd_1  
qtconsole                 4.7.7                      py_0  
qtpy                      1.9.0                      py_0  
readline                  8.0                  h7b6447c_0  
requests                  2.24.0                     py_0  
requests-oauthlib         1.3.0                      py_0  
rsa                       4.6                        py_0  
scikit-learn              0.23.2           py37h0573a6f_0  
scipy                     1.5.2            py37h0b6359f_0  
send2trash                1.5.0                    py37_0  
setuptools                50.3.0           py37hb0f4dca_1  
sip                       4.19.8           py37hf484d3e_0  
six                       1.15.0                     py_0  
spacy                     2.3.2            py37h99015e2_0    conda-forge
sqlite                    3.33.0               h62c20be_0  
srsly                     1.0.2            py37h3340039_0    conda-forge
tensorboard               2.2.1              pyh532a8cf_0  
tensorboard-plugin-wit    1.6.0                      py_0  
tensorflow                2.1.0           mkl_py37h80a91df_0  
tensorflow-base           2.1.0           mkl_py37h6d63fb7_0  
tensorflow-estimator      2.1.0              pyhd54b08b_0  
termcolor                 1.1.0                    py37_1  
terminado                 0.9.1                    py37_0  
testpath                  0.4.4                      py_0  
thinc                     7.4.1            py37h99015e2_0    conda-forge
threadpoolctl             2.1.0              pyh5ca1d4c_0  
tk                        8.6.10               hbc83047_0  
tornado                   6.0.4            py37h7b6447c_1  
tqdm                      4.51.0             pyh9f0ad1d_0    conda-forge
traitlets                 5.0.5                      py_0  
urllib3                   1.25.11                    py_0    conda-forge
wasabi                    0.8.0              pyh9f0ad1d_0    conda-forge
wcwidth                   0.2.5                      py_0  
webencodings              0.5.1                    py37_1  
websocket-client          0.57.0                   pypi_0    pypi
werkzeug                  1.0.1                      py_0  
wheel                     0.35.1                     py_0  
widgetsnbextension        3.5.1                    py37_0  
wrapt                     1.12.1           py37h7b6447c_1  
xorg-fixesproto           5.0               h14c3975_1002    conda-forge
xorg-inputproto           2.3.2             h14c3975_1002    conda-forge
xorg-kbproto              1.0.7             h14c3975_1002    conda-forge
xorg-libx11               1.6.12               h516909a_0    conda-forge
xorg-libxau               1.0.9                h14c3975_0    conda-forge
xorg-libxext              1.3.4                h516909a_0    conda-forge
xorg-libxfixes            5.0.3             h516909a_1004    conda-forge
xorg-libxi                1.7.10               h516909a_0    conda-forge
xorg-xextproto            7.3.0             h14c3975_1002    conda-forge
xorg-xproto               7.0.31            h14c3975_1007    conda-forge
xz                        5.2.5                h7b6447c_0  
yaml                      0.2.5                h7b6447c_0  
yarl                      1.6.2            py37h7b6447c_0  
zeromq                    4.3.3                he6710b0_3  
zipp                      3.3.1                      py_0  
zlib                      1.2.11               h7b6447c_3  
zstd                      1.4.5                h9ceee32_0  
(ce12comb3) rohit@rohitu2004lts:



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
		ENVIRONMENT 3
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

		SETTING UP ANACONDA ENVIRONMENT FOR IMAGE CAPTIONING ATTENTION MODEL TRAINING - USES TF 2.X

	*** create new environment
conda create -n --newENV python=3.7

	*** general stuff
conda install jupyter
conda install pandas
conda install matplotlib

	*** Image Captioning ATTEND Inference
conda install scikit-learn
##conda install -c conda-forge opencv=3.4.2   ## used opencv 3.4.2  ## installing opencv downgrades to tf1.X and this kills it all
conda install keras=2.3.1					## used keras  2.3.1


		PYTHON VERSION CHECK = 3.7.9
(ce14imgcapattend1) rohit@rohitu2004lts:~$ python --version
Python 3.7.9
(ce14imgcapattend1) rohit@rohitu2004lts:~$

(ce14imgcapattend1) rohit@rohitu2004lts:~$ conda list
# packages in environment at /home/rohit/anaconda3/envs/ce14imgcapattend1:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                        main  
_tflow_select             2.3.0                     eigen  
absl-py                   0.11.0           py37h06a4308_0  
aiohttp                   3.6.3            py37h7b6447c_0  
argon2-cffi               20.1.0           py37h7b6447c_1  
astunparse                1.6.3                      py_0  
async-timeout             3.0.1                    py37_0  
async_generator           1.10             py37h28b3542_0  
attrs                     20.3.0             pyhd3eb1b0_0  
backcall                  0.2.0                      py_0  
blas                      1.0                         mkl  
bleach                    3.2.1                      py_0  
blinker                   1.4                      py37_0  
brotlipy                  0.7.0           py37h7b6447c_1000  
c-ares                    1.16.1               h7b6447c_0  
ca-certificates           2020.10.14                    0  
cachetools                4.1.1                      py_0  
certifi                   2020.6.20          pyhd3eb1b0_3  
cffi                      1.14.3           py37he30daa8_0  
chardet                   3.0.4                 py37_1003  
click                     7.1.2                      py_0  
cryptography              3.1.1            py37h1ba5d50_0  
cycler                    0.10.0                   py37_0  
dbus                      1.13.18              hb2f20db_0  
decorator                 4.4.2                      py_0  
defusedxml                0.6.0                      py_0  
entrypoints               0.3                      py37_0  
expat                     2.2.10               he6710b0_2  
fontconfig                2.13.0               h9420a91_0  
freetype                  2.10.4               h5ab3b9f_0  
gast                      0.3.3                      py_0  
glib                      2.66.1               h92f7085_0  
google-auth               1.23.0             pyhd3eb1b0_0  
google-auth-oauthlib      0.4.2              pyhd3eb1b0_2  
google-pasta              0.2.0                      py_0  
grpcio                    1.31.0           py37hf8bcb03_0  
gst-plugins-base          1.14.0               hbbd80ab_1  
gstreamer                 1.14.0               hb31296c_0  
h5py                      2.10.0           py37hd6299e0_1  
hdf5                      1.10.6               hb1b8bf9_0  
icu                       58.2                 he6710b0_3  
idna                      2.10                       py_0  
importlib-metadata        2.0.0                      py_1  
importlib_metadata        2.0.0                         1  
intel-openmp              2020.2                      254  
ipykernel                 5.3.4            py37h5ca1d4c_0  
ipython                   7.19.0           py37hb070fc8_0  
ipython_genutils          0.2.0                    py37_0  
ipywidgets                7.5.1                      py_1  
jedi                      0.17.2                   py37_0  
jinja2                    2.11.2                     py_0  
joblib                    0.17.0                     py_0  
jpeg                      9b                   h024ee3a_2  
jsonschema                3.2.0                      py_2  
jupyter                   1.0.0                    py37_7  
jupyter_client            6.1.7                      py_0  
jupyter_console           6.2.0                      py_0  
jupyter_core              4.6.3                    py37_0  
jupyterlab_pygments       0.1.2                      py_0  
keras                     2.3.1                         0  
keras-applications        1.0.8                      py_1  
keras-base                2.3.1                    py37_0  
keras-preprocessing       1.1.0                      py_1  
kiwisolver                1.3.0            py37h2531618_0  
lcms2                     2.11                 h396b838_0  
ld_impl_linux-64          2.33.1               h53a641e_7  
libedit                   3.1.20191231         h14c3975_1  
libffi                    3.3                  he6710b0_2  
libgcc-ng                 9.1.0                hdf63c60_0  
libgfortran-ng            7.3.0                hdf63c60_0  
libpng                    1.6.37               hbc83047_0  
libprotobuf               3.13.0.1             hd408876_0  
libsodium                 1.0.18               h7b6447c_0  
libstdcxx-ng              9.1.0                hdf63c60_0  
libtiff                   4.1.0                h2733197_1  
libuuid                   1.0.3                h1bed415_2  
libxcb                    1.14                 h7b6447c_0  
libxml2                   2.9.10               hb55368b_3  
lz4-c                     1.9.2                heb0550a_3  
markdown                  3.3.2                    py37_0  
markupsafe                1.1.1            py37h14c3975_1  
matplotlib                3.3.2                         0  
matplotlib-base           3.3.2            py37h817c723_0  
mistune                   0.8.4           py37h14c3975_1001  
mkl                       2020.2                      256  
mkl-service               2.3.0            py37he904b0f_0  
mkl_fft                   1.2.0            py37h23d657b_0  
mkl_random                1.1.1            py37h0573a6f_0  
multidict                 4.7.6            py37h7b6447c_1  
nbclient                  0.5.1                      py_0  
nbconvert                 6.0.7                    py37_0  
nbformat                  5.0.8                      py_0  
ncurses                   6.2                  he6710b0_1  
nest-asyncio              1.4.1                      py_0  
notebook                  6.1.4                    py37_0  
numpy                     1.19.2           py37h54aff64_0  
numpy-base                1.19.2           py37hfa32c7d_0  
oauthlib                  3.1.0                      py_0  
olefile                   0.46                     py37_0  
openssl                   1.1.1h               h7b6447c_0  
opt_einsum                3.1.0                      py_0  
packaging                 20.4                       py_0  
pandas                    1.1.3            py37he6710b0_0  
pandoc                    2.11                 hb0f4dca_0  
pandocfilters             1.4.2                    py37_1  
parso                     0.7.0                      py_0  
pcre                      8.44                 he6710b0_0  
pexpect                   4.8.0                    py37_1  
pickleshare               0.7.5                 py37_1001  
pillow                    8.0.1            py37he98fc37_0  
pip                       20.2.4           py37h06a4308_0  
prometheus_client         0.8.0                      py_0  
prompt-toolkit            3.0.8                      py_0  
prompt_toolkit            3.0.8                         0  
protobuf                  3.13.0.1         py37he6710b0_1  
ptyprocess                0.6.0                    py37_0  
pyasn1                    0.4.8                      py_0  
pyasn1-modules            0.2.8                      py_0  
pycparser                 2.20                       py_2  
pygments                  2.7.2              pyhd3eb1b0_0  
pyjwt                     1.7.1                    py37_0  
pyopenssl                 19.1.0                     py_1  
pyparsing                 2.4.7                      py_0  
pyqt                      5.9.2            py37h05f1152_2  
pyrsistent                0.17.3           py37h7b6447c_0  
pysocks                   1.7.1                    py37_1  
python                    3.7.9                h7579374_0  
python-dateutil           2.8.1                      py_0  
pytz                      2020.1                     py_0  
pyyaml                    5.3.1            py37h7b6447c_1  
pyzmq                     19.0.2           py37he6710b0_1  
qt                        5.9.7                h5867ecd_1  
qtconsole                 4.7.7                      py_0  
qtpy                      1.9.0                      py_0  
readline                  8.0                  h7b6447c_0  
requests                  2.24.0                     py_0  
requests-oauthlib         1.3.0                      py_0  
rsa                       4.6                        py_0  
scikit-learn              0.23.2           py37h0573a6f_0  
scipy                     1.5.2            py37h0b6359f_0  
send2trash                1.5.0                    py37_0  
setuptools                50.3.1           py37h06a4308_1  
sip                       4.19.8           py37hf484d3e_0  
six                       1.15.0                     py_0  
sqlite                    3.33.0               h62c20be_0  
tensorboard               2.3.0              pyh4dce500_0  
tensorboard-plugin-wit    1.6.0                      py_0  
tensorflow                2.3.0           eigen_py37h189e6a2_0  
tensorflow-base           2.3.0           eigen_py37h3b305d7_0  
tensorflow-estimator      2.3.0              pyheb71bc4_0  
termcolor                 1.1.0                    py37_1  
terminado                 0.9.1                    py37_0  
testpath                  0.4.4                      py_0  
threadpoolctl             2.1.0              pyh5ca1d4c_0  
tk                        8.6.10               hbc83047_0  
tornado                   6.0.4            py37h7b6447c_1  
traitlets                 5.0.5                      py_0  
urllib3                   1.25.11                    py_0  
wcwidth                   0.2.5                      py_0  
webencodings              0.5.1                    py37_1  
werkzeug                  1.0.1                      py_0  
wheel                     0.35.1                     py_0  
widgetsnbextension        3.5.1                    py37_0  
wrapt                     1.12.1           py37h7b6447c_1  
xz                        5.2.5                h7b6447c_0  
yaml                      0.2.5                h7b6447c_0  
yarl                      1.6.2            py37h7b6447c_0  
zeromq                    4.3.3                he6710b0_3  
zipp                      3.4.0              pyhd3eb1b0_0  
zlib                      1.2.11               h7b6447c_3  
zstd                      1.4.5                h9ceee32_0  
(ce14imgcapattend1) rohit@rohitu2004lts:~$

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


		SETTING UP ANACONDA ENVIRONMENT FOR IMG CAP SHOW AND TELL TRAINING

		SETTING UP ENVIRONMENT FOR      IMG CAP SHOW AND TELL TRAINING

	*** create new environment
conda create -n --newENV python=3.7

	*** general stuff
conda install jupyter
conda install pandas
conda install matplotlib

	*** Image Captioning ATTEND training
conda install scikit-learn
conda install keras=2.3.1					## used keras  2.3.1
**conda install -c conda-forge opencv=3.4.2  ## not installed so far
**conda install pydot  ## not installed so far

		PYTHON VERSION CHECK = 3.7.9
(ce14imgcapattend1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ python --version
Python 3.7.9
(ce14imgcapattend1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$

		CONDA LIST AFTER ABOVE STEPS
(ce14imgcapattend1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ conda list
# packages in environment at /home/rohit/anaconda3/envs/ce14imgcapattend1:
#
# Name                    Version                   Build  Channel
_libgcc_mutex             0.1                        main  
_tflow_select             2.3.0                     eigen  
absl-py                   0.11.0           py37h06a4308_0  
aiohttp                   3.6.3            py37h7b6447c_0  
argon2-cffi               20.1.0           py37h7b6447c_1  
astunparse                1.6.3                      py_0  
async-timeout             3.0.1                    py37_0  
async_generator           1.10             py37h28b3542_0  
attrs                     20.3.0             pyhd3eb1b0_0  
backcall                  0.2.0                      py_0  
blas                      1.0                         mkl  
bleach                    3.2.1                      py_0  
blinker                   1.4                      py37_0  
brotlipy                  0.7.0           py37h7b6447c_1000  
c-ares                    1.16.1               h7b6447c_0  
ca-certificates           2020.10.14                    0  
cachetools                4.1.1                      py_0  
certifi                   2020.6.20          pyhd3eb1b0_3  
cffi                      1.14.3           py37he30daa8_0  
chardet                   3.0.4                 py37_1003  
click                     7.1.2                      py_0  
cryptography              3.1.1            py37h1ba5d50_0  
cycler                    0.10.0                   py37_0  
dbus                      1.13.18              hb2f20db_0  
decorator                 4.4.2                      py_0  
defusedxml                0.6.0                      py_0  
entrypoints               0.3                      py37_0  
expat                     2.2.10               he6710b0_2  
fontconfig                2.13.0               h9420a91_0  
freetype                  2.10.4               h5ab3b9f_0  
gast                      0.3.3                      py_0  
glib                      2.66.1               h92f7085_0  
google-auth               1.23.0             pyhd3eb1b0_0  
google-auth-oauthlib      0.4.2              pyhd3eb1b0_2  
google-pasta              0.2.0                      py_0  
grpcio                    1.31.0           py37hf8bcb03_0  
gst-plugins-base          1.14.0               hbbd80ab_1  
gstreamer                 1.14.0               hb31296c_0  
h5py                      2.10.0           py37hd6299e0_1  
hdf5                      1.10.6               hb1b8bf9_0  
icu                       58.2                 he6710b0_3  
idna                      2.10                       py_0  
importlib-metadata        2.0.0                      py_1  
importlib_metadata        2.0.0                         1  
intel-openmp              2020.2                      254  
ipykernel                 5.3.4            py37h5ca1d4c_0  
ipython                   7.19.0           py37hb070fc8_0  
ipython_genutils          0.2.0                    py37_0  
ipywidgets                7.5.1                      py_1  
jedi                      0.17.2                   py37_0  
jinja2                    2.11.2                     py_0  
joblib                    0.17.0                     py_0  
jpeg                      9b                   h024ee3a_2  
jsonschema                3.2.0                      py_2  
jupyter                   1.0.0                    py37_7  
jupyter_client            6.1.7                      py_0  
jupyter_console           6.2.0                      py_0  
jupyter_core              4.6.3                    py37_0  
jupyterlab_pygments       0.1.2                      py_0  
keras                     2.3.1                         0  
keras-applications        1.0.8                      py_1  
keras-base                2.3.1                    py37_0  
keras-preprocessing       1.1.0                      py_1  
kiwisolver                1.3.0            py37h2531618_0  
lcms2                     2.11                 h396b838_0  
ld_impl_linux-64          2.33.1               h53a641e_7  
libedit                   3.1.20191231         h14c3975_1  
libffi                    3.3                  he6710b0_2  
libgcc-ng                 9.1.0                hdf63c60_0  
libgfortran-ng            7.3.0                hdf63c60_0  
libpng                    1.6.37               hbc83047_0  
libprotobuf               3.13.0.1             hd408876_0  
libsodium                 1.0.18               h7b6447c_0  
libstdcxx-ng              9.1.0                hdf63c60_0  
libtiff                   4.1.0                h2733197_1  
libuuid                   1.0.3                h1bed415_2  
libxcb                    1.14                 h7b6447c_0  
libxml2                   2.9.10               hb55368b_3  
lz4-c                     1.9.2                heb0550a_3  
markdown                  3.3.2                    py37_0  
markupsafe                1.1.1            py37h14c3975_1  
matplotlib                3.3.2                         0  
matplotlib-base           3.3.2            py37h817c723_0  
mistune                   0.8.4           py37h14c3975_1001  
mkl                       2020.2                      256  
mkl-service               2.3.0            py37he904b0f_0  
mkl_fft                   1.2.0            py37h23d657b_0  
mkl_random                1.1.1            py37h0573a6f_0  
multidict                 4.7.6            py37h7b6447c_1  
nbclient                  0.5.1                      py_0  
nbconvert                 6.0.7                    py37_0  
nbformat                  5.0.8                      py_0  
ncurses                   6.2                  he6710b0_1  
nest-asyncio              1.4.1                      py_0  
notebook                  6.1.4                    py37_0  
numpy                     1.19.2           py37h54aff64_0  
numpy-base                1.19.2           py37hfa32c7d_0  
oauthlib                  3.1.0                      py_0  
olefile                   0.46                     py37_0  
openssl                   1.1.1h               h7b6447c_0  
opt_einsum                3.1.0                      py_0  
packaging                 20.4                       py_0  
pandas                    1.1.3            py37he6710b0_0  
pandoc                    2.11                 hb0f4dca_0  
pandocfilters             1.4.2                    py37_1  
parso                     0.7.0                      py_0  
pcre                      8.44                 he6710b0_0  
pexpect                   4.8.0                    py37_1  
pickleshare               0.7.5                 py37_1001  
pillow                    8.0.1            py37he98fc37_0  
pip                       20.2.4           py37h06a4308_0  
prometheus_client         0.8.0                      py_0  
prompt-toolkit            3.0.8                      py_0  
prompt_toolkit            3.0.8                         0  
protobuf                  3.13.0.1         py37he6710b0_1  
ptyprocess                0.6.0                    py37_0  
pyasn1                    0.4.8                      py_0  
pyasn1-modules            0.2.8                      py_0  
pycparser                 2.20                       py_2  
pygments                  2.7.2              pyhd3eb1b0_0  
pyjwt                     1.7.1                    py37_0  
pyopenssl                 19.1.0                     py_1  
pyparsing                 2.4.7                      py_0  
pyqt                      5.9.2            py37h05f1152_2  
pyrsistent                0.17.3           py37h7b6447c_0  
pysocks                   1.7.1                    py37_1  
python                    3.7.9                h7579374_0  
python-dateutil           2.8.1                      py_0  
pytz                      2020.1                     py_0  
pyyaml                    5.3.1            py37h7b6447c_1  
pyzmq                     19.0.2           py37he6710b0_1  
qt                        5.9.7                h5867ecd_1  
qtconsole                 4.7.7                      py_0  
qtpy                      1.9.0                      py_0  
readline                  8.0                  h7b6447c_0  
requests                  2.24.0                     py_0  
requests-oauthlib         1.3.0                      py_0  
rsa                       4.6                        py_0  
scikit-learn              0.23.2           py37h0573a6f_0  
scipy                     1.5.2            py37h0b6359f_0  
send2trash                1.5.0                    py37_0  
setuptools                50.3.1           py37h06a4308_1  
sip                       4.19.8           py37hf484d3e_0  
six                       1.15.0                     py_0  
sqlite                    3.33.0               h62c20be_0  
tensorboard               2.3.0              pyh4dce500_0  
tensorboard-plugin-wit    1.6.0                      py_0  
tensorflow                2.3.0           eigen_py37h189e6a2_0  
tensorflow-base           2.3.0           eigen_py37h3b305d7_0  
tensorflow-estimator      2.3.0              pyheb71bc4_0  
termcolor                 1.1.0                    py37_1  
terminado                 0.9.1                    py37_0  
testpath                  0.4.4                      py_0  
threadpoolctl             2.1.0              pyh5ca1d4c_0  
tk                        8.6.10               hbc83047_0  
tornado                   6.0.4            py37h7b6447c_1  
traitlets                 5.0.5                      py_0  
urllib3                   1.25.11                    py_0  
wcwidth                   0.2.5                      py_0  
webencodings              0.5.1                    py37_1  
werkzeug                  1.0.1                      py_0  
wheel                     0.35.1                     py_0  
widgetsnbextension        3.5.1                    py37_0  
wrapt                     1.12.1           py37h7b6447c_1  
xz                        5.2.5                h7b6447c_0  
yaml                      0.2.5                h7b6447c_0  
yarl                      1.6.2            py37h7b6447c_0  
zeromq                    4.3.3                he6710b0_3  
zipp                      3.4.0              pyhd3eb1b0_0  
zlib                      1.2.11               h7b6447c_3  
zstd                      1.4.5                h9ceee32_0  
(ce14imgcapattend1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$

-------------------------------------------------
-------------------------------------------------
-------------------------------------------------

				INDIVIDUAL EXECUTING THE PROGRAMS INDIVIDUALLY

	SPEECH TO TEXT TRANSCRIPTION
			stt_wav_files_loc_1.txt  contents
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input1.wav
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input2.wav
	/home/rohit/PyWDUbuntu/thesis/audio/wavs/input3.wav

python3 stt_transcribe_1.py -wavlocfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/stt_wav_files_loc_1.txt" -opfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/stt_op_file_1.txt"


	IDENTIFY KEYWORDS ELEMENTS
python3 id_elements_3.py -ipfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/stt_op_file_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -opfilekeyelem "/home/rohit/PyWDUbuntu/thesis/combined_execution/queryDb/key_elements_1.txt"


	QUERY DETECTION DATABASE
python3 query_neo_3.py -objarrfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/queryDb/key_elements_1.txt"


	CREATE DETECTION DATABASE
		BUILD AND SAVE MODEL
python3 detection_yolov3_build_save_model_1.py -w /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/yoloWeights/yolov3.weights -smp /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/saved_keras_model/yolov3.saved.model

		MULTIPROCESSING PROCESS IMAGES AND SAVE JOB NEO ARRAYS
python3 detection_yolo3_process_images_multiproc_1.py -smp /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/saved_keras_model/yolov3.saved.model -if /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/Imgs2Detect_20imgs -isrc coco80 -sf 2 -nipt 5 -opfilelocneo /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/Imgs2Detect_20imgs_op4neo

		PICK SAVED NEO ARRAYS OF JOBS AND UPDATE NEO4J GRAPH DB
python3 detection_update_neo_2.py -sf 2 -iploc /home/rohit/PyWDUbuntu/thesis/combined_execution/DectectionDBCreation/Imgs2Detect_20imgs_op4neo

		CYPHER QUERIES
MATCH (n)
DETACH DELETE n

MATCH (n)
RETURN (n)
LIMIT 200


-------------------------------------------------
-------------------------------------------------
-------------------------------------------------

				COMBINED EXECUTING THE PROGRAMS COMBINED

------------------------

labels = ['aeroplane', 'apple', 'backpack', 'banana', 'baseball bat', 'baseball glove', \
          'bear', 'bed', 'bench', 'bicycle', 'bird', 'boat', 'book', 'bottle', 'bowl', \
          'broccoli', 'bus', 'cake', 'car', 'carrot', 'cat', 'cell phone', 'chair', \
          'clock', 'cow', 'cup', 'diningtable', 'dog', 'donut', 'elephant', 'fire hydrant', \
          'fork', 'frisbee', 'giraffe', 'hair drier', 'handbag', 'horse', 'hot dog', \
          'keyboard', 'kite', 'knife', 'laptop', 'microwave', 'motorbike', 'mouse', \
          'orange', 'oven', 'parking meter', 'person', 'pizza', 'pottedplant', \
          'refrigerator', 'remote', 'sandwich', 'scissors', 'sheep', 'sink', 'skateboard', 'skis', \
          'snowboard', 'sofa', 'spoon', 'sports ball', 'stop sign', 'suitcase', 'surfboard', \
          'teddy bear', 'tennis racket', 'tie', 'toaster', 'toilet', 'toothbrush', 'traffic light', \
          'train', 'truck', 'tvmonitor', 'umbrella', 'vase', 'wine glass', 'zebra']

------------------------
Sent 1:	Some persons are standing near a truck
Sent 2:	A man is cycling on his bicycle in the park
Sent 3:	A person is eating his sandwich sitting on a bench

				MIC INPUT AND STT WITH GUI + ID KEYWORDS AND GUI SELECTION + QUERY DB AND GUI IMAGE SELECTION + IMAGE CAPTIONING AND GUI SELECTION

		OPTION 1 - Running with mic input. Specify micYorN parameter = Y.
python3 comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.py -micYorN "Y" -sw_here "/home/rohit/PyWDUbuntu/thesis/audio/wavs/fromMic/" -file4STT "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/mic_input_wavfiles_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -file4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -logfileloc "./LOG_comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.LOG"

		OPTION 2 - Bypass mic input logic, directly execute STT inference logic. Specify micYorN parameter = N.
				   Note that file4STT parameter file MUST exist already and the wav files should be present in the locations specified in this file.
python3 comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.py -micYorN "N" -sw_here "/home/rohit/PyWDUbuntu/thesis/audio/wavs/fromMic/" -file4STT "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/mic_input_wavfiles_1.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -file4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -logfileloc "./LOG_comb_functional_mic_stt_idKey_queryNeo_imgSelect_imgCap_10A-WIP.LOG"


-------------------------------------------------
-------------------------------------------------
-------------------------------------------------
gui_img_cap_module_results = \
[
    {
        'key_elements': ['bicycle', 'person'],
        'selected_images': [
            ['/media/rohit/DATA/EverythingD/01SRHBDBA_AcadsThesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155758.jpg', 'man riding bike in a park']
            ]
            },
    {
        'key_elements': ['tvmonitor', 'person'],
        'selected_images': [
            ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000287296.jpg', 'young girl standing in front of tv playing video game'],
            ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000175337.jpg', 'man walking past a tv in his house']
            ]
            },
    {
        'key_elements': ['handbag'],
        'selected_images': [
            ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000117100.jpg', 'two suitcases are in the boot of a car while a woman holds a hand bag in her hand'],
            ['/media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000313060.jpg', 'woman is holding her hang bag while speaking on her cell phone']
            ]
            }
]

				EXECUTING STORY GENERATOR LOGIC

python3 StyGen_Inference_4A.py -ipf4stygen "/home/rohit/PyWDUbuntu/thesis/combined_execution/ImgCapAfterGui/op_img_cap_after_gui.txt" -ckptdir "/home/rohit/PyWDUbuntu/thesis/StyGen/checkpoint/" -run "Run2_File11_2_checkpoint_run2" -op_res_file "/home/rohit/PyWDUbuntu/thesis/combined_execution/StyGen/op_sty_gen_1.txt" -logfileloc "./LOG_StyGen_Inference_4A.LOG" -nsamp "1" -batsz "1" -len "300" -temp "0.95" -topk "40"

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


		NEO4J DATABASE DUMPING - FROM NEO4J DESKTOP

Go to manage and open the terminal. Terminal will be opened in suitable folder for the database. Inside this, is a BIN folder, inside that is the neo4j-admin tool to be used. E.g.
	rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ pwd
	
	/home/rohit/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3
	
	rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ ls
	bin  certificates  conf  data  import  lib  LICENSES.txt  LICENSE.txt  logs  metrics  NOTICE.txt  plugins  README.txt  run  UPGRADE.txt
	rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$

No matter what name i gave the database in the Project, in reality it seems to be neo4j. Here, in the PROJECT    Project_Thesis_1       the db is called    ngThesis_Obj_Det_Db_1
	but in reality the db name is still neo4j

Verified as follows. Started db, opened browser. Then:
	:use system
Then
	show databases
Output was
╒════════╤════════════════╤════════════╤═════════════════╤═══════════════╤═══════╤═════════╕
│"name"  │"address"       │"role"      │"requestedStatus"│"currentStatus"│"error"│"default"│
╞════════╪════════════════╪════════════╪═════════════════╪═══════════════╪═══════╪═════════╡
│"neo4j" │"localhost:7687"│"standalone"│"online"         │"online"       │""     │true     │
├────────┼────────────────┼────────────┼─────────────────┼───────────────┼───────┼─────────┤
│"system"│"localhost:7687"│"standalone"│"online"         │"online"       │""     │false    │
└────────┴────────────────┴────────────┴─────────────────┴───────────────┴───────┴─────────┘
Then returned to the database i built
	:use neo4j


As per link: https://neo4j.com/docs/operations-manual/current/tools/dump-load/
format is:
Dump the database called neo4j into a file called /backups/neo4j/2016-10-02.dump. The destination directory for the dump file - in this case /backups/neo4j - must exist before calling the command.
$neo4j-home> bin/neo4j-admin dump --database=neo4j --to=/backups/neo4j/2016-10-02.dump 

	EXAMPLE OF DOING THIS FROM THE COMMAND LINE - USED REGULAR COMMAND LINE AND NOT FROM WITHIN THE NEO4J DESKTOP APPLICATION
        rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ 
        rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ cd "/home/rohit/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3"
        rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ ls
        bin  certificates  conf  data  import  lib  LICENSES.txt  LICENSE.txt  logs  metrics  NOTICE.txt  plugins  README.txt  run  UPGRADE.txt
        rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ ls ./bin/neo4j-admin 
        ./bin/neo4j-admin
        rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ 
        rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$ ./bin/neo4j-admin dump --verbose --database=neo4j --to=/home/rohit/PyWDUbuntu/thesis/neo4jDump/ngThesisObjDetDb1202007172200.dump
        WARNING: Max 1024 open files allowed, minimum of 40000 recommended. See the Neo4j manual.
        Done: 68 files, 269.1MiB processed.
        rohit@rohitu2004lts:~/.config/Neo4j Desktop/Application/neo4jDatabases/database-25da62ad-3332-4f6d-8fa2-86c4becf2f97/installation-4.0.3$


xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


							GUI USING TKINTER

--------------------------------------------------------------------------------------
--------------------------------------------------------------------------------------

		Show some buttons and detect press, throw up new window
		
	my question on stackoverflow: https://stackoverflow.com/questions/6920302/how-to-pass-arguments-to-a-button-command-in-tkinter

				About gui_query_neo_results_image_selection_8.py
		Has image row + Enlarge button + Select button.
		Max 20 thumbnails.
		Root -> Grid window -> Enlarged image window -> Inference image window
		Inference image window displays inferenece info textually in label.
		Grid window shows live count of currently Selected images.
		Maximum 5 images per query allowed.
		Possible to Deselect ALL the images for a query.
		Inference logic is part of dedicated class. The object for it is made in the Grid window (so new object will be made for each Query processing)
		
		PENDING: REVAMP TO drop use of Enlarge button. User should click the thumbnail itself to see Enarged image.

python3 gui_query_neo_results_image_selection_8.py




				About gui_query_neo_results_image_selection_9.py
		Compared to version 8, completely revamped code to use least number of widgets. No frames used now.
		Has thumbnail image row + Enlarge button
		No Select button as the Image thumbnail itself can be clicked to Select the image
		Max 20 thumbnails.
		Root -> Grid window -> Enlarged image window -> Inference image window
		Inference image window displays inferenece info textually in label.
		Grid window shows live count of currently Selected images.
		Maximum 5 images per query allowed.
		Possible to Deselect ALL the images for a query.
		Inference logic is part of dedicated class. The object for it is made in the Grid window (so new object will be made for each Query processing)
		
		PENDING: REVAMP TO drop use of Enlarge button. User should click the thumbnail itself to see Enarged image.

python3 gui_query_neo_results_image_selection_9.py




xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx




							IMAGE CAPTIONING

		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1
		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1
		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1

Image Captioning with Keras		Link: https://towardsdatascience.com/image-captioning-with-keras-teaching-computers-to-describe-pictures-c88a46a311b8


	Usage key:
python3 ImgCap_Reload_Lappy_Infer_1.py -img "/Path/Image/ToInfer/filename.jpg" -wtfile "/Path/PickleFile/WeightsDecoder/filename.h5"


	Testing it out:

python3 ImgCap_Reload_Lappy_Infer_1.py -img "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000000001.jpg" -wtfile "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_5.h5"

python3 ImgCap_Reload_Lappy_Infer_1.py -img "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000003104.jpg" -wtfile  "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_8.h5"

python3 ImgCap_Reload_Lappy_Infer_2.py -img "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000003104.jpg" -wtfile  "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_8.h5"

python3 comb_functional_stt_id_gui_query_img_select_gui_img_cap_5B-WIP.py -wavlocfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/st_1_HM_Rohit.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -logfileloc "./LOG_comb_functional_stt_id_gui_query_img_select_gui_img_cap_5B-WIP.LOG"



python3 comb_functional_stt_id_gui_query_img_select_gui_img_cap_6A-WIP.py -wavlocfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/st_1_HM_Rohit.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -logfileloc "./LOG_comb_functional_stt_id_gui_query_img_select_gui_img_cap_6A-WIP.LOG"



xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx




							IMAGE CAPTIONING

		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2
		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2
		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2		APPROACH 2

Image captioning with visual attention		Link: https://towardsdatascience.com/image-captioning-with-keras-teaching-computers-to-describe-pictures-c88a46a311https://www.tensorflow.org/tutorials/text/image_captioning

COCO 2017 TRAIN has 118287 images.
For all 118287 images, passed through encoder bottleneck and stored the encodings as .npy files.
Kaggle dataset = https://www.kaggle.com/pandasudipt/rohits-encodings

Took first 100k images for training. Script splits this into 95% - 05% as Train : Test. But losses only captured for the training. No validation losses are used.

I kept the next 5k images from TRAIN dataset (as encoding already available, as opposed to the VAL 2017 dataset).
PICKLED to file ATTEND_images_5k_for_bleu_scoring.pkl   - Location: /media/rohit/DATA/EverythingD/01SRHBDBA_Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCapAttention/SavedData/

Notes on the tokenizer.
Top 5000 words from vocabulary used.
PICKED TOKENIZER - necessary for infernece later. MUST use same one created and used during training process.
Max_length = 52

For inference, saved weights after each epoch. But HAVE to run a dummy training loop first and only then the weights can be populated.



											TRAINING NOTES:

Data = 100k images

					TRAINING PARAMETERS

		Epochs = 0 - ??
BATCH_SIZE = 128
LR = 0.001
					UNCHANGING TRAINING PARAMS
BUFFER_SIZE = 250
embedding_dim = 256
units = 512
top_k = 5000 most common words in captions
vocab_size = top_k + 1
num_steps = len(img_name_train) // BATCH_SIZE
		works out to = 500000 // 128 = 3900 approx
		500k because approx. 5 captions per image i.e. 100k * 5 (image,caption) sets for training
# Shape of the vector extracted from InceptionV3 is (64, 2048)
# These two variables represent that vector shape
features_shape = 2048
attention_features_shape = 64
					LEARNING RATE
LR = default of the optimizer setup as adam. LR = 0.001
	print(f"Using learning rate = {optimizer.learning_rate.numpy()}")
	Using learning rate = 0.0010000000474974513
					OPTIMIZER
optimizer = tf.keras.optimizers.Adam()
					LOSS FUNCTION
Sparse Categorical Crossentropy
	loss_object = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True, reduction='none')
	def loss_function(real, pred):
		mask = tf.math.logical_not(tf.math.equal(real, 0))
		loss_ = loss_object(real, pred)
		mask = tf.cast(mask, dtype=loss_.dtype)
		loss_ *= mask
		return tf.reduce_mean(loss_)


											TRAINING LOSSES EPOCH WISE
----------------------
Epoch 1 Loss 0.676393
Epoch 2 Loss 0.589199
Epoch 3 Loss 0.565119
Epoch 4 Loss 0.549900
Epoch 5 Loss 0.538393
Epoch 6 Loss 0.529474
Epoch 7 Loss 0.521033
Epoch 8 Loss 0.514176
Epoch 9 Loss 0.507658
Epoch 10 Loss 0.501702
Epoch 11 Loss 0.496420
Epoch 12 Loss 0.491741
Epoch 13 Loss 0.487315
Epoch 14 Loss 0.483437
Epoch 15 Loss 0.480037
Epoch 16 Loss 0.476580
Epoch 17 Loss 0.473475
Epoch 18 Loss 0.470565
Epoch 19 Loss 0.468022
----------------------
Epoch 20 Loss 0.465582
Epoch 21 Loss 0.463329
Epoch 22 Loss 0.461324
----------------------

----------------------------------------------------------------------------
----------------------------------------------------------------------------
----------------------------------------------------------------------------


					TRAINING RUN CELL OUTPUT - EPOCHS 19 - 21
EPOCHS = 3


Training Start time = 15:40:22
Epoch 20 Batch 0 Loss 0.4963
Epoch 20 Batch 1000 Loss 0.4462
Epoch 20 Batch 2000 Loss 0.4399
Epoch 20 Batch 3000 Loss 0.5034
Epoch 20 Loss 0.465582
Time taken for 1 epoch 1312.2450647354126 sec


Saved weights for epoch 19 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_19.h5


EMAIL SUCCESS - for epoch 19

Epoch 21 Batch 0 Loss 0.4945
Epoch 21 Batch 1000 Loss 0.4505
Epoch 21 Batch 2000 Loss 0.4633
Epoch 21 Batch 3000 Loss 0.4564
Epoch 21 Loss 0.463329
Time taken for 1 epoch 1237.0759704113007 sec


Saved weights for epoch 20 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_20.h5


EMAIL SUCCESS - for epoch 20

Epoch 22 Batch 0 Loss 0.4891
Epoch 22 Batch 1000 Loss 0.4532
Epoch 22 Batch 2000 Loss 0.4520
Epoch 22 Batch 3000 Loss 0.4667
Epoch 22 Loss 0.461324
Time taken for 1 epoch 1241.8087813854218 sec


Saved weights for epoch 21 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_21.h5


EMAIL SUCCESS - for epoch 21

Training End time = 16:44:21

----------------------------------------------------------------------------
----------------------------------------------------------------------------
----------------------------------------------------------------------------

					TRAINING RUN CELL OUTPUT - EPOCHS 0 - 18
EPOCHS = 10


Training Start time = 23:38:24
Epoch 1 Batch 0 Loss 1.9765
Epoch 1 Batch 1000 Loss 0.7000
Epoch 1 Batch 2000 Loss 0.6242
Epoch 1 Batch 3000 Loss 0.6220
Epoch 1 Loss 0.676393
Time taken for 1 epoch 1469.1629593372345 sec


Saved weights for epoch 0 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_0.h5


EMAIL SUCCESS - for epoch 0

Epoch 2 Batch 0 Loss 0.6573
Epoch 2 Batch 1000 Loss 0.6016
Epoch 2 Batch 2000 Loss 0.5702
Epoch 2 Batch 3000 Loss 0.5760
Epoch 2 Loss 0.589199
Time taken for 1 epoch 1357.2378134727478 sec


Saved weights for epoch 1 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_1.h5


EMAIL SUCCESS - for epoch 1

Epoch 3 Batch 0 Loss 0.6469
Epoch 3 Batch 1000 Loss 0.5580
Epoch 3 Batch 2000 Loss 0.5775
Epoch 3 Batch 3000 Loss 0.5510
Epoch 3 Loss 0.565119
Time taken for 1 epoch 1238.9477112293243 sec


Saved weights for epoch 2 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_2.h5


EMAIL SUCCESS - for epoch 2

Epoch 4 Batch 0 Loss 0.5897
Epoch 4 Batch 1000 Loss 0.5591
Epoch 4 Batch 2000 Loss 0.5211
Epoch 4 Batch 3000 Loss 0.5109
Epoch 4 Loss 0.549900
Time taken for 1 epoch 1223.5103750228882 sec


Saved weights for epoch 3 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_3.h5


EMAIL SUCCESS - for epoch 3

Epoch 5 Batch 0 Loss 0.5866
Epoch 5 Batch 1000 Loss 0.5571
Epoch 5 Batch 2000 Loss 0.5337
Epoch 5 Batch 3000 Loss 0.5176
Epoch 5 Loss 0.538393
Time taken for 1 epoch 1227.4499864578247 sec


Saved weights for epoch 4 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_4.h5


EMAIL SUCCESS - for epoch 4

Epoch 6 Batch 0 Loss 0.5969
Epoch 6 Batch 1000 Loss 0.5495
Epoch 6 Batch 2000 Loss 0.5251
Epoch 6 Batch 3000 Loss 0.4790
Epoch 6 Loss 0.529474
Time taken for 1 epoch 1333.849419593811 sec


Saved weights for epoch 5 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_5.h5


EMAIL SUCCESS - for epoch 5

Epoch 7 Batch 0 Loss 0.5456
Epoch 7 Batch 1000 Loss 0.4821
Epoch 7 Batch 2000 Loss 0.5490
Epoch 7 Batch 3000 Loss 0.5361
Epoch 7 Loss 0.521033
Time taken for 1 epoch 1306.3792600631714 sec


Saved weights for epoch 6 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_6.h5


EMAIL SUCCESS - for epoch 6

Epoch 8 Batch 0 Loss 0.5667
Epoch 8 Batch 1000 Loss 0.5063
Epoch 8 Batch 2000 Loss 0.4934
Epoch 8 Batch 3000 Loss 0.5204
Epoch 8 Loss 0.514176
Time taken for 1 epoch 1227.5454032421112 sec


Saved weights for epoch 7 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_7.h5


EMAIL SUCCESS - for epoch 7

Epoch 9 Batch 0 Loss 0.5552
Epoch 9 Batch 1000 Loss 0.4934
Epoch 9 Batch 2000 Loss 0.4892
Epoch 9 Batch 3000 Loss 0.4545
Epoch 9 Loss 0.507658
Time taken for 1 epoch 1247.2033836841583 sec


Saved weights for epoch 8 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_8.h5


EMAIL SUCCESS - for epoch 8

Epoch 10 Batch 0 Loss 0.5496
Epoch 10 Batch 1000 Loss 0.4806
Epoch 10 Batch 2000 Loss 0.5064
Epoch 10 Batch 3000 Loss 0.4767
Epoch 10 Loss 0.501702
Time taken for 1 epoch 1373.2115569114685 sec


Saved weights for epoch 9 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_9.h5


EMAIL SUCCESS - for epoch 9

Training End time = 03:17:04


EPOCHS = 10


Training Start time = 03:19:55
Epoch 11 Batch 0 Loss 0.5070
Epoch 11 Batch 1000 Loss 0.4995
Epoch 11 Batch 2000 Loss 0.4741
Epoch 11 Batch 3000 Loss 0.5001
Epoch 11 Loss 0.496420
Time taken for 1 epoch 1336.0986368656158 sec


Saved weights for epoch 10 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_10.h5


EMAIL SUCCESS - for epoch 10

Epoch 12 Batch 0 Loss 0.5068
Epoch 12 Batch 1000 Loss 0.4895
Epoch 12 Batch 2000 Loss 0.4690
Epoch 12 Batch 3000 Loss 0.5170
Epoch 12 Loss 0.491741
Time taken for 1 epoch 1332.7439448833466 sec


Saved weights for epoch 11 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_11.h5


EMAIL SUCCESS - for epoch 11

Epoch 13 Batch 0 Loss 0.4873
Epoch 13 Batch 1000 Loss 0.4580
Epoch 13 Batch 2000 Loss 0.5144
Epoch 13 Batch 3000 Loss 0.4850
Epoch 13 Loss 0.487315
Time taken for 1 epoch 1371.106444120407 sec


Saved weights for epoch 12 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_12.h5


EMAIL SUCCESS - for epoch 12

Epoch 14 Batch 0 Loss 0.4998
Epoch 14 Batch 1000 Loss 0.4792
Epoch 14 Batch 2000 Loss 0.5116
Epoch 14 Batch 3000 Loss 0.4899
Epoch 14 Loss 0.483437
Time taken for 1 epoch 1391.9938645362854 sec


Saved weights for epoch 13 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_13.h5


EMAIL SUCCESS - for epoch 13

Epoch 15 Batch 0 Loss 0.5078
Epoch 15 Batch 1000 Loss 0.4592
Epoch 15 Batch 2000 Loss 0.4688
Epoch 15 Batch 3000 Loss 0.4562
Epoch 15 Loss 0.480037
Time taken for 1 epoch 1375.9522497653961 sec


Saved weights for epoch 14 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_14.h5


EMAIL SUCCESS - for epoch 14

Epoch 16 Batch 0 Loss 0.5429
Epoch 16 Batch 1000 Loss 0.4889
Epoch 16 Batch 2000 Loss 0.4788
Epoch 16 Batch 3000 Loss 0.4785
Epoch 16 Loss 0.476580
Time taken for 1 epoch 1348.2974610328674 sec


Saved weights for epoch 15 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_15.h5


EMAIL SUCCESS - for epoch 15

Epoch 17 Batch 0 Loss 0.5226
Epoch 17 Batch 1000 Loss 0.4768
Epoch 17 Batch 2000 Loss 0.4696
Epoch 17 Batch 3000 Loss 0.4842
Epoch 17 Loss 0.473475
Time taken for 1 epoch 1338.721260547638 sec


Saved weights for epoch 16 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_16.h5


EMAIL SUCCESS - for epoch 16

Epoch 18 Batch 0 Loss 0.4820
Epoch 18 Batch 1000 Loss 0.4663
Epoch 18 Batch 2000 Loss 0.4770
Epoch 18 Batch 3000 Loss 0.4732
Epoch 18 Loss 0.470565
Time taken for 1 epoch 1393.0677936077118 sec


Saved weights for epoch 17 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_17.h5


EMAIL SUCCESS - for epoch 17

Epoch 19 Batch 0 Loss 0.5158
Epoch 19 Batch 1000 Loss 0.4714
Epoch 19 Batch 2000 Loss 0.4530
Epoch 19 Batch 3000 Loss 0.4541
Epoch 19 Loss 0.468022
Time taken for 1 epoch 1376.421673297882 sec


Saved weights for epoch 18 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_18.h5


Saved weights for epoch 18 to:
../working/weights_out/ATTEND_Run4_Decoder_wts_ep_18.h5


EMAIL SUCCESS - for epoch 18

Epoch 20 Batch 0 Loss 0.4723

Then failed
---------------------------------------------------------------------------
KeyboardInterrupt                         Traceback (most recent call last)
<ipython-input-102-5b260a5854c9> in <module>
     13 
     14     for (batch, (img_tensor, target)) in enumerate(dataset):
---> 15         batch_loss, t_loss = train_step(img_tensor, target)
     16         total_loss += t_loss
     17 

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py in __call__(self, *args, **kwds)
    778       else:
    779         compiler = "nonXla"
--> 780         result = self._call(*args, **kwds)
    781 
    782       new_tracing_count = self._get_tracing_count()

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py in _call(self, *args, **kwds)
    805       # In this case we have created variables on the first call, so we run the
    806       # defunned version which is guaranteed to never create variables.
--> 807       return self._stateless_fn(*args, **kwds)  # pylint: disable=not-callable
    808     elif self._stateful_fn is not None:
    809       # Release the lock early so that multiple threads can perform the call

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/function.py in __call__(self, *args, **kwargs)
   2827     with self._lock:
   2828       graph_function, args, kwargs = self._maybe_define_function(args, kwargs)
-> 2829     return graph_function._filtered_call(args, kwargs)  # pylint: disable=protected-access
   2830 
   2831   @property

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/function.py in _filtered_call(self, args, kwargs, cancellation_manager)
   1846                            resource_variable_ops.BaseResourceVariable))],
   1847         captured_inputs=self.captured_inputs,
-> 1848         cancellation_manager=cancellation_manager)
   1849 
   1850   def _call_flat(self, args, captured_inputs, cancellation_manager=None):

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/function.py in _call_flat(self, args, captured_inputs, cancellation_manager)
   1922       # No tape is watching; skip to running the function.
   1923       return self._build_call_outputs(self._inference_function.call(
-> 1924           ctx, args, cancellation_manager=cancellation_manager))
   1925     forward_backward = self._select_forward_and_backward_functions(
   1926         args,

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/function.py in call(self, ctx, args, cancellation_manager)
    548               inputs=args,
    549               attrs=attrs,
--> 550               ctx=ctx)
    551         else:
    552           outputs = execute.execute_with_cancellation(

/opt/conda/lib/python3.7/site-packages/tensorflow/python/eager/execute.py in quick_execute(op_name, num_outputs, inputs, attrs, ctx, name)
     58     ctx.ensure_initialized()
     59     tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
---> 60                                         inputs, attrs, num_outputs)
     61   except core._NotOkStatusException as e:
     62     if name is not None:

KeyboardInterrupt: 

Search Stack Overflow


---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

				CHECKPOINT DIR CONTENTS AT FAILURE
checkpoint		     ckpt-17.index
ckpt-15.data-00000-of-00001  ckpt-18.data-00000-of-00001
ckpt-15.index		     ckpt-18.index
ckpt-16.data-00000-of-00001  ckpt-19.data-00000-of-00001
ckpt-16.index		     ckpt-19.index
ckpt-17.data-00000-of-00001

---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------


			decoder.summary()
Model: "rnn__decoder"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
embedding (Embedding)        multiple                  1280256   
_________________________________________________________________
gru (GRU)                    multiple                  1575936   
_________________________________________________________________
dense_1 (Dense)              multiple                  262656    
_________________________________________________________________
dense_2 (Dense)              multiple                  2565513   
_________________________________________________________________
bahdanau_attention (Bahdanau multiple                  394753    
=================================================================
Total params: 6,079,114
Trainable params: 6,079,114
Non-trainable params: 0
_________________________________________________________________



			decoder.attention.summary()
Model: "bahdanau_attention"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
dense_3 (Dense)              multiple                  131584    
_________________________________________________________________
dense_4 (Dense)              multiple                  262656    
_________________________________________________________________
dense_5 (Dense)              multiple                  513       
=================================================================
Total params: 394,753
Trainable params: 394,753
Non-trainable params: 0
_________________________________________________________________


---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
	-- use results of two previous stages to prepare data for this functionality to work on

##              5) Expects the results from two previous stages to be sent. This will be combined for processing by
##                 this stage. The two previous stages are:
##                 a) Id Key Elements - final selected words by user for each sentence that were used to query Neo4j
##                 b) GUI Candidate Image Selection - final images selected by user from the images output by Neo4j query

    """
    ## Explanation of the data preparation using previous stage outputs:
    ## 
    ## The main variable is a list of exactly 3 items - one for each of the original input sentence.
    ##     Each of these entries in the list is a dict with two keys: 'key_elements' and 'selected_images'
    ## 'key_elements' is a list of objects selected by user at end of the Id Key Elements stage
    ##      - 0 to 3 values - can be empty list too
    ## 'selected_images' is a list containing tuples. These tuples represent each of the images finally selected
    ##      by the user at end GUI Selection of images output by the Neo4j query.
    ##      - 0 to 5 images - can be empty list too
    ##      Regarding tuple: first entry is the image path, second is initialed as None to be filled later with
    ##          the caption after processing the image through this stage.
    ##          Thus, ('/full/path/to/image.jpg' , None) will become something like
    ##                ('/full/path/to/image.jpg' , 'caption of the images after processing')
    ## 
    ## Example of how the data structure could be in this scenario:
    ## For input sentence 1, the user finally selected 2 Key Elements, then out of the up to 20 images
    ##     returned by the neo4j query, user selected only 3 images to send to captioning stage while
    ##     up to 5 could have been selected.
    ## For input sentence 2, the user finally selected 0 Key Elements, thus there were no images
    ##     returned by the neo4j query, and nothing for the user to select and to send to captioning stage.
    ## For input sentence 3, the user finally selected 3 Key Elements, then out of the up to 20 images
    ##     returned by the neo4j query, user selected 0 images to send to captioning stage while
    ##     up to 5 could have been selected.
    ## -----------------------------------------------------------------------------
    example_data_usable_by_img_captioning_functionality = \
    [
        {
            'key_elements' : ['q1_obj1', 'q1_obj2'],
            'selected_images' : [
                ('Image': '/path/to/q1_image1.jpg' , None),
                ('Image': '/path/to/q1_image2.jpg' , None),
                ('Image': '/path/to/q1_image3.jpg' , None)
            ]
        },
        {
            'key_elements' : [],
            'selected_images' : []
        },
        {
            'key_elements' : ['q3_obj1', 'q3_obj2', 'q3_obj3'],
            'selected_images' : []
        }
    ]
    ## -----------------------------------------------------------------------------


---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------


		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1
		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1
		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1		APPROACH 1

Image captioning with visual attention		Link: https://www.tensorflow.org/tutorials/text/image_captioning 



---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

				EXAMPLE OF RUN OF ALL PREVIOUS COMBINED LOGIC - LAST STAGE IMAGE SELECTION VIA GUI STAGE
				
				Query 1: Had not words as all deselected during id key elements stage
				Query 2: One key element "car" - selected only 4 images to send to image captioning stage
				Query 3: Two key elements "person" and "truck" - selected only 5 images to send to image captioning stage


python3 comb_functional_stt_id_gui_query_img_select_gui_4G-WIP.py -wavlocfile "/home/rohit/PyWDUbuntu/thesis/combined_execution/SttTranscribe/st_1_HM_Rohit.txt" -opfileallposinfo "/home/rohit/PyWDUbuntu/thesis/combined_execution/IdElements/all_words_pos_info_1.txt" -logfileloc "./LOG_comb_functional_stt_id_gui_query_img_select_gui_4G_WIP.LOG"

-------------------------------------------------------------------
-------------------------------------------------------------------
  STARTING EXECUTION OF IMAGE SELECTION VIA GUI                    
-------------------------------------------------------------------
-------------------------------------------------------------------


LOG_LEVEL DEBUG :: 
Completed selection process - Query number 1
Number of images before selection began = 0

Number of images Deselected by user = 0.
Number of images that will remain = 0

LOG_LEVEL DEBUG :: Num of images = 20
array=
['/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000033951.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000033825.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000292186.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000155796.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000140031.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000139832.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000103436.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000146856.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000088355.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000088316.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000039056.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000038943.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000127879.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000224207.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000292604.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000215662.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000313777.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000313690.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000484560.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000484558.jpg']

LOG_LEVEL INFO :: 
For Query 2, Deselected positions=
[0, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 19]
LOG_LEVEL DEBUG :: 
Completed selection process - Query number 2
Number of images before selection began = 20

Number of images Deselected by user = 16.
Number of images that will remain = 4

LOG_LEVEL DEBUG :: Num of images = 20
array=
['/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000169542.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000169516.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000292186.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000146747.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000313777.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000449668.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000509771.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000012149.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000168815.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000168743.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000518174.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000017467.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000581864.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000225580.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000265504.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000361201.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000304424.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000225081.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000225051.jpg', '/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Data/COCO_test2017_41k/test2017/000000499699.jpg']

LOG_LEVEL INFO :: 
For Query 3, Deselected positions=
[1, 2, 3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 17, 18, 19]
LOG_LEVEL DEBUG :: 
Completed selection process - Query number 3
Number of images before selection began = 20

Number of images Deselected by user = 15.
Number of images that will remain = 5

LOG_LEVEL DEBUG :: 

-------------------------------- SUMMARY INFORMATON --------------------------------

LOG_LEVEL DEBUG :: For Query 1
Number of candidate images before selection = 0
Number of Deselections done = 0
Number of images remaining after Deselections = 0

LOG_LEVEL DEBUG :: 
	------ Query images info BEFORE::
[]
	------ Positions removed::
[]
	------ Query images info AFTER::
[]


LOG_LEVEL DEBUG :: For Query 2
Number of candidate images before selection = 20
Number of Deselections done = 16
Number of images remaining after Deselections = 4

LOG_LEVEL DEBUG :: 
	------ Query images info BEFORE::
[{'Image': '000000033951.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000033825.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000292186.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000155796.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000140031.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000139832.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000103436.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000146856.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000088355.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000088316.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000039056.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000038943.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000127879.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000224207.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000292604.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000215662.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313777.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313690.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000484560.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000484558.jpg', 'Source': 'coco_test_2017'}]
	------ Positions removed::
[0, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 19]
	------ Query images info AFTER::
[{'Image': '000000033825.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000155796.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000224207.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313777.jpg', 'Source': 'coco_test_2017'}]


LOG_LEVEL DEBUG :: For Query 3
Number of candidate images before selection = 20
Number of Deselections done = 15
Number of images remaining after Deselections = 5

LOG_LEVEL DEBUG :: 
	------ Query images info BEFORE::
[{'Image': '000000169542.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000169516.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000292186.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000146747.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313777.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000449668.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000509771.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000012149.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000168815.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000168743.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000518174.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000017467.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000581864.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000225580.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000265504.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000361201.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000304424.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000225081.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000225051.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000499699.jpg', 'Source': 'coco_test_2017'}]
	------ Positions removed::
[1, 2, 3, 4, 6, 7, 8, 9, 11, 12, 13, 14, 17, 18, 19]
	------ Query images info AFTER::
[{'Image': '000000169542.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000449668.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000518174.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000361201.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000304424.jpg', 'Source': 'coco_test_2017'}]


LOG_LEVEL INFO :: 
After GUI CANDIDATE IMAGES SELECTION logic execution:
gui_candidate_image_selection_logic_RC = 0
gui_candidate_image_selection_logic_msg = None
gui_candidate_image_selection_module_results = [[], [{'Image': '000000033825.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000155796.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000224207.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313777.jpg', 'Source': 'coco_test_2017'}], [{'Image': '000000169542.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000449668.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000518174.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000361201.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000304424.jpg', 'Source': 'coco_test_2017'}]]

LOG_LEVEL INFO :: 
Images retained after Deselections (to be passed to Auto-caption block):

LOG_LEVEL INFO :: 
1) Keywords: []
Selected Images results:
[]
LOG_LEVEL INFO :: 
2) Keywords: ['car']
Selected Images results:
[{'Image': '000000033825.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000155796.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000224207.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000313777.jpg', 'Source': 'coco_test_2017'}]
LOG_LEVEL INFO :: 
3) Keywords: ['person', 'truck']
Selected Images results:
[{'Image': '000000169542.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000449668.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000518174.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000361201.jpg', 'Source': 'coco_test_2017'}, {'Image': '000000304424.jpg', 'Source': 'coco_test_2017'}]
LOG_LEVEL INFO :: 

-------------------------------------------------------------------
-------------------------------------------------------------------
  STARTING EXECUTION OF IMAGE SELECTION VIA GUI                    
-------------------------------------------------------------------
-------------------------------------------------------------------


LOG_LEVEL INFO :: 


Normal exit from program.




---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

			Find validation losses on already trained decoder model - all with BS=64
	Script: ImgCap_Check_Val_Loss_Lappy_1.py
## compile model - note that all layers frozen as model set as trainable = False during loading
reloaded_RNN_decoder.compile(loss='categorical_crossentropy', metrics=['accuracy'])

## make data suitable to use for model evaluation step
inputs, outputs = create_data_for_evaluation(descriptions_arr, imgs_encodings_arr, wordtoix, MAX_LENGTH_CAPTION, VOCAB_SIZE)

start_timestamp = datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S')
start_tick = time.time()

print(f"\n\nStarted at = {start_timestamp}\n")

## evaluate it and get score
model_loss = reloaded_RNN_decoder.evaluate(inputs, outputs, batch_size=BATCH_SIZE)
print(f"\n\nLoss with Batch size of {BATCH_SIZE} =\n{model_loss}\n\n")

---------------------------------------------------------
			Validation Dataset (3k images) Losses AFTER model is trained - so technically used it as a Test set loss
			Run on Model 3 - Epoch 2 to 18
			MODEL 3			MODEL 3			MODEL 3			MODEL 3			MODEL 3
---------------------------------------------------------

python3 ImgCap_Check_Val_Loss_Lappy_1.py -wtfile "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run3/Decoder_Run_3_Wt_ep_18.h5"

(ce7comb1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ python3 ImgCap_Check_Val_Loss_Lappy_1.py -wtfile "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run3/Decoder_Run_3_Wt_ep_18.h5"

Check wordtoix entries ::
startseq = 1	endseq = 9	bird = 974
Check ixtoword entries ::
ix 1 = startseq	ix 10 = red	ix 974 = bird

2020-10-09 01:45:21.473022: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-10-09 01:45:21.503822: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2199995000 Hz
2020-10-09 01:45:21.504628: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55f5af12d200 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-09 01:45:21.504660: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-10-09 01:45:21.504813: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.

SUCCESS - Reloaded weights from :: /media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run3/Decoder_Run_3_Wt_ep_18.h5

RNN Decoder model (non-trainable type) defined with these paramenters:
EMBEDDING_DIMS = 200 , VOCAB_SIZE = 6758 , MAX_LENGTH_CAPTION = 49
Attempting to load weights...

Length of Descriptions dict = 3000



Started at = 2020-10-09 01:45:35

116287/116287 [==============================] - 536s 5ms/sample - loss: 3.0886 - accuracy: 0.3635


Loss with Batch size of 64 =
[3.088649831643242, 0.3634628]




Ended at = 2020-10-09 01:54:35
Time taken = 539.990523815155 seconds


Done

(ce7comb1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$

---------------------------------------------------------

		Epoch 18
116287/116287 [==============================] - 536s 5ms/sample - loss: 3.0886 - accuracy: 0.3635
Loss with Batch size of 64 =
[3.088649831643242, 0.3634628]
		Epoch 16
116287/116287 [==============================] - 516s 4ms/sample - loss: 3.0937 - accuracy: 0.3632
Loss with Batch size of 64 =
[3.0936912543075312, 0.36319622]
		Epoch 14 -- seems to be wrong - maybe accidentally overwritten the weights file - or it was not saved properly
116287/116287 [==============================] - 516s 4ms/sample - loss: 3.0882 - accuracy: 0.3629
Loss with Batch size of 64 =
[3.088215761960429, 0.36293826]
		AGAIN Epoch 14
116287/116287 [==============================] - 520s 4ms/sample - loss: 3.0882 - accuracy: 0.3629
Loss with Batch size of 64 =
[3.088215761960429, 0.36293826]
		Epoch 12
116287/116287 [==============================] - 522s 4ms/sample - loss: 3.1133 - accuracy: 0.3587
Loss with Batch size of 64 =
[3.113307865008768, 0.35872453]
		Epoch 10
116287/116287 [==============================] - 519s 4ms/sample - loss: 3.1144 - accuracy: 0.3584
Loss with Batch size of 64 =
[3.11437327314346, 0.35841495]
		Epoch 8
116287/116287 [==============================] - 516s 4ms/sample - loss: 3.1233 - accuracy: 0.3563
Loss with Batch size of 64 =
[3.1233026144950213, 0.3562565]
		Epoch 6
116287/116287 [==============================] - 526s 5ms/sample - loss: 3.1429 - accuracy: 0.3537
Loss with Batch size of 64 =
[3.142919300563814, 0.35367668]
		Epoch 4
116287/116287 [==============================] - 516s 4ms/sample - loss: 3.1752 - accuracy: 0.3472
Loss with Batch size of 64 =
[3.1751763146481715, 0.3471755]
		Epoch 2
116287/116287 [==============================] - 517s 4ms/sample - loss: 3.2749 - accuracy: 0.3328
Loss with Batch size of 64 =
[3.2749193742732507, 0.3327801]


---------------------------------------------------------
			Validation Dataset (3k images) Losses AFTER model is trained - so technically used it as a Test set loss
			Run on Model 2 - Epoch 2 to 10
			MODEL 2			MODEL 2			MODEL 2			MODEL 2			MODEL 2
---------------------------------------------------------

python3 ImgCap_Check_Val_Loss_Lappy_1.py -wtfile "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_10.h5"

(ce7comb1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ python3 ImgCap_Check_Val_Loss_Lappy_1.py -wtfile "/media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_10.h5"

Check wordtoix entries ::
startseq = 1	endseq = 9	bird = 974
Check ixtoword entries ::
ix 1 = startseq	ix 10 = red	ix 974 = bird

2020-10-09 13:53:48.592726: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-10-09 13:53:48.623552: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2199995000 Hz
2020-10-09 13:53:48.624314: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55da6b9233b0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-10-09 13:53:48.624350: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-10-09 13:53:48.624474: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.

SUCCESS - Reloaded weights from :: /media/rohit/DATA/EverythingD/01SRH-BDBA Acads/Thesis/StoryGenerator/Code/ModelsRuns/ImgCap/SavedData/Thesis_ImgCap_Weights_In_Run2/Decoder_Run_2_Wt_ep_10.h5

RNN Decoder model (non-trainable type) defined with these paramenters:
EMBEDDING_DIMS = 200 , VOCAB_SIZE = 6758 , MAX_LENGTH_CAPTION = 49
Attempting to load weights...

Length of Descriptions dict = 3000



Started at = 2020-10-09 13:54:01

116287/116287 [==============================] - 528s 5ms/sample - loss: 3.2169 - accuracy: 0.3365


Loss with Batch size of 64 =
[3.2169498203267946, 0.33647785]




Ended at = 2020-10-09 14:02:53
Time taken = 531.6395823955536 seconds


Done

(ce7comb1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$

---------------------------------------------------------

		Epoch 10
116287/116287 [==============================] - 528s 5ms/sample - loss: 3.2169 - accuracy: 0.3365
Loss with Batch size of 64 =
[3.2169498203267946, 0.33647785]
		Epoch 8
116287/116287 [==============================] - 476s 4ms/sample - loss: 3.2466 - accuracy: 0.3332
Loss with Batch size of 64 =
[3.2466391558613816, 0.3331585]
		Epoch 6
116287/116287 [==============================] - 436s 4ms/sample - loss: 3.2908 - accuracy: 0.3282
Loss with Batch size of 64 =
[3.290836356369273, 0.328231]
		Epoch 4
116287/116287 [==============================] - 489s 4ms/sample - loss: 3.3666 - accuracy: 0.3184
Loss with Batch size of 64 =
[3.3666324971813695, 0.31841907]
		Epoch 2
116287/116287 [==============================] - 351s 3ms/sample - loss: 3.5284 - accuracy: 0.2984
Loss with Batch size of 64 =
[3.5284207623579418, 0.29835665]





xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


							RECORD SOUND AS WAV FILE

		using deepspeech for real-time inference
https://awesomeopensource.com/project/daanzu/deepspeech-websocket-server

uses pyaudio and portaudio

		conda environment setup  -- using python 3.7.7 as thats what combined execution is using already
conda create -n ce10recsnd1 python=3.7.7
conda install pyaudio			-- installed portaudio automatically
conda install jupyter


conda list

				(ce10recsnd1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$ conda list
				# packages in environment at /home/rohit/anaconda3/envs/ce10recsnd1:
				#
				# Name                    Version                   Build  Channel
				_libgcc_mutex             0.1                        main  
				argon2-cffi               20.1.0           py37h7b6447c_1  
				async_generator           1.10             py37h28b3542_0  
				attrs                     20.2.0                     py_0  
				backcall                  0.2.0                      py_0  
				bleach                    3.2.1                      py_0  
				ca-certificates           2020.7.22                     0  
				certifi                   2020.6.20                py37_0  
				cffi                      1.14.3           py37he30daa8_0  
				dbus                      1.13.16              hb2f20db_0  
				decorator                 4.4.2                      py_0  
				defusedxml                0.6.0                      py_0  
				entrypoints               0.3                      py37_0  
				expat                     2.2.10               he6710b0_2  
				fontconfig                2.13.0               h9420a91_0  
				freetype                  2.10.2               h5ab3b9f_0  
				glib                      2.65.0               h3eb4bd4_0  
				gst-plugins-base          1.14.0               hbbd80ab_1  
				gstreamer                 1.14.0               hb31296c_0  
				icu                       58.2                 he6710b0_3  
				importlib-metadata        2.0.0                      py_1  
				importlib_metadata        2.0.0                         1  
				ipykernel                 5.3.4            py37h5ca1d4c_0  
				ipython                   7.18.1           py37h5ca1d4c_0  
				ipython_genutils          0.2.0                    py37_0  
				ipywidgets                7.5.1                      py_1  
				jedi                      0.17.2                   py37_0  
				jinja2                    2.11.2                     py_0  
				jpeg                      9b                   h024ee3a_2  
				jsonschema                3.2.0                    py37_1  
				jupyter                   1.0.0                    py37_7  
				jupyter_client            6.1.7                      py_0  
				jupyter_console           6.2.0                      py_0  
				jupyter_core              4.6.3                    py37_0  
				jupyterlab_pygments       0.1.2                      py_0  
				ld_impl_linux-64          2.33.1               h53a641e_7  
				libedit                   3.1.20191231         h14c3975_1  
				libffi                    3.3                  he6710b0_2  
				libgcc-ng                 9.1.0                hdf63c60_0  
				libpng                    1.6.37               hbc83047_0  
				libsodium                 1.0.18               h7b6447c_0  
				libstdcxx-ng              9.1.0                hdf63c60_0  
				libuuid                   1.0.3                h1bed415_2  
				libxcb                    1.14                 h7b6447c_0  
				libxml2                   2.9.10               he19cac6_1  
				markupsafe                1.1.1            py37h14c3975_1  
				mistune                   0.8.4           py37h14c3975_1001  
				nbclient                  0.5.0                      py_0  
				nbconvert                 6.0.7                    py37_0  
				nbformat                  5.0.7                      py_0  
				ncurses                   6.2                  he6710b0_1  
				nest-asyncio              1.4.1                      py_0  
				notebook                  6.1.4                    py37_0  
				openssl                   1.1.1h               h7b6447c_0  
				packaging                 20.4                       py_0  
				pandoc                    2.10.1                        0  
				pandocfilters             1.4.2                    py37_1  
				parso                     0.7.0                      py_0  
				pcre                      8.44                 he6710b0_0  
				pexpect                   4.8.0                    py37_1  
				pickleshare               0.7.5                 py37_1001  
				pip                       20.2.3                   py37_0  
				portaudio                 19.6.0               h7b6447c_4  			- version 19.6.0
				prometheus_client         0.8.0                      py_0  
				prompt-toolkit            3.0.7                      py_0  
				prompt_toolkit            3.0.7                         0  
				ptyprocess                0.6.0                    py37_0  
				pyaudio                   0.2.11           py37h7b6447c_2  			- version 0.2.11
				pycparser                 2.20                       py_2  
				pygments                  2.7.1                      py_0  
				pyparsing                 2.4.7                      py_0  
				pyqt                      5.9.2            py37h05f1152_2  
				pyrsistent                0.17.3           py37h7b6447c_0  
				python                    3.7.7                hcff3b4d_5  
				python-dateutil           2.8.1                      py_0  
				pyzmq                     19.0.2           py37he6710b0_1  
				qt                        5.9.7                h5867ecd_1  
				qtconsole                 4.7.7                      py_0  
				qtpy                      1.9.0                      py_0  
				readline                  8.0                  h7b6447c_0  
				send2trash                1.5.0                    py37_0  
				setuptools                50.3.0           py37hb0f4dca_1  
				sip                       4.19.8           py37hf484d3e_0  
				six                       1.15.0                     py_0  
				sqlite                    3.33.0               h62c20be_0  
				terminado                 0.9.1                    py37_0  
				testpath                  0.4.4                      py_0  
				tk                        8.6.10               hbc83047_0  
				tornado                   6.0.4            py37h7b6447c_1  
				traitlets                 5.0.4                      py_0  
				wcwidth                   0.2.5                      py_0  
				webencodings              0.5.1                    py37_1  
				wheel                     0.35.1                     py_0  
				widgetsnbextension        3.5.1                    py37_0  
				xz                        5.2.5                h7b6447c_0  
				zeromq                    4.3.2                he6710b0_3  
				zipp                      3.3.0                      py_0  
				zlib                      1.2.11               h7b6447c_3  
				(ce10recsnd1) rohit@rohitu2004lts:~/PyWDUbuntu/thesis$





[pulseaudio] module.c: Failed to load module "module-alsa-card" (argument: "device_id="1" name="pci-0000_00_1f.3-platform-skl_hda_dsp_generic" card_name="alsa_card.pci-0000_00_1f.3-platform-skl_hda_dsp_generic" namereg_fail=false tsched=yes fixed_latency_range=no ignore_dB=no deferred_volume=yes use_ucm=yes avoid_resampling=no card_properties="module-udev-detect.discovered=1""): initialization failed.




rohit@rohitu2004lts:/etc/modprobe.d$ sudo gedit alsa-base.conf 

added lines as per link: https://stackoverflow.com/questions/61643364/how-to-fix-no-sound-on-ubuntu-18-04
there the link: https://www.reddit.com/r/linuxmint/comments/fltlrl/no_sound_on_acer_swift_3_with_kernel_53/

		lines added at end of the existing options
options snd-hda-intel dmic_detect=0
options snd-hda-intel model=laptop-amic enable=yes
		then on saving got error below:
(gedit:1854548): Tepl-WARNING **: 22:46:24.991: GVfs metadata is not supported. Fallback to TeplMetadataManager. Either GVfs is not correctly installed or GVfs metadata are not supported on this platform. In the latter case, you should configure Tepl with --disable-gvfs-metadata.

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx




							STORY GENERATION

			From https://github.com/rbewoor/gpt-2 readme (cloned from https://github.com/openai/gpt-2/)

You can read about GPT-2 and its staged release in our original blog post, 6 month follow-up post, and final post.

final post was a link: https://www.openai.com/blog/gpt-2-1-5b-release/

			From https://www.openai.com/blog/gpt-2-1-5b-release/

GPT-2: 1.5B Release
As the final model release of GPT-2’s staged release, we’re releasing the largest version (1.5B parameters) of GPT-2 along with code and model weights to facilitate detection of outputs of GPT-2 models. While there have been larger language models released since August, we’ve continued with our original staged release plan in order to provide the community with a test case of a full staged release process. We hope that this test case will be useful to developers of future powerful models, and we’re actively continuing the conversation with the AI community on responsible publication.

code and model weights was a link: https://github.com/openai/gpt-2-output-dataset  which i cloned to https://github.com/rbewoor/gpt-2-output-dataset   on 10.10.2020

---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

					How To Make Custom AI-Generated Text With GPT-2
			From link: https://minimaxir.com/2019/09/howto-gpt2/

OpenAI has released three flavors of GPT-2 models to date: the “small” 124M parameter model (500MB on disk), the “medium” 355M model (1.5GB on disk), and recently the 774M model (3GB on disk). These models are much larger than what you see in typical AI tutorials and are harder to wield: the “small” model hits GPU memory limits while finetuning with consumer GPUs, the “medium” model requires additional training techniques before it could be finetuned on server GPUs without going out-of-memory, and the “large” model cannot be finetuned at all with current server GPUs before going OOM, even with those techniques.

The actual Transformer architecture GPT-2 uses is very complicated to explain (here’s a great lecture). For the purposes of finetuning, since we can’t modify the architecture, it’s easier to think of GPT-2 as a black box, taking in inputs and providing outputs. Like previous forms of text generators, the inputs are a sequence of tokens, and the outputs are the probability of the next token in the sequence, with these probabilities serving as weights for the AI to pick the next token in the sequence. In this case, both the input and output tokens are byte pair encodings, which instead of using character tokens (slower to train but includes case/formatting) or word tokens (faster to train but does not include case/formatting) like most RNN approaches, the inputs are “compressed” to the shortest combination of bytes including case/formatting, which serves as a compromise between both approaches but unfortunately adds randomness to the final generation length. The byte pair encodings are later decoded into readable text for human generation.

The pretrained GPT-2 models were trained on websites linked from Reddit. As a result, the model has a very strong grasp of the English language, allowing this knowledge to transfer to other datasets and perform well with only a minor amount of additional finetuning. Due to the English bias in encoder construction, languages with non-Latin characters like Russian and CJK will perform poorly in finetuning.

When finetuning GPT-2, I recommend using the 124M model (the default) as it’s the best balance of speed, size, and creativity. If you have large amounts of training data (>10 MB), then the 355M model may work better.


https://pypi.org/project/gpt-2-simple/
The generated model checkpoints are by default in /checkpoint/run1. 
As with textgenrnn, you can generate and save text for later use (e.g. an API or a bot) by using the return_as_list parameter.
single_text = gpt2.generate(sess, return_as_list=True)[0]
print(single_text)


https://github.com/minimaxir/gpt-2-simple forked to my repo https://github.com/rbewoor/gpt-2-simple on 24.10.2020


---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

			TRAINING NOTES
using package        !pip install -q gpt-2-simple      and running the colab notebook the author provided

*********************************************************
*********************************************************
	model 2 model 2		- start
*********************************************************
*********************************************************

							File 11 - third time - : cbt_train_OUT.txt    (25.2 mb)

FAILED MIDWAY - NOT SAVED

*********************************************************
*********************************************************

							File 11 - second time - : cbt_train_OUT.txt    (25.2 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-16000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-16000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:27<00:00, 27.25s/it]
dataset has 6257758 tokens
Training...
Saving checkpoint/run2/model-16000
Saving checkpoint/run2/model-16000
======== SAMPLE 1 ========
. He had an iron pan, and in it hung a basket full of gold and silver.
` So it shall be .'
The next morning the prince set his foot on board a ship, and was soon as good as well sailing on the water ; but he never thought of land till his return, when, taking advantage of his journey in the meantime, he happened to pick up the golden ball, and bring it back to the country of the great king his father.
But he found that he was a long way off, and had a great time to get his wife and a good wife for all, so as to prevent her being separated from him ; and she told him of her sorrow and longing.
` I shall have to bear the burden!
I shall be a poor lad at home .'
And her father told her how he had loved and loved her as well as a lion ; and she said, ` We must work together as men, and each of us will bring in his own way .'
So they worked together, and when the king asked the eldest of his three subjects what the princess meant, he said, ` If all goes well, I will bring you back with me .'
So the other two went to lay the golden ball, and when he had brought it he made it dance up to his father, and said, ` You are the fairest and most beautiful princess ; so you shall come back with me to the castle .'
But when the elder son had thrown some stones into the water and turned the ball over in his hands, he was driven off with a great shriek, and the youngest son was only frightened .'
I had always loved you, ' said he, ` but you are dead in all the world .'
But the king was so terrified and much vexed before him that all were afraid to see it, and he could do nothing for fear of their looking for his daughter.
When the princess was far off, she sat down upon a stone, and said to herself what would be the end of it all for her if the ball was not returned at once.
And so she went back to her own family, and asked her mother , ` Come into the palace in safety, with this ball, ' and she waited for the arrival of her father.
And when that was announced the king 's son threw down the basket as fast as he could, and put it behind him.
So the younger princess came out of the boat, and told him what had been done when he had come back from the country of the Great King his father.
` But this is as a long time as mine, ' replied the princess .'
I was going by your daughter, the Queen of the Seas ; but you and her mother were driving with the money and jewels of the kingdom, so that each could leave nothing behind for you.
Your daughter is not the least of these ; let me go now and bring her a gift .'
The princess threw down her basket, and began to tear her hair, as she had a good hair.
But with all her pains a brave maiden would have her hair trimmed in this fashion, and she had heard of many men who fell in love with beautiful and beautiful maidens, when they have been so badly treated.
` Give me back my golden ball !'
and she called out, ` It will be a beautiful prize to you and me !'
but the king and his daughter answered, ` Even so are gold and silver, who can make a long journey from far away to where the king is .'
` You will have to do all that the Maid of the Sea has done, or I will give it back to you .'
But the princess held out her hand, and asked, ` Let me get back gold and silver !'
then they threw it into the sea.
` You have no need of that ; take leave of me, ' said the king ; ` but if you have come too far I can not take you back with me .'
` Yes, my father will give you back my golden ball .'
And the princess had to wait till the next day, that would have been the best time, but the royal son had got all his money and jewels and was beginning to set forth his journey ; so she gave in her money, and the journey was very long at least, because the journey-money was very large.
At last they came, and the king returned as before, and was received with the golden ball, which was made in the palace of the great King his father, with two white gold and three red gold in it.
And when he had laid it among the three maidens he was turned away from there, and was driven off back again to land.
` Good luck to you, ' said the princess .'
I have come and asked your father to give me this treasure .'
So the king

[16050 | 150.13] loss=3.11 avg=3.11
[16100 | 233.16] loss=3.66 avg=3.39
[16150 | 316.05] loss=3.24 avg=3.34
[16200 | 398.95] loss=3.41 avg=3.35
[16250 | 482.04] loss=2.65 avg=3.21
[16300 | 565.10] loss=3.39 avg=3.24
[16350 | 648.27] loss=2.46 avg=3.13
[16400 | 731.38] loss=2.63 avg=3.06
[16450 | 814.52] loss=3.48 avg=3.11
[16500 | 897.57] loss=2.31 avg=3.03
Saving checkpoint/run2/model-16500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[16550 | 987.62] loss=2.70 avg=3.00
[16600 | 1070.67] loss=2.39 avg=2.94
[16650 | 1153.50] loss=2.36 avg=2.89
[16700 | 1236.47] loss=3.57 avg=2.95
[16750 | 1319.52] loss=3.00 avg=2.95
[16800 | 1402.64] loss=2.76 avg=2.94
[16850 | 1485.78] loss=2.45 avg=2.91
[16900 | 1568.87] loss=2.95 avg=2.91
[16950 | 1651.97] loss=2.68 avg=2.90
[17000 | 1735.04] loss=3.06 avg=2.90
Saving checkpoint/run2/model-17000

*********************************************************
*********************************************************

							File 11 - first time - : cbt_train_OUT.txt    (25.2 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-15000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-15000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:27<00:00, 27.90s/it]
dataset has 6257758 tokens
Training...
Saving checkpoint/run2/model-15000
Saving checkpoint/run2/model-15000
======== SAMPLE 1 ========
ves, which I shall call Aunt Esther, '' he said.
Cousin Esther smiled broadly.
`` New brooms come in here, '' she said.
Rikki-tikki jumped as high up in the air as he could go, his head just out of the window, his eyes nearly to his ears.
Aunt Esther put her long hair up in bboy, and it was so luscious that people thought it was waxing and blowing.
There was a fresh breeze through the green pines and a rosy rose was visible around every bend of the little schooner.
It was ten o'clock when Rikki-tikki went down to the village after business, and they waited for him half an night and a half an XXXXX for the two tattered husks in the wood to settle .	day		Aunt|boys|corn|dress|family|girl|head|idea|manner|people
Then the Hunter did as the old woman had told him : he cut open the bird, found its heart, swallowed it, and took the cloak home with him.
The next morning when he awoke he remembered the promise, and wanted to see if it had come true.
But when he lifted up his pillow, there sparkled the gold piece, and the next morning he found another, and so on every time he got up.
He collected a heap of gold, but at last he thought to himself, ` What good is all my gold to me if I stay at home?
I will travel and look a bit about me in the world .'
So he took leave of his parents, Slaves were very rare in these days, and so one day he heard a man saying to another, ` We are glad to see you again, dear.
What have you done here?
Rikki-tikki has found you .'
But the answer was always the same ; ` With what axe?
With what axe shall I find the hole through which the sun strikes the ground at night .'
` Come to me at once, ' said the other, ` and tell me the hole .'
But though the Hunter would lie awake late, slacking tangibly, telling tales of roses and thistles, he could not tell anything because his brain was too tired to hold onto anything.
At last the man said, ` We have seen you at court ; you have won our hearts by your beauty, and we desire you to be our brother-in-law, but what shall we owe you ?'
` We are obliged to you, ' said the other, ` for we do not know how long we may be your prisoner .'
` But are you ?'
questioned the Hunter.
` Exactly so, ' said the XXXXX . '	heir		hunter|home|hope|lament|man|meantime|morning|nothing|prisoner|tongibly
Then I was sure that he would never forgive me.
He has always been very good to me.
Now that his time had come, he must say what he would like to be done.
I have resolved that if I am a fool to-night, I will stand beside you on your bed, and let you pull my box and trunk until I have loosened the straps.
But I am a bit late, and if we succeed the moon will rise in the evening, and we will be able to pull down the great pine tree on to the Beddoes ' deck.
By the time the moon rises you will be able to see the whole affair.
Only remember that the sea-maiden 's dwelling is far off.
All the prettiest maidens that ever lived lived have gone ; the young ones that I have now become a brother to are stationed at the utmost ends of the earth at the dams of the rivers, and I am the youngest of seven brothers, and the youngest of all the seven maidens.
When the sun rises above the sea the old white wolf will come to see what has been done.
He will not hesitate to fly over to your place and shake you to pieces . ''
Then the six maidens who were appointed to watch the land in case of emergency came to the boat.
When they saw the white wolf, they were very moved, and came running as quickly as they could.
But the old maidens who were appointed to watch the river said that they had never seen anything like it.
They were nearly beside themselves with joy, and ran to the dam and let the waters flow so rapidly that the earth seemed to become very hollow.
And when the waters had disappeared altogether, they thought themselves at last they must fly away, but when, after careful consideration, they found that no external world existed where the seven years could last, they swore that they would never lay a stone unturned in

[15050 | 153.16] loss=3.34 avg=3.34
[15100 | 235.55] loss=2.99 avg=3.17
[15150 | 318.05] loss=3.53 avg=3.29
[15200 | 400.68] loss=2.87 avg=3.18
[15250 | 483.21] loss=3.40 avg=3.23
[15300 | 565.75] loss=3.45 avg=3.27
[15350 | 648.47] loss=3.18 avg=3.25
[15400 | 731.02] loss=3.06 avg=3.23
[15450 | 813.52] loss=2.78 avg=3.18
[15500 | 895.94] loss=3.34 avg=3.19
Saving checkpoint/run2/model-15500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[15550 | 988.54] loss=3.16 avg=3.19
[15600 | 1071.12] loss=2.76 avg=3.15
[15650 | 1153.73] loss=2.68 avg=3.11
[15700 | 1236.26] loss=2.47 avg=3.06
[15750 | 1318.68] loss=2.81 avg=3.05
[15800 | 1401.17] loss=3.22 avg=3.06
[15850 | 1483.61] loss=3.25 avg=3.07
[15900 | 1566.08] loss=2.89 avg=3.06
[15950 | 1648.59] loss=3.31 avg=3.07
[16000 | 1731.04] loss=2.39 avg=3.04
Saving checkpoint/run2/model-16000

*********************************************************
*********************************************************

							File 10: cbtest_CN_test_2500ex_OUT.txt    (5.8 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-13500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-13500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.33s/it]
dataset has 1438608 tokens
Training...
Saving checkpoint/run2/model-13500
Saving checkpoint/run2/model-13500
[13550 | 124.47] loss=0.33 avg=0.33
[13600 | 206.99] loss=0.47 avg=0.40
[13650 | 289.62] loss=0.26 avg=0.35
[13700 | 372.21] loss=0.29 avg=0.34
[13750 | 454.83] loss=0.18 avg=0.30
[13800 | 537.40] loss=0.21 avg=0.29
[13850 | 620.12] loss=0.10 avg=0.26
[13900 | 702.56] loss=0.51 avg=0.29
[13950 | 784.92] loss=0.25 avg=0.29
[14000 | 867.52] loss=0.20 avg=0.28
======== SAMPLE 1 ========
 themselves was a great deal larger than mine.
The Moon kept growing larger and larger, till at last it fell out of the sky, and thereupon we both arose and walked out of the cave into the open air.
` The Sun was hot, and I could not keep it in the room, so I rose and walked out, and after walking some time I found my way to a fountain.
I drank, and felt very strange, and before long I heard the Sun asking for my hand again.
I drank another drop, and then I felt that my body was sound and my limbs strong.
I returned, lowered the scale, and before long I heard the Sun asking if he had not wife or child.
` We had, each other, ' I said, ` many many misfortunes, but always with good cheer ; do not think me so ungrateful for all .'
After this I heard the Sun inviting me to go to Court, and so I took my XXXXX and left my body .	course		Body|courtyard|fate|garden|heart|length|message|others|spite|suitors
` No, ' replied the Darning-needle .'
I will go on the Lion too, and if I am not dead before sunset to-morrow it will bite me in the night .'
` Then you shall make me rich !'
said the fisherman.
` Yes ; I will go on with the boat .'
And so saying he drew his bow and arrow and began to recite the second verse of the song : ` Upon a mountain and upon a star : The Lion 's cry, ' and the Bear 's whistle, ' and the Wolf 's roar, ' and the Dragon 's cry, ' and the Black Dragon 's whistle, ' and the Frog 's whistle, ' and the Black Snake 's whistle, ' and the Water-snake 's whistle ; and the last, the Crone 's whistle, so that even he could not pronounce it.
However, after he had made so much of it in so short a time, he fell sound asleep, and was caught by the next morning.
The next morning the maiden took him by the hand and led him to a crystal spring, in great Northern latitudes, where there were many springs of the clear water, and Lake Constance .'
` And I have a wood-snake for you !'
said she.
` Here comes my husband from the South, ' said the youth.
` He is as wise as I thought, and knows more than most men .'
` Go and herd him, ' said the wife.
` Not yet, my lord!
go quickly !'
said the XXXXX . '	maiden		Illustration|Arrow|arrow|bow|distance|home|maiden|morning|river|stream|trees
` I wish you Would stop fooling and come true your pledge, ' said the old hag.
` Too lazy !'
Then he jumped into the water, and the spring instantly flooded, so that all the inhabitants of the island could not stand in it any longer.
When the peasant came to fetch his wages he found that the feast was a great success.
All the ducks, geese, and gelders in the whole kingdom fluttered round his boat, and drank as much as they wanted to before the two brothers, who were the only two magicians of the immediate court, could pronounce the words out of their own mouths.
As soon as the zither sounded its secret message, the bird rose up in the air, and came towards the man, and said : ` If you have been faithful to me, you shall come to my assistance ; here is a man who can direct your eye without my permission .'
The man immediately suspected that he was the author of the message, and took measures to secure the delivery of his harp.
His first act was to seek the fairy 's daughter, and to implore her to give him all the assistance of her kingdom in this important matter.
Then he entrusted his right hand to the invisible pen, and wrote thus to the Princess 's mother : -- ` Have patience, my child.
I shall soon punish all the wicked crafty sods in this land, and restore you your father .'
With these words the invisible pen vanished, and returned probably to the chief of the band.
The old King was much grieved when he saw his daughter publicly flaunting her arms, and he caused her to be examined by the most notorious magician in the land.
In vain did the Princess thank the man for his faithful love, and implored him to trouble her mind by sending her a poem he had already written.
So the King rewarded her courage, and commanded her to write as follows : -- ` This is the

[14050 | 974.59] loss=0.65 avg=0.31
[14100 | 1057.64] loss=0.19 avg=0.30
[14150 | 1140.64] loss=0.24 avg=0.30
[14200 | 1223.92] loss=0.23 avg=0.29
[14250 | 1307.23] loss=0.14 avg=0.28
[14300 | 1390.52] loss=0.20 avg=0.28
[14350 | 1473.70] loss=0.11 avg=0.27
[14400 | 1556.80] loss=0.32 avg=0.27
[14450 | 1639.87] loss=0.21 avg=0.27
[14500 | 1722.93] loss=0.20 avg=0.26
[14550 | 1806.09] loss=0.17 avg=0.26
[14600 | 1889.23] loss=0.11 avg=0.25
[14650 | 1972.32] loss=0.26 avg=0.25
[14700 | 2055.35] loss=0.16 avg=0.25
[14750 | 2138.55] loss=0.15 avg=0.24
[14800 | 2221.69] loss=0.14 avg=0.24
[14850 | 2304.77] loss=0.15 avg=0.23
[14900 | 2387.85] loss=0.22 avg=0.23
[14950 | 2470.97] loss=0.19 avg=0.23
[15000 | 2554.05] loss=0.14 avg=0.23
Saving checkpoint/run2/model-15000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

*********************************************************
*********************************************************

							File 9: cbtest_CN_valid_2000ex_OUT.txt    (5.8 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-12000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-12000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.73s/it]
dataset has 1114512 tokens
Training...
Saving checkpoint/run2/model-12000
Saving checkpoint/run2/model-12000
[12050 | 125.30] loss=0.17 avg=0.17
[12100 | 208.11] loss=0.29 avg=0.23
[12150 | 290.92] loss=0.44 avg=0.30
[12200 | 373.60] loss=0.27 avg=0.29
[12250 | 456.18] loss=0.16 avg=0.27
[12300 | 538.88] loss=0.30 avg=0.27
[12350 | 621.73] loss=0.19 avg=0.26
[12400 | 704.38] loss=0.36 avg=0.27
[12450 | 787.09] loss=0.22 avg=0.27
[12500 | 869.78] loss=0.26 avg=0.27
[12550 | 952.46] loss=0.16 avg=0.26
[12600 | 1035.06] loss=0.28 avg=0.26
======== SAMPLE 1 ========
 seven bells ringing, `` Knock, knock!
Will you come with me?
You may sleep in a fir-tree out back, and I will take the sofy.
Good-bye, and do not forget me . ''
As the last words were sung, a tiny voice inside whispered, `` Perhaps he has some sort of XXXXX in his head . ''	thing		Good-bye|adventures|bottom|doorway|heart|king|nose|something|thought
One of the girls told him that it was the lamb which her uncle had caught, but when he came to look at the wound, he could see that it was only a piece of leather, and that the poor boy had escaped with the leather instead.
` You have done him no evil, ' said the Bassa, ` but he has broken one of your hearts.
And what shall I do?
To make up, I plead your Majesty 's cause, and hope to persuade you to spare his life.
If you betray this promise, I will cause such a storm to burst over your palace that the walls will fall in, and you will all be buried in the ruins .'
` This is the best promise you can make, ' replied the Bassa, ` and I will think of no means of disobeying it .'
Next morning, therefore, he went to the slave whose storehouse was now prepared, and advised the slave to go and fetch another load of wood.
And the slave replied : ` Yes, I will do that, ' and did so.
Then the prince went to the blacksmith and said : ` You will blow me a little straw, then I will let you draw me onto a certain spot on the ground, and you will have to lay hold of my tail.
Take it, and I will let you tie me to the ground, and to no evil shall ever come near us .'
And the blacksmith did as he was told ; and when he had tied him firmly to the ground, the prince said : ` Now let us go to the place where we left the youngest sister, and I will give her a casket .'
So they went to the specified spot, and laid hold of the straw, and when the blacksmith came to take hold of it, he found himself in the exact same predicament as the first time they had gone there.
` Casket or no coffin !'
whichever way they turned, the blacksmith was so much distressed that he jumped into the cart, and took hold of the tail of the straw, and managed to free his brother from the earth.
Then he proceeded to the casket, which was just about to expire, and there he found the three rings belonging to the daughters of Siroco.
As he examined them, the XXXXX in the basket, which was his portion, gained notoriety, and he was obliged to hire a servant, and to turn rogues into courtiers, who told him that the ladies of the house were the most beautiful in the world, and assured him that with a little training he would soon be able to see them .	lives		castle|lives|manner|place|palace|sister|something|training|wounds|wife
`` If that is the case, I will soon find it . ''
Striped Chipmunk scurried along, and now he took pains to always keep in sight.
Happy Jack followed, hiding behind the trees.
Pretty soon Striped Chipmunk picked up a plump acorn and put it in the pocket of his right cheek.
Then he picked up another and put that in the pocket in his left cheek.
Then he crowded another into each ; his face was swelled so that you would hardly have guessed that it was Striped Chipmunk if you had chanced to meet him.
My, my, he was a funny sight!
Happy Jack grinned again as he watched, partly because Striped Chipmunk looked so funny, and partly because he knew that if Striped Chipmunk was going to eat the acorns right away, he would not stuff them into the pockets in his cheeks.
But he had done this very thing, and so he must be going to take them to his storehouse.
Off scampered Striped Chipmunk, and after him stole Happy Jack, his eyes shining with excitement.
Pretty soon he saw an old stump which looked as if it must be hollow.
Happy Jack grinned more than ever as he carefully hid himself and watched.
Striped Chipmunk scrambled up on the old stump, looked this way and that way, as if to be sure that no one was watching him, then with a flirt of his funny little tail he darted into a little round doorway.
He was gone a long time, but by the next morning he was a happily-lucky tramp

[12650 | 1142.47] loss=0.35 avg=0.26
[12700 | 1225.48] loss=0.33 avg=0.27
[12750 | 1308.52] loss=0.26 avg=0.27
[12800 | 1391.62] loss=0.16 avg=0.26
[12850 | 1474.70] loss=0.22 avg=0.26
[12900 | 1557.81] loss=0.26 avg=0.26
[12950 | 1640.84] loss=0.09 avg=0.25
[13000 | 1723.95] loss=0.14 avg=0.24
[13050 | 1807.03] loss=0.11 avg=0.24
[13100 | 1890.32] loss=0.29 avg=0.24
[13150 | 1973.38] loss=0.25 avg=0.24
[13200 | 2056.51] loss=0.20 avg=0.24
[13250 | 2139.62] loss=0.14 avg=0.23
[13300 | 2222.74] loss=0.23 avg=0.23
[13350 | 2305.81] loss=0.06 avg=0.23
[13400 | 2388.87] loss=0.19 avg=0.22
[13450 | 2472.06] loss=0.21 avg=0.22
[13500 | 2555.30] loss=0.14 avg=0.22
Saving checkpoint/run2/model-13500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

*********************************************************
*********************************************************

							File 8: cbtest_NE_test_2500ex_OUT.txt    (5.3 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-10500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-10500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.31s/it]
dataset has 1360345 tokens
Training...
Saving checkpoint/run2/model-10500
Saving checkpoint/run2/model-10500
[10550 | 125.17] loss=0.20 avg=0.20
[10600 | 207.73] loss=0.42 avg=0.31
[10650 | 290.35] loss=0.70 avg=0.44
[10700 | 373.15] loss=0.25 avg=0.40
[10750 | 456.00] loss=0.33 avg=0.38
[10800 | 538.80] loss=0.46 avg=0.40
[10850 | 621.63] loss=0.24 avg=0.37
[10900 | 704.32] loss=0.30 avg=0.36
[10950 | 787.09] loss=0.27 avg=0.35
[11000 | 869.87] loss=0.14 avg=0.33
[11050 | 952.70] loss=0.56 avg=0.35
[11100 | 1035.45] loss=0.33 avg=0.35
[11150 | 1118.24] loss=0.28 avg=0.35
[11200 | 1200.97] loss=0.17 avg=0.33
======== SAMPLE 1 ========
 boy-girl, as they say of the Virgin Mary . ''
`` That is hardly fair to put Dee here, '' said Peter.
`` Ef the Chipmunk says those women have no business to meddle in church matters at all . ''
`` Who is Ef the Chipmunk ? ''
demanded Old Mr. Toad, as if he had been walking uncertainly along a street.
`` Who is Ef the XXXXX ?	Chipmunk		Akela|Peter|Toad|XVI|Toads|house|man-woman|street|shovel|word|word
A couple of the small boys were jumping about and singing a song of joy.
I felt it, too, when one of the girls shrieked out, `` Take that, old fellow!
You have had a subscription ! ''
`` Yes, '' replied Jimmy, `` but I was at the dance, too, and had a cart-horse and cart-wheel, and they wasted a lot of wind out there . ''
`` One did not, '' said one of the boys.
`` They just wanted to see a boys night off.
They did not know what to do with themselves.
Not even to frighten themselves.
They mooned as the girls did.
Jimmy went off for a long-tusked fly rod, and the other two ran on down the Crooked Little Path with their tongues hanging out their cheeks.
I never heard such a disappointment in my life, '' said Peter, as he shook his head dubiously.
`` I knew there were wolves in the wood, but I did not know they were so bad that they would come down with so much disease, and yet here they were . ''
`` They must have been acting as if they were afraid to speak to you, '' said Jimmy.
`` They were not, of course.
That is how they knew I was coming, but it was so strange.
I thought I would get a fever when I breathed in the grass . ''
`` That is enough about fever, '' said Peter promptly.
`` How is eating curdle to make you feel any better ? ''
Jimmy replied with a sneeze, and XXXXX looked at Old Mr. Toad as if he suspected he were seriously ill .	Jimmy		Jimmy|Peter|Mr.|Toad|course|fingers|idea|lungs|night|sunflowers
`` I want to tell it to somebody who will take good care of it . ''
`` Certainly, '' replied Mrs. Baxter, `` but we must first have something to eat.
That soup will keep itself all mended, and it will sound wonderful the rest of the day . ''
Mrs. Baxter had no white-collar fashion to match the trim, young lady with the suit, and she wisely chose those suitable for children and young fry.
Fancy stuffing a square plate with cherries into her lap.
Mrs. Baxter took my walk and back again, leaving me kneeling by the gate in the moonlight.
I placed the missing puzzle piece down on the veranda and watched my white-collar fashion all trifle with its diamond squares.
On the road from Dalveigh to Dalveigh I ran into the great castle at the window.
But it was not the castle itself I passed but a gravel-pit, with a muddy dune close to it, where some strange, drunken men were singing a psalm.
There I drank, and the strange people begged me what I wanted.
At last I understood what they were saying.
The castle was built of coral, and there was a little hill leading up to it.
People had says that the hill gave a little hypnotic effect, and that when you drank you could feel the sand in your hair and the sand in your clothes.
But then, as Armand Amiel says, the sand possessed a strange power of making oneself invisible, and one day I had to go very close to it in order to reach the moon!
A strange feeling was building in my throat and my heart began to beat.
The sand seemed to have a magnetic power and I could feel the sand 's edge as I leaned forward and looked down at the window.
I noticed that it had a sort of rim on each side, and I could see the ceiling of the room vibrating as if it were glass.
I could hear the soft footsteps of the moon following me as I fled down the ladder.
`` Armand, '' said the moon, `` what is that?
I do not see you as often as I used to.
Please, now, let me know where you are going . ''
`` I shall be going to XXXXX, '' he answered softly .	Mount Everest		Arm|Dalveigh|Fancy|Mount|Cameron|

[11250 | 1308.48] loss=0.44 avg=0.34
[11300 | 1391.69] loss=0.23 avg=0.33
[11350 | 1474.83] loss=0.20 avg=0.32
[11400 | 1557.90] loss=0.19 avg=0.31
[11450 | 1640.83] loss=0.28 avg=0.31
[11500 | 1723.84] loss=0.22 avg=0.31
[11550 | 1806.85] loss=0.23 avg=0.30
[11600 | 1889.86] loss=0.17 avg=0.30
[11650 | 1972.87] loss=0.31 avg=0.30
[11700 | 2055.88] loss=0.13 avg=0.29
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-10500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-10500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.31s/it]
dataset has 1360345 tokens
Training...
Saving checkpoint/run2/model-10500
Saving checkpoint/run2/model-10500
[10550 | 125.17] loss=0.20 avg=0.20
[10600 | 207.73] loss=0.42 avg=0.31
[10650 | 290.35] loss=0.70 avg=0.44
[10700 | 373.15] loss=0.25 avg=0.40
[10750 | 456.00] loss=0.33 avg=0.38
[10800 | 538.80] loss=0.46 avg=0.40
[10850 | 621.63] loss=0.24 avg=0.37
[10900 | 704.32] loss=0.30 avg=0.36
[10950 | 787.09] loss=0.27 avg=0.35
[11000 | 869.87] loss=0.14 avg=0.33
[11050 | 952.70] loss=0.56 avg=0.35
[11100 | 1035.45] loss=0.33 avg=0.35
[11150 | 1118.24] loss=0.28 avg=0.35
[11200 | 1200.97] loss=0.17 avg=0.33
======== SAMPLE 1 ========
 boy-girl, as they say of the Virgin Mary . ''
`` That is hardly fair to put Dee here, '' said Peter.
`` Ef the Chipmunk says those women have no business to meddle in church matters at all . ''
`` Who is Ef the Chipmunk ? ''
demanded Old Mr. Toad, as if he had been walking uncertainly along a street.
`` Who is Ef the XXXXX ?	Chipmunk		Akela|Peter|Toad|XVI|Toads|house|man-woman|street|shovel|word|word
A couple of the small boys were jumping about and singing a song of joy.
I felt it, too, when one of the girls shrieked out, `` Take that, old fellow!
You have had a subscription ! ''
`` Yes, '' replied Jimmy, `` but I was at the dance, too, and had a cart-horse and cart-wheel, and they wasted a lot of wind out there . ''
`` One did not, '' said one of the boys.
`` They just wanted to see a boys night off.
They did not know what to do with themselves.
Not even to frighten themselves.
They mooned as the girls did.
Jimmy went off for a long-tusked fly rod, and the other two ran on down the Crooked Little Path with their tongues hanging out their cheeks.
I never heard such a disappointment in my life, '' said Peter, as he shook his head dubiously.
`` I knew there were wolves in the wood, but I did not know they were so bad that they would come down with so much disease, and yet here they were . ''
`` They must have been acting as if they were afraid to speak to you, '' said Jimmy.
`` They were not, of course.
That is how they knew I was coming, but it was so strange.
I thought I would get a fever when I breathed in the grass . ''
`` That is enough about fever, '' said Peter promptly.
`` How is eating curdle to make you feel any better ? ''
Jimmy replied with a sneeze, and XXXXX looked at Old Mr. Toad as if he suspected he were seriously ill .	Jimmy		Jimmy|Peter|Mr.|Toad|course|fingers|idea|lungs|night|sunflowers
`` I want to tell it to somebody who will take good care of it . ''
`` Certainly, '' replied Mrs. Baxter, `` but we must first have something to eat.
That soup will keep itself all mended, and it will sound wonderful the rest of the day . ''
Mrs. Baxter had no white-collar fashion to match the trim, young lady with the suit, and she wisely chose those suitable for children and young fry.
Fancy stuffing a square plate with cherries into her lap.
Mrs. Baxter took my walk and back again, leaving me kneeling by the gate in the moonlight.
I placed the missing puzzle piece down on the veranda and watched my white-collar fashion all trifle with its diamond squares.
On the road from Dalveigh to Dalveigh I ran into the great castle at the window.
But it was not the castle itself I passed but a gravel-pit, with a muddy dune close to it, where some strange, drunken men were singing a psalm.
There I drank, and the strange people begged me what I wanted.
At last I understood what they were saying.
The castle was built of coral, and there was a little hill leading up to it.
People had says that the hill gave a little hypnotic effect, and that when you drank you could feel the sand in your hair and the sand in your clothes.
But then, as Armand Amiel says, the sand possessed a strange power of making oneself invisible, and one day I had to go very close to it in order to reach the moon!
A strange feeling was building in my throat and my heart began to beat.
The sand seemed to have a magnetic power and I could feel the sand 's edge as I leaned forward and looked down at the window.
I noticed that it had a sort of rim on each side, and I could see the ceiling of the room vibrating as if it were glass.
I could hear the soft footsteps of the moon following me as I fled down the ladder.
`` Armand, '' said the moon, `` what is that?
I do not see you as often as I used to.
Please, now, let me know where you are going . ''
`` I shall be going to XXXXX, '' he answered softly .	Mount Everest		Arm|Dalveigh|Fancy|Mount|Cameron|

[11250 | 1308.48] loss=0.44 avg=0.34
[11300 | 1391.69] loss=0.23 avg=0.33
[11350 | 1474.83] loss=0.20 avg=0.32
[11400 | 1557.90] loss=0.19 avg=0.31
[11450 | 1640.83] loss=0.28 avg=0.31
[11500 | 1723.84] loss=0.22 avg=0.31
[11550 | 1806.85] loss=0.23 avg=0.30
[11600 | 1889.86] loss=0.17 avg=0.30
[11650 | 1972.87] loss=0.31 avg=0.30
[11700 | 2055.88] loss=0.13 avg=0.29
[11750 | 2138.95] loss=0.22 avg=0.29
[11750 | 2138.95] loss=0.22 avg=0.29
[11850 | 2304.96] loss=0.08 avg=0.27
[11850 | 2304.96] loss=0.08 avg=0.27
[11900 | 2388.12] loss=0.08 avg=0.26
[11900 | 2388.12] loss=0.08 avg=0.26
[11950 | 2471.17] loss=0.34 avg=0.27
[11950 | 2471.17] loss=0.34 avg=0.27
[12000 | 2554.27] loss=0.11 avg=0.26
Saving checkpoint/run2/model-12000
[12000 | 2554.27] loss=0.11 avg=0.26
Saving checkpoint/run2/model-12000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

*********************************************************
*********************************************************

							File 7: cbtest_NE_valid_2000ex_OUT.txt    (4.1 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-9000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-9000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.77s/it]
dataset has 1050855 tokens
Training...
Saving checkpoint/run2/model-9000
Saving checkpoint/run2/model-9000
[9050 | 127.27] loss=0.43 avg=0.43
[9100 | 209.89] loss=0.31 avg=0.37
[9150 | 292.65] loss=0.30 avg=0.35
[9200 | 375.49] loss=0.39 avg=0.36
[9250 | 458.31] loss=0.26 avg=0.34
[9300 | 541.13] loss=0.27 avg=0.33
[9350 | 623.93] loss=0.43 avg=0.34
[9400 | 706.74] loss=0.14 avg=0.32
[9450 | 789.56] loss=0.27 avg=0.31
[9500 | 872.31] loss=0.31 avg=0.31
[9550 | 955.02] loss=0.21 avg=0.30
[9600 | 1037.70] loss=0.26 avg=0.30
[9650 | 1120.43] loss=0.22 avg=0.29
[9700 | 1203.18] loss=0.19 avg=0.28
[9750 | 1285.85] loss=0.26 avg=0.28
[9800 | 1368.56] loss=0.10 avg=0.27
======== SAMPLE 1 ========
 of the old women he had so snubbed.
`` And did you take my bones in exchange for your black child ? ''
`` I did, '' said XXXXX .	Scarlet		Creamers|Dee|Ellis|Frewocks|Marr|Scarlet|XII|morning|right
But when they arrived at the Horn, the dance was already underway, and before the prince had lost sight of his prize, the snake was turned into a negro.
What, however, the prince did at last learn was that after two nights spent in a cage, the negro was put by order in the presence of the prince, and was conducted to the tent of his master.
In it he was placed on the floor, and his feet were tied behind him, so that he could not move from the spot.
` Without ceremony, ' said the prince, ` do you tie him to this chest and put his portrait on it ?'
` Yes, of course, ' replied the negro ; ` this is what I choose .'
` And are you going to put his picture on it, too, for I am fond of gentlemen, and would like to show my gratitude .'
` It is the easiest thing in the world, ' replied the prince ; ` once you have your name on it, you can tell everyone that you is changed, and it is easy to match wits with it .'
` All right, ' replied the negro, and they entered the service of Dschemil.
It soon became clear to Dschemil that he was not at all alone, and he drew his sword again.
` But what is my reward for my faithlessness, if I deserve it ?'
` If you do not, I will kill you .'
` Very good, ' cried he.
So he went back to his people and told them of their wrongs.
-LSB- Illustration : DSCHEMIL FINDS HIS PRIDE -RSB- When they heard what the king had ordered, they were very indignant, and scolded him soundly for making such a mistake.
` What is there to be afraid of, my dear subjects, ' they said, ` we are all brothers!
No one shall be killed, but you shall have experienced what we have just done to you.
And we will never, never forgive you.
You all have your deserts to go to, and if you do, you will be sorry for it .'
` We all must, ' sobbed Dschemil, ` for there is nothing fiercer than my dagger .'
And that was the end of the story, ' I am afraid.
I should like to hear her sentence you to death.
Give your thanks to the dervish, who saved me .'
` My son, ' sobbed Dschemil, ` do you not think that XXXXX should have been executed ?	killing		Dschemil|Dhk|first|fiercer|left|nineteen|night|questions|tendency
You had break their spirits, too, if they had known, and so jest was left for when they broke the windows and went.
` Inside there was beauty, ' repeated the ogre, ` as long as one looked on .'
` What signal did he give us, ?'
` Cast your eyes down !'
answered they.
` Yes, ' continued the ogre, ` he warned us that if you came near our hickory tree, you would be sorry for it.
But you dared not.
You were all so frightened at that unexpected question.
Well, humour you, '' said he, laughing, ` what do you think of the question?
Do you mind the time we bought God 's picture ?'
` Who told me that ?'
snapped Happy Jack.
` If you had asked me, I would have said I had not seen it, '' replied Tommy Tit.
`` I believe you are just as easy to fool as Shadow, '' rejoined Happy Jack.
CHAPTER XII HAPPY JACK TURNS BURGLAR As trees from little acorns, so Great sums from little pennies grow.
Happy Jack.
Happy Jack Squirrel stood in front of the old stump into which he had seen Striped Chipmunk go with the pockets in his cheeks full of acorns, and out of which he had come with the pockets of his cheeks quite empty.
`` Have a look, '' said he, `` at those two little baby Chucks!
They look so puffed up with pride that they hardly know anything is more than a pack of red 's to them.
I wonder what they mean by saying that.
I believe it is a plain foolish joke, but if they do not mean it I do not believe they know

[9850 | 1476.73] loss=0.12 avg=0.26
[9900 | 1559.79] loss=0.13 avg=0.25
[9950 | 1642.99] loss=0.31 avg=0.25
[10000 | 1726.20] loss=0.12 avg=0.25
[10050 | 1809.27] loss=0.26 avg=0.25
[10100 | 1892.46] loss=0.15 avg=0.24
[10150 | 1975.52] loss=0.24 avg=0.24
[10200 | 2058.63] loss=0.13 avg=0.24
[10250 | 2141.85] loss=0.21 avg=0.24
[10300 | 2224.95] loss=0.18 avg=0.23
[10350 | 2308.12] loss=0.22 avg=0.23
[10400 | 2391.34] loss=0.20 avg=0.23
[10450 | 2474.49] loss=0.12 avg=0.23
[10500 | 2557.63] loss=0.15 avg=0.23
Saving checkpoint/run2/model-10500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

*********************************************************
*********************************************************

							File 6: cbtest_P_test_2500ex_OUT.txt    (5.7 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-7500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-7500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.31s/it]
dataset has 1424360 tokens
Training...
Saving checkpoint/run2/model-7500
Saving checkpoint/run2/model-7500
[7550 | 125.45] loss=0.61 avg=0.61
[7600 | 208.00] loss=0.29 avg=0.45
[7650 | 290.59] loss=0.37 avg=0.42
[7700 | 373.17] loss=0.32 avg=0.39
[7750 | 455.87] loss=0.15 avg=0.34
[7800 | 538.45] loss=0.48 avg=0.37
[7850 | 621.10] loss=0.22 avg=0.35
[7900 | 703.55] loss=0.25 avg=0.33
[7950 | 786.26] loss=0.12 avg=0.31
[8000 | 868.89] loss=0.31 avg=0.31
[8050 | 951.61] loss=0.43 avg=0.32
[8100 | 1034.15] loss=0.24 avg=0.31
[8150 | 1116.71] loss=0.33 avg=0.32
[8200 | 1199.38] loss=0.20 avg=0.31
[8250 | 1281.98] loss=0.15 avg=0.30
[8300 | 1364.68] loss=0.85 avg=0.33
[8350 | 1447.31] loss=0.35 avg=0.33
[8400 | 1530.04] loss=0.30 avg=0.33
======== SAMPLE 1 ========
 own that great and terrible question.
`` Why, '' she said, a little flustered, `` I have never heard it mentioned in a romance before . ''
`` If anyone ever wrote a romance, '' said Uncle Abimelech, `` it must be me.
Why, it is almost a mystery and a romance -- something that has not happened in a hundred years and suddenly becomes possible.
I will tell you what it is : once upon a time there was a princess in her kingdom.
She was beautiful and courteous, and the people loved her.
Then ... '' `` You are thinking XXXXX something, uncle, '' said Emily .	of		as|at|for|if|like|of|over|than|through|to
`` You all leave the store with two shillings, '' said Mr. Shelmardine briskly.
`` Leave the store in one piece, oh brat!
As fast as you can!
I will have you executed -- in ten minutes ''
The locket came loose from her fastening and fell out of his coat without his noticing it.
`` Stop talking nonsense, '' he said.
`` Those are my children.
I took them away from their mother and placed them at your feet.
Tell them that I love them dearly and wish you good luck in everything . ''
With this he bade me follow him and leave the store.
I shall never forget the store.
It was a wonderful place and a boy knew a place for every dollar.
I was poor then and had occasion to shop there, but I could never live there.
There was a hole in the ground and our young Alexander Burton went there and lived there for two years.
I shall never forget that wonderful time.
I went there for the old, scarce ragged shelter which lay in a little porch room.
It was a tiny room but it was grand, with a bed and wardrobe in a neat little room down the ground.
I was very glad that we would have the shelter for Christmas Eve.
That was when Aunt Winnifred and Grandmother Winnifred came.
`` May I be fluffed up today, Polly ? ''
They had made a little club, and Mrs. Ralston 's back was to it.
`` I shall never forget that I love you XXXXX late at night, '' she said .	as		as|at|for|if|from|if|of|to|upon
`` You will not forget what you are.
But I am not going to rush things any more.
There is no real time to lose . ''
`` I will admit it then, '' said Frances frankly, `` I am tired . ''
`` Yours most cordially, AGNES CLARK LESLEY.
This letter was sent the previous night and has not been seen by Mr. & Mrs. James for some days.
Please excuse my taking so long to send it.
I promise never to forget . ''
`` I shall be glad of it, '' said Mrs. Baxter drily.
`` And for that matter I would like to send you an envelope addressed, sir -- one that has the subject written on it -- and it is yours for the taking.
I enclose a note from my own mailbox -- `` a note from my own mailbox, '' returned Frances facetiously -- `` but I know it is there -- oh, sir -- what is in that envelope ? ''
`` Something about mys and Mrs. Blake 's going away, '' said Mr. Baxter indignantly.
`` When Mrs. Baxter came this way last night I was surprised to see only the surprised face.
I suppose she thought my mail had got lost with it . ''
`` It does not matter, '' said Frances plainly.
`` Yours truly, A GRATEFUL FORFORM LESLEY.
I suppose it is too bad XXXXX do this .	that		about|at|from|in|like|of|since|that|to|upon|with
`` I am a little surprised at Mr. Cropper, '' she remarked wistfully.
`` He seems to like singing in the rain.
Just think of what he could have done if he had waited . ''
Mr. Cropper 's voice cracked.
`` He could have gone right down and asked the teacher what the trouble was, and she would have told him that he would never have been able to learn that thank goodness he was in the kismet . ''
Davenport put his hand over his mouth to hide a smile.
`` It is a sorry business.
I heard a story about Johnny Chuck.
He was once leading a flock of sheep in a very vocal and very showy way.
He used to do this every day in the pasture.
His flock was considered quite lazy and

[8450 | 1637.39] loss=0.30 avg=0.33
[8500 | 1720.47] loss=0.23 avg=0.32
[8550 | 1803.69] loss=0.26 avg=0.32
[8600 | 1886.84] loss=0.71 avg=0.34
[8650 | 1969.95] loss=0.28 avg=0.34
[8700 | 2053.10] loss=0.15 avg=0.33
[8750 | 2136.24] loss=0.28 avg=0.33
[8800 | 2219.49] loss=0.20 avg=0.32
[8850 | 2302.64] loss=0.13 avg=0.31
[8900 | 2385.71] loss=0.12 avg=0.31
[8950 | 2468.87] loss=0.30 avg=0.31
[9000 | 2552.03] loss=0.19 avg=0.30
Saving checkpoint/run2/model-9000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.


*********************************************************
*********************************************************

							File 5: cbtest_P_valid_2000ex_OUT.txt    (4.5 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-6000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-6000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:05<00:00,  5.13s/it]
dataset has 1121806 tokens
Training...
Saving checkpoint/run2/model-6000
Saving checkpoint/run2/model-6000
[6050 | 124.86] loss=0.55 avg=0.55
[6100 | 207.37] loss=0.45 avg=0.50
[6150 | 290.05] loss=0.78 avg=0.59
[6200 | 372.61] loss=0.37 avg=0.54
[6250 | 455.21] loss=0.18 avg=0.47
[6300 | 537.83] loss=0.30 avg=0.44
[6350 | 620.57] loss=0.70 avg=0.48
[6400 | 703.10] loss=0.33 avg=0.46
[6450 | 785.61] loss=0.14 avg=0.42
[6500 | 868.22] loss=0.24 avg=0.40
[6550 | 950.90] loss=0.35 avg=0.40
[6600 | 1033.38] loss=0.15 avg=0.38
[6650 | 1115.90] loss=0.13 avg=0.35
[6700 | 1198.61] loss=0.24 avg=0.35
[6750 | 1280.99] loss=0.13 avg=0.33
[6800 | 1363.46] loss=0.11 avg=0.32
[6850 | 1446.10] loss=0.19 avg=0.31
[6900 | 1528.75] loss=0.18 avg=0.30
[6950 | 1611.48] loss=0.15 avg=0.29
[7000 | 1694.13] loss=0.17 avg=0.28
======== SAMPLE 1 ========
 swinto, it must be in the care of some fairy, who will reward us with the most precious things.
I am very thankful to the lady who took me in, for she knows me quite well, and has not called for me twice from court -- once before and twice since .'
A few days later I found myself at the court of the Fairy Queen, who, thanks to the genius that was within her, had been enchanted with the beauty of the son she had lost.
When, after twelve long years, the fairy discovered that the son she had loved was of such poor health that she could not pay the father the three florins she had promised, she laughed at him and referred XXXXX him to the courts of justice .	to		In|Since|OF|as|at|because|by|if|in|that
For several years Milo paid his dues at the pub with frankness and mild surprise, though this surprise was quite lost on the elder.
Milo went to see the last great king, who had long since died, and was enchanted with the sight of the kindly bearded visage, and told the story of his adventures in the new world.
The king of the country asked for the same; and in vain did the young man send for the fairy to summon her attendant spirits.
At last the fairy gave him a beautiful crystal doll, who, when she had played with him in the pool, had become transformed into the ebony monkey commonly seen in royal chapels.
The enchanted youth played his parts as well as ever, and became in the act of carrying the doll to the play-ground.
When he had finished it the fairy said : ` Now, the king is in your hands, and must give honourable consideration to your services.
But what is a better proof of the success of love than that you should yield to the wishes of the stranger ?'
The trumpeter hailed the fairies joyfully, and proclaimed that they deserved the crown ; but on his departure the fairy told him that if he did not return within two weeks she would Beatrix van Beeste, who was in mortal danger of losing her life.
This threat was too much for poor Milo, and he grieved for its consequences in a way which the poor princess did not feel at all : he submitted to be married, but only on the condition that he should have one thing in particular reserved for his bride-mother.
It was said that she would have a son by her -- a ho!
-- and the son was said to be quite a virgin.
` Oh, my son, could you not find me a wife more lovely and better looking than the damsel on the bridge ?'
said the bride.
` Indeed, princess, there is a daughter of my own called Zelida, who is a possession XXXXX us . '	of		For|as|at|for|in|on|to|through|with|without
There is only one here, and it is so good!
I could die holding this -- and the others are not so bad .'
` Take me to the man, ' cried Darby, ` and let us have a big loaf of bread.
Will you give me a loaf, Darby ?'
` Certainly, ' said she, ` if you will help me to wind the mare up.
Woe to anyone who tries to poison us with wine, or bread dipped in the blood of it!
If you come here a second time, I will kill you !'
Then the hares were tied round the roan mare, and Darby tied the tail tight so as to choke it, and told it to the two robbers.
In the meantime the cock had flown to the king, who was kneeling by the gate, and said : ` Send at once and tell the queen that her son is dead, and hath flown away.
If she does not appear in the evening, I will call on the gardener and the banker .'
The robbers were taken in by the robbers, and brought their families with them.
The poor old mother did not know what to do, and in despair sat down on the steps and cry bitterly.
As she sat thus, her son entered the room.
` What is the matter ?'
shouted the king.
` How dare you attack the place of the dearest things in the world?
You have only yourself to blame for your whole race being ruined, and I am only a wanderer who has lost my way.
But if you will grant me a single request, you will restore my child to me, and in that case we will both be saved .'
Then the king and the queen wept, but they saw there was no escape.
So they sent for the two Wise Men, and they answered : ` We are the sons of the Almighty God, who has formed

[7050 | 1801.61] loss=0.10 avg=0.27
[7100 | 1884.49] loss=0.13 avg=0.27
[7150 | 1967.48] loss=0.11 avg=0.26
[7200 | 2050.35] loss=0.19 avg=0.26
[7250 | 2133.19] loss=0.12 avg=0.25
[7300 | 2216.06] loss=0.09 avg=0.24
[7350 | 2299.00] loss=0.21 avg=0.24
[7400 | 2382.05] loss=0.16 avg=0.24
[7450 | 2465.16] loss=0.11 avg=0.23
[7500 | 2547.94] loss=0.17 avg=0.23
Saving checkpoint/run2/model-7500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.


*********************************************************
*********************************************************

							File 4: cbtest_V_test_2500ex_OUT.txt    (5.4 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-4500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-4500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.25s/it]
dataset has 1376928 tokens
Training...
Saving checkpoint/run2/model-4500
Saving checkpoint/run2/model-4500
[4550 | 127.29] loss=1.54 avg=1.54
[4600 | 209.78] loss=1.17 avg=1.36
[4650 | 292.43] loss=0.44 avg=1.05
[4700 | 375.02] loss=0.86 avg=1.00
[4750 | 457.78] loss=0.50 avg=0.90
[4800 | 540.48] loss=0.53 avg=0.83
[4850 | 623.12] loss=0.71 avg=0.82
[4900 | 705.86] loss=0.90 avg=0.83
[4950 | 788.48] loss=0.52 avg=0.79
[5000 | 871.29] loss=0.76 avg=0.79
[5050 | 954.00] loss=0.56 avg=0.77
[5100 | 1036.65] loss=0.40 avg=0.73
[5150 | 1119.29] loss=0.62 avg=0.72
[5200 | 1201.91] loss=0.49 avg=0.71
[5250 | 1284.67] loss=0.39 avg=0.68
[5300 | 1367.36] loss=0.83 avg=0.69
[5350 | 1450.12] loss=0.33 avg=0.67
[5400 | 1532.82] loss=0.34 avg=0.65
[5450 | 1615.49] loss=0.63 avg=0.65
[5500 | 1698.16] loss=0.24 avg=0.63
[5550 | 1780.87] loss=0.51 avg=0.62
[5600 | 1863.60] loss=0.73 avg=0.63
======== SAMPLE 1 ========
 had the most difficult matter quite easily managed.
` Well, I hope that, ' said he, ` we have all got so far that we wo n't need a negro to stir our feathers any more, and that the meal will go on better than ever .'
And so he drank his fill.
When he had finished the potion, he looked at his ring, and perceived that there was a large number of ducats.
` That is quite enough for now, ' thought poor Saphir, ` and I will sit down and do my bit, too .'
So he was sitting in the most comfortable of recliners, and everybody there seemed to enjoy playing chess pieces, or tending sheep to and fro.
About half a hour after they had all sat down, the horse approached, and the fair-haired lad sat down just as Saphir was.
The lad took the potion every hour, and every day had a beautiful meal ready for him.
It was delicious!
And at night, when the lad was a little tired, he laid himself down in the middle of the room, and fell sound asleep.
When day dawned, the lad again rose up, and drove the horse into the field.
The following morning the lad said to his wife : ` Now we should really be getting somewhere ; for yesterday we were farmers, and now we were not even farmers myself, but merely keepers of the house .'
And his wife, having made up his mind to do so, XXXXX him a pretty little dress .	said		came|come|fetch|gone|holding|know|reached|said|sit
The King said, ` You are old, I know ; but will you come to my ball this evening?
I am going to give you a bushel of money, and I will see you there .'
And speaking of the money, he inquired who it was that she possessed.
` Well, I am, ' said Poor Pat 's mother, ' a poor Englishman on the run ; but where is the money that you always grudge yourself to give up?
I will see to it that the house is filled, and if you are poor I will have something to eat .'
So poor Pat went scolding up and down stairs till he was caught by a big Croak and locked it into a big barrel.
In the barrel was a little dark-eyed kitten which had a queer look, and it begged for something to eat.
Poor Pat shook it all about, and thought it was a very wicked kitten.
But when it begged for a nickel, Pat gave it to it.
Then the little kitty got into a little porch chamber and begged for a bushel of money.
` Where is my reward ?'
said Poor Pat.
` My reward will be a horse, ' answered the horse, ` and I will gallop off and bring you home .'
So the little kitty got home and lived happily with the Prince.
He had a horse to ride to the ball, a girth to tie round his neck, a couple of bushels of money to spend on himself, and a great many lovers ; indeed, many a many lovers.
Poor Pat lived to his ripe old age, but his lovers loved him still, and they made him very happy.
THE HAZEL-NUT CHEESE FACT A Sussex fisherman lived to a very old age, although he did not so much as eat properly to live on.
He had a daughter, who was nearly eighteen years old when she was taken ill with a vicious illness, and very much feared he would not live through his years.
To placate her the father gave her a very attractive purse with a face as white as jasper, and an old and beautiful shepherd 's crook on which a bird had sang to her all those years.
The Darling children loved the purse and all the jewels in it, and there was so much delicious green in it that the old mother could no longer keep it from her daughter.
Therefore she XXXXX the purse and her memories of it ; and when the purse was found close to the ground at the foot of the poplar, she made a big cardboard cut-out of it just as the real thing was.
When the three were all together, they drew up a table in which they had all gathered, and this they fastened round her neck, so that her mouth could not get out of it .	made		come|knew|loved|lived|opened|ran|rest|saw|scorned
In a moment the cat on the roadside was joined to the other cats in the yard, and they all sprang round her, and played up and down the garden, nosing and snorting.
Very soon the moon came up, and the old witch took her away to burn to death.
The

[5650 | 1971.79] loss=0.40 avg=0.62
[5700 | 2054.88] loss=0.36 avg=0.60
[5750 | 2138.25] loss=0.24 avg=0.59
[5800 | 2221.37] loss=0.89 avg=0.60
[5850 | 2304.62] loss=0.28 avg=0.59
[5900 | 2387.72] loss=0.14 avg=0.57
[5950 | 2470.91] loss=0.22 avg=0.55
[6000 | 2554.14] loss=0.33 avg=0.55
Saving checkpoint/run2/model-6000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.


*********************************************************
*********************************************************

							File 3: cbtest_V_valid_2000ex_OUT.txt    (4.3 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-3000
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-3000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.62s/it]
dataset has 1081880 tokens
Training...
Saving checkpoint/run2/model-3000
Saving checkpoint/run2/model-3000
[3050 | 127.32] loss=1.31 avg=1.31
[3100 | 209.89] loss=1.30 avg=1.31
[3150 | 292.69] loss=1.01 avg=1.21
[3200 | 375.57] loss=1.11 avg=1.18
[3250 | 458.33] loss=0.61 avg=1.07
[3300 | 541.16] loss=1.01 avg=1.06
[3350 | 623.82] loss=0.35 avg=0.95
[3400 | 706.60] loss=0.21 avg=0.86
[3450 | 789.32] loss=0.25 avg=0.79
[3500 | 872.14] loss=0.87 avg=0.80
[3550 | 954.86] loss=0.50 avg=0.77
[3600 | 1037.74] loss=0.33 avg=0.73
[3650 | 1120.51] loss=0.51 avg=0.71
[3700 | 1203.39] loss=0.68 avg=0.71
[3750 | 1286.19] loss=0.52 avg=0.70
[3800 | 1368.84] loss=0.74 avg=0.70
[3850 | 1451.72] loss=0.47 avg=0.68
[3900 | 1534.41] loss=0.19 avg=0.65
[3950 | 1617.22] loss=0.22 avg=0.63
[4000 | 1699.94] loss=0.29 avg=0.61
[4050 | 1782.77] loss=0.25 avg=0.59
[4100 | 1865.57] loss=0.26 avg=0.57
[4150 | 1948.19] loss=0.39 avg=0.57
[4200 | 2030.92] loss=0.27 avg=0.55
======== SAMPLE 1 ========
 I said ? ''
The King started for the stables, but the negro swaggered off into the woods, laughing.
` This must be the way of it !'
murmured he, glancing behind me.
So I rambled past him into the stables, where I heard the moveless girl repeating to her mother : ` What DID I tell you?
How did you XXXXX her ?	see		's|belonged|cried|felt|hearing|heard|knew|leave|seeing|seen|took
`` Let us think of it then -- they will think you have no taste, '' said Dan sarcastically.
`` Not very funny, '' answered the Story Girl, `` but I like it.
I can make names for things I like.
Just think of what a beautiful title it would be -- I could feel it in my heart . ''
`` You have no taste, my dear, '' said Felicity, coming up, `` and that is why people insult you and call you worthless ; but if you write a treatise on song it will be of no use whatever . ''
`` It would be my title, '' I said, thinking of the Rose Book, which everyone knows I wrote.
`` Why, it would be your title, too, '' asked Felicity, coming up, `` and that is why I chose it . ''
`` Why not tell me what it was, instead, ? ''
said Dan, coming up after me with a great deal of ceremony.
`` I felt it in my heart that you should be mad as I am the twain of them all.
Why, why, it seemed as if you were XXXXX mad as me . '' '	called		advised|asked|called|cried|know|ordered|said|suppose|write
In my grave lies only a goat.
So take heart . '''
Then Dschemil turned to his family and said : ` Is this true?
and has Dschemila not stolen my goats ?'
` Have they found their flocks, or is it a joke on her part ?'
` No doubt a joke, ' replied they, ` but what she has done with them I am quite sure ; and if she will mind I will pluck them up and bring them home to her mother .'
` That is just what I would like to know, ' said Dschemil, ` and here is the woman 's shawl torn about my head .'
` That is exactly what it was, ' replied her mother, who was weeping with them ; but she let them go and they were immediately seized by the demon 's power.
` Here is the woman 's shawl, ' continued Dschemil,, clasping the shawl, ` and on it are two hymn books, one of which is much older than the other, and these I will sell to you for seven hundred sequins.
If you have pity on me you can tell my sister everything about me, and she will some day.
For now her mother shall stay with me, and when I have recovered, you will find her in a desert place, weeping .'
` That I will not, ' said the two brothers, who were determined to go on with the service, and were quite determined not to XXXXX at the spectacle .	succeed		brave|cremon|emphatically|following|kill|loved|placed|removed|remarked|take
He must have fallen on the road, or she would have seen him for the first time just as the sun was setting behind the pines .'
I wonder if she will wear the blue silk dress, ' said the Story Girl ; but she doubted it, for she could not see the point in it.
Somehow she saw the tie of the green silk dipped in its redness, and now, clad in such a dress, no one could tell where she stood.
` Are not you afraid the mirror will reflect too ?'
asked Dschemil.
` No, I am not afraid -- at least, not then, ' answered the Story Girl, waving her hand cheerfully.
` It is so lovely to think of all that has happened in the last few days, and to be a part of it all.
I am so glad you have found happiness, and I am glad I have found you, ' she said, ` because now let us go back to the palace, and tell the queen what a fine bride she will have for her wife .'
` Oh, yes, I know what she shall say, ' replied Dschemil ; ` and she shall go at once to her room and tell him the bridegroom is in her arms.
Then, softly

[4250 | 2137.85] loss=0.30 avg=0.54
[4300 | 2220.94] loss=0.19 avg=0.53
[4350 | 2304.15] loss=0.37 avg=0.52
[4400 | 2387.15] loss=0.24 avg=0.51
[4450 | 2470.22] loss=0.22 avg=0.50
[4500 | 2553.36] loss=0.22 avg=0.48
Saving checkpoint/run2/model-4500
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.


*********************************************************
*********************************************************

							File 2: cbt_test_OUT.txt    (1.5 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=1500,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run2',
              print_every=50,
              sample_every=1400,
              save_every=1500
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run2/model-1500
INFO:tensorflow:Restoring parameters from checkpoint/run2/model-1500
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:01<00:00,  1.95s/it]
dataset has 373907 tokens
Training...
Saving checkpoint/run2/model-1500
Saving checkpoint/run2/model-1500
[1550 | 127.61] loss=2.25 avg=2.25
[1600 | 209.89] loss=2.51 avg=2.38
[1650 | 292.38] loss=2.92 avg=2.56
[1700 | 374.78] loss=2.95 avg=2.66
[1750 | 457.38] loss=2.80 avg=2.69
[1800 | 540.06] loss=2.25 avg=2.61
[1850 | 622.65] loss=1.98 avg=2.52
[1900 | 705.15] loss=1.09 avg=2.33
[1950 | 787.62] loss=3.28 avg=2.44
[2000 | 870.30] loss=1.30 avg=2.32
[2050 | 952.77] loss=1.02 avg=2.20
[2100 | 1035.39] loss=1.48 avg=2.14
[2150 | 1117.91] loss=2.30 avg=2.15
[2200 | 1200.56] loss=1.55 avg=2.10
[2250 | 1283.26] loss=2.42 avg=2.13
[2300 | 1365.81] loss=1.79 avg=2.10
[2350 | 1448.41] loss=1.10 avg=2.04
[2400 | 1530.95] loss=1.89 avg=2.03
[2450 | 1613.60] loss=1.30 avg=1.99
[2500 | 1696.25] loss=1.09 avg=1.94
[2550 | 1778.85] loss=0.88 avg=1.88
[2600 | 1861.46] loss=0.97 avg=1.84
[2650 | 1944.07] loss=0.93 avg=1.79
[2700 | 2026.60] loss=0.37 avg=1.73
[2750 | 2109.16] loss=0.41 avg=1.67
[2800 | 2191.62] loss=0.81 avg=1.63
======== SAMPLE 1 ========
, and he had a very handsome figure, and he had a goatee, round about the neck, and the word GOAT means good, ugly, dirty, out-of-place.
He was also so short that he had to stoop very low, and he had to stoop very low -- you know that it means nothing but ---- and he had to walk at a prodigious pace, running backwards over things, or jumping two or three feet in the air, just to keep from falling.
When he thought he was well off, he would lie down and get lost in thought ; but, otherwise, he ran as hard as he could go, and ran.
He could run up walls, with no fall, and he was so quick with his feet that he almost jumped out of the window, and ran round and round, and he kept jumping up and down, with an involuntary tap going out from him, like a pigeon, as he bumped and bumped.
Harry could not help noticing how quickly this was done, but he did not feel brave for fear of being run over by a gander.
Presently he began to feel very thirsty, and he wondered very much whether he would have to drink now, or not.
Drink!
he repeated after himself, as if dancing through a puddle.
`` Drink to me for the first time, -LSB- I say this with an awful lot of hope for better luck yet!
I am not thirsty any longer, -RSB- but I wish for water . ''
-LSB- For, you know, it is very difficult to say `` drink '' when you are not thirsty . -RSB-
`` Drink, I tell you, '' answered Harry miserably.
`` That is the worst thing you can do.
Run away with you, or I shall get you some damn good meal, and then you should not follow me.
It is neither justice nor prudence to ask . ''
`` No, '' interrupted Dan.
`` I will drink, anyway, if you will only let me drink, '' said Harry, frowning and throwing a hand into the puddle.
`` Well, if you wo n't take me back, you must not expect anything better . ''
`` Take me with you, '' said Dan gloomily.
`` It sounds as good a plan as anything I have ever concocted in my whole life.
You stand five feet on the floor, and step two is to throw you from the window.
Do try it on if you are brave enough.
I dare say you can make an anchor by the end of it.
Oh, I give your hand the rope, it is as strong as my head.
I will tie it to the line on the house, and you can come and get me some water, if you want . ''
`` That is not the way, '' interrupted Harry, with an idle look at Dan.
`` They have had a swim.
We have no chance yet . ''
`` What do you mean by 's ' nothing ? ''
demanded Dan gloomily.
`` What do you mean by *nothing ? ''
demanded Harry coolly.
`` I mean by that, `` replied Dan, `` that you would not have any chance until you BOVE MISSIONARILY in the line . ''
`` That is not what I mean, '' said Harry, `` and I have heard those with eyes to come up for it from time to time.
I am very sorry for that old boy, but if you will come out with me, you will have to sit behind me, because I have nothing to carry.
But you must come in with an empty stomach, and step two I will show you . ''
The three fellows went with him into the sea, and made for the cliffs by the sea.
There they sat and drank all day, whereas the one who had been out in the main in the warm water, and who had not drank another drop, wailed pitifully in her.
They tied her to the ship with a number of shoals of drift, and when night came came in and they all went to sleep, a little one from the other and a fair one from old Harry, who was getting very tired of seeing the eyes of orphans and very hungry fellows lying on the cold sand in the porthole of the ship.
So they did, even old Harry, who had never before seen such a pool as the one beneath the two swimming fellows.
`` This is the pool for my little sister, '' said Old Harry, with a shiver, `` although she cannot swim like I do, if she has the smallest bit of swim.
If I had it all, she could be nearly as good as the first time round.
But that will not be enough, for she is a lowly child!
Well, I will tell you what will make

[2850 | 2298.21] loss=1.09 avg=1.61
[2900 | 2381.19] loss=0.68 avg=1.57
[2950 | 2464.40] loss=0.13 avg=1.51
[3000 | 2547.38] loss=1.44 avg=1.51
Saving checkpoint/run2/model-3000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.

*********************************************************
*********************************************************

							File 1: cbt_valid_OUT.txt    (1.2 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=1500,
              restore_from='fresh', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              run_name='run2',
              print_every=50,
              sample_every=1400,
              save_every=1500
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint models/355M/model.ckpt
INFO:tensorflow:Restoring parameters from models/355M/model.ckpt
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:01<00:00,  1.55s/it]
dataset has 288319 tokens
Training...
[50 | 87.98] loss=3.43 avg=3.43
[100 | 170.48] loss=2.40 avg=2.91
[150 | 253.02] loss=2.65 avg=2.83
[200 | 335.54] loss=2.57 avg=2.76
[250 | 418.12] loss=2.27 avg=2.66
[300 | 500.83] loss=1.26 avg=2.42
[350 | 583.52] loss=1.96 avg=2.35
[400 | 666.16] loss=1.50 avg=2.24
[450 | 748.72] loss=1.20 avg=2.12
[500 | 831.37] loss=2.64 avg=2.18
[550 | 914.03] loss=2.68 avg=2.22
[600 | 996.67] loss=1.80 avg=2.19
[650 | 1079.42] loss=0.95 avg=2.09
[700 | 1161.99] loss=1.22 avg=2.02
[750 | 1244.58] loss=1.68 avg=2.00
[800 | 1327.20] loss=1.89 avg=1.99
[850 | 1409.87] loss=0.59 avg=1.90
[900 | 1492.41] loss=0.55 avg=1.82
[950 | 1575.07] loss=1.68 avg=1.81
[1000 | 1657.75] loss=0.25 avg=1.72
[1050 | 1740.49] loss=0.37 avg=1.65
[1100 | 1823.20] loss=0.87 avg=1.61
[1150 | 1905.86] loss=0.31 avg=1.55
[1200 | 1988.39] loss=0.53 avg=1.50
[1250 | 2071.07] loss=0.98 avg=1.48
[1300 | 2153.80] loss=0.12 avg=1.42
[1350 | 2236.44] loss=0.13 avg=1.37
[1400 | 2318.98] loss=0.61 avg=1.34
======== SAMPLE 1 ========
 yourself?
If it is she it is mine ! ''
And as he spoke he touched her and she felt all his passion and loathing disappear from her heart.
Then he put a bullet in her heart, just as God had taken away Zamzam 's and put a bullet in her heart, just as Zamzam 's had turned into powder and gone to the dogs to get her.
The white wolf knew that he had not killed the wrong animal, but he had done a terrible thing, and whatever else he may say, he was no coward.
So the moment he saw the poor girl looking at him with terror in his eyes, he threw himself at her feet and said : ` Get out of this, or I will kill you !'
` What are you afraid of?
You are only a coward !'
she replied .'
I am afraid I will kill you .'
` Let her be, or I will kill her !'
replied the wolf.
When the father had heard the tale, he drew a sword from his belt and brought it to the girl ; but she answered ` Yes, father, I will obey you.
Only, if you will hand over the key to me, and give me a horse of gold.
So do not make me a White Wolf!
You will be sorry for me .'
` Very well, ' said the father, ` give me a horse of gold.
It is a splendid key, and I would not let anyone get hold of it.
And tell me where the key is, and I will go and retrieve it .'
So the father set out and found the key in the keyhole of one of the rooms.
Wilhelm took the horse, and fled with the princess to a neighbouring castle, where the horse was waiting to receive the key.
But when he came to the keyhole it was gone !'
` Ah, my son, ' said the horse, ` we have lost the key !'
` What has happened?
Let me see if I may ask your advice .'
` Set to work at once, ' answered the horse, ` and I will soon return .'
The key had come for breakfast, and on the table beside it were a pair of boots -- Boots, a blue and gold colour, for the horse 's coat, and Boots, a very dark blue, for the horse 's feet.
And the horse began to eat the boots, and drinking he found the key.
` Take me to the horse, horse, horse !'
said the horse .'
I want to speak with you in the horse language, and all will become clear shortly.
Now, if you will go with me, you can sleep in the horse 's fur and live on grass, and if you will not, you will have to go on as before .'
The horse was ready to saddle, and once more the princess heard the horse 's language.
` Give me your horse, ' he said, ` and I will gallop with you.
If you wear the purple embroidered dress, you shall ride with me ; but if you wear the white lace, you shall remain on horseback .'
Now the horse was far on his way to the castle, when he saw the white dress and the black horse in the courtyard.
Now the white horse was a very majestic beast, and the black horse was nothing short of an idiot.
So the king sent to question the horse, and when the prince came, the prince was a little stunned, and thought that the horse was speaking a foreign language.
` What did the horse say to you ?'
asked the horse.
` The horse said, `` Ask to speak with me . ''
` Why me ?'
said the prince.
` Ask, and I will give you a horse.
What is there to be gained by speaking to me of my horse ?'
` Speak to me, and I shall give you a horse.
What is there to be gained by speaking to me of my horse ?'
` Speak to me, and I shall give you a horse.
I will gallop with you no longer !'
` Why me ?'
asked the horse.
` Ask, and I will give you a horse.
What is there to be gained by speaking to me of my horse ?'
` Speak to me, and I shall give you a horse.
If you are not a horse Master Yoshi-Daimaron, you are nothing !'
` Then what is there to be gained by speaking to me of my horse ?'
` Speak to me, and I shall give you a horse.
What is there to be gained by speaking to me of my horse ?'
And the horse said, ` Hereafter I will ride with you .'
` Why me ?

[1450 | 2425.46] loss=1.03 avg=1.32
[1500 | 2508.62] loss=0.90 avg=1.31
Saving checkpoint/run2/model-1500


*********************************************************
*********************************************************
	model 2 model 2		- end
*********************************************************
*********************************************************


---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------

*********************************************************
*********************************************************
	model 1 model 1		- start
*********************************************************
*********************************************************

							File 11: cbt_train_OUT.txt    (25.2 mb)

NEVER RAN - TIMED OUT EARLIER

*********************************************************
*********************************************************

							File 10: cbtest_CN_test_2500ex_OUT.txt    (5.8 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

STARTED BUT TIMED OUT MIDWAY

*********************************************************
*********************************************************

							File 9: cbtest_CN_valid_2000ex_OUT.txt    (4.4 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-16000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-16000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.74s/it]
dataset has 1114512 tokens
Training...
Saving checkpoint/run1/model-16000
Saving checkpoint/run1/model-16000
[16050 | 128.24] loss=0.26 avg=0.26
[16100 | 211.24] loss=0.38 avg=0.32
[16150 | 294.19] loss=0.31 avg=0.32
======== SAMPLE 1 ========

Mowgli could not imitate them in this, for Mowgli is such a very little man that Gray Brother could not have matched.
So for a while it was just as if nothing had happened, all the time keeping right on like a watch.
Then something began to hurtle towards the old stone wall in the far corner.
It seemed to pass by without even thinking of what it was.
It was so closely packed that even the old stone wall itself trembled, and in its heart everything went silent, as if in worship.
Shere Khan was not fast asleep -- he was wide awake, and could hear everything that was going on within.
His XXXXX swayed to and fro, as of someone making a great noise .	head		hoot|hoot-toot|king|neck|nothing|place|people|stride|thought|tree|window
But she answered she had not anywhere to go.
` Oh madam, ' said he, ` I will take your child to your old home .'
So she led the child away, and he swung her on his back and bore her away to her mother 's palace.
Again, though she thought it was her own mother, she did not hesitate, and she went at once to the king 's room, and told him she could never rest there.
Now all this time the old woman was troubled, and had heard that her son was dead, and she had no peace until she had found him.
So she wept, and wept, and wept, all day and all night, and went about as far as the palace windows, seeking for her son.
And when she had found him, she took fright lest anyone should hear her, and hid herself and went out to him, and told him that if he did not come back in the next day she would make him boil her brains, and throw herself upon her.
For two weeks she sat below listening to the sound of her crying, and when she caught sight of the prince she did not hesitate an instant, but ran towards him dismissively, picking up the handful of suckling insects and shaking them vigorously.
As soon as the cock crew they all flew into her room, and she was so frightened that she nearly fainted.
As soon as the cock crew they all disappeared, and she was so glad that she was safe that she began writing verses to herself, to tell the prince of all her misfortunes.
As for him, his mother ministered to him as best she could, but when she did not find him in the XXXXX she was comforted that life had come to a bad end, as nothing could be done .	palace		child|king|parents|people|place|prince|pence|palace|prince|sound
` Oh, you foolish girl!
What are you dreaming about?
If you had not shown me that broom you had with you, I would not have been in your bed this morning .'
` Yes, I know, Madam, ' replied the girl, ` but why did you force me to dismount from the chariot?
Why have you shown me, instead of showing me the bug ?'
` This is enough, enough, ' said she.
` But what became of it ?'
asked the farmer.
` It was a swallow .'
` And how did you get it ?'
` They gave me it in exchange for not showing you the bug 's head, ' replied the girl.
` Ah!
Why, you know not what to do with a butterfly 's head!
You have only to give it up, and you will get a cockchafer instead of the thing.
Which do you think I did ?'
` All right, then, ' said the farmer, and handed her the cockchafer.
The girl thanked him for his good faith, and had him with her.
They talked together for a while, and when he had had some supper he told her that she ought to marry him, for he thought she was dead.
` But what becomes of him ?'
asked the girl, sobbing.
` He joins the cockchafer, and then we sing a little song.
I will stick to it .'
` Well, I will tell you what.
Years hence, O King of the Birds, I will rebuild your old palace with the stone walls you have given me .'
And XXXXX promised !	King		crown|farmhouse|girlfriend|palace|king|man|majesty|prince|right|words
Now this was the magic seed, which the woman had carefully hidden in the soil, and which the farmer brought out into the fields every spring.
As soon as the girl heard of her husband 's death,

[16200 | 402.63] loss=0.26 avg=0.30
[16250 | 486.07] loss=0.30 avg=0.30
[16300 | 569.29] loss=0.12 avg=0.27
[16350 | 652.53] loss=0.25 avg=0.27
[16400 | 735.81] loss=0.14 avg=0.25
[16450 | 819.31] loss=0.09 avg=0.23
[16500 | 902.90] loss=0.36 avg=0.25
[16550 | 986.68] loss=0.17 avg=0.24
[16600 | 1070.28] loss=0.26 avg=0.24
[16650 | 1153.98] loss=0.11 avg=0.23
[16700 | 1237.59] loss=0.16 avg=0.22
[16750 | 1321.18] loss=0.22 avg=0.22
[16800 | 1404.61] loss=0.17 avg=0.22
[16850 | 1488.00] loss=0.26 avg=0.22
[16900 | 1571.48] loss=0.24 avg=0.22
[16950 | 1655.05] loss=0.17 avg=0.22
[17000 | 1738.69] loss=0.17 avg=0.22
Saving checkpoint/run1/model-17000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[17050 | 1829.27] loss=0.19 avg=0.22
[17100 | 1912.83] loss=0.38 avg=0.22
======== SAMPLE 1 ========

` But leave my wife alone, for she has better keep my heart than your wife, ' the ogre said to his wife, ` for by that time I shall have ten wives, and many young children .'
` My dear husband, ' replied his wife, ` my husband, why do you go so away?
Bury this XXXXX, and come tome for seven days, and I will stay by your side always . '	man		Illustration|beast|children|council|daughters|father|home|husband|one|woman
So the king gave him a hundred florins, and bound a rope round him, so that he could never get down.
But the thousand voices which he had to obey through the night became ten voices, and each one lowered his voice until a hundred men could not hear him.
So the king had to go a long way before he found his little dog, whose name was Ring.
When he had found him and recognized him, the king said to him : ` Good man, you are a great stumbling block.
You must give me a hundred florins, and I will gladly give you my daughter .'
But Bobino would not listen to the king, and, instead, he went straight to the palace and implored the princess to promise to marry him if he would tell her where the king was.
And the princess had to listen to him, and obey him at once.
When they had to leave the palace and the garden, they saw each other every day, and every time he called to her, she answered : ` My lord, ' ` visit my dogs, ' and when he came home, she would come and see him.
But he never came, and she never heard from him.
All day she wondered and wondered, and, when it was almost dark, she said to her mother : ` I will go and look in the cupboard, for I am afraid the dog will have something to say to me while I am with you .'
And the XXXXX said : ` You see, my dear, these are the four hundred florins Mrs. Fair keeps for herself and me .	mother		anyone|cousin|days|dog|mother|passion|princess|sight|sleep|supper
` So I will, ' said Little Klaus.
For ten days they travelled through the desert, and then they came to a place where the road parted in two.
` Uncle !'
said Little Klaus.
` Well, what is it ?'
asked the uncle .'
I do not know.
I think I will go in search of my kith and kith .'
` Kith what ?'
said Big Klaus.
` Kith of course.
But wait.
Here are ten florins for you, each of you .'
` And should I lose them ?'
said Little Klaus.
` If I do not come back in the evening, you shall pay for them now, for I do not intend to lose them.
But if I do, you shall pay for them the twelve hundred florins .'
` Then if I lose them both, ' said Big Klaus, ` I will pay for the kith of my ten florins, and the ten florins for each of the others .'
` All right, ' replied the uncle, and they went to his house, where he told them all about his nephew.
` Now, ' said Little Klaus, ` you had better prepare supper for the wedding of your second sister, for she is going to the town to serve as wedding coordinator.
She is expected there on Tuesday, and you will have to prepare XXXXX for her as well as me .	rabbi		Dschemila|fault|garden|ground|king|man|money|owner|road|rabbi
Happy Jack blinked at the empty cage.
Then he began to ask in a scolding tone, `` What did you do with him?
What did you do with him ? ''
Farmer Brown 's boy just smiled at him and passed him a nut.
Sammy grew up never let a chance for eating go to waste.
He sat up and invited Reddy Fox to eat the nut.
They were such good little friends that after some time had passed, Reddy had developed a reputation for being rather cruel, and was a regular feature in the Green Forest.
It was not long before other little Folds have been fat, red, and rude, and every day Reddy looked at him with a new set of bright brown eyes.
Poor Sammy Jay grew very uncomfortable.
He just closed his eyes and waited for the Reddy Fox.
In the middle of the supper, when all was over, and Sammy was still a little

[17150 | 2018.60] loss=0.27 avg=0.23
[17200 | 2102.02] loss=0.16 avg=0.22
[17250 | 2185.30] loss=0.22 avg=0.22
[17300 | 2268.67] loss=0.05 avg=0.22
[17350 | 2352.30] loss=0.11 avg=0.21
[17400 | 2436.11] loss=0.08 avg=0.21
[17450 | 2519.45] loss=0.13 avg=0.20
[17500 | 2602.73] loss=0.15 avg=0.20
[17550 | 2686.34] loss=0.11 avg=0.20
[17600 | 2770.15] loss=0.15 avg=0.20
[17650 | 2853.68] loss=0.16 avg=0.19
[17700 | 2937.04] loss=0.20 avg=0.19
[17750 | 3020.34] loss=0.08 avg=0.19
[17800 | 3103.83] loss=0.08 avg=0.19
[17850 | 3187.42] loss=0.13 avg=0.19
[17900 | 3271.08] loss=0.06 avg=0.18
[17950 | 3354.54] loss=0.16 avg=0.18
[18000 | 3437.95] loss=0.12 avg=0.18
Saving checkpoint/run1/model-18000

*********************************************************
*********************************************************

							File 8: cbtest_NE_test_2500ex_OUT.txt    (5.3 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-14000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-14000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:05<00:00,  5.57s/it]
dataset has 1360345 tokens
Training...
Saving checkpoint/run1/model-14000
Saving checkpoint/run1/model-14000
[14050 | 127.60] loss=0.50 avg=0.50
[14100 | 210.51] loss=0.16 avg=0.33
[14150 | 293.39] loss=0.43 avg=0.36
[14200 | 376.48] loss=0.58 avg=0.42
[14250 | 459.50] loss=0.26 avg=0.39
======== SAMPLE 1 ========
 found the only possible means of avenging yourself on Shere Khan.
So I dropped my yoke, yoke of my horse, and came down from the pole.
Spoke to Shere Khan, and he took me for my cub.
`` When I was twelve years old I took a yoke of that same river, and when I was thirty-six I took a goad of that very same camel, and each time I had to take the lesser, and the quicker it goes the more miserable it makes the man.
I began to tire of this life, and longed to die.
At last I realized that my yoke was not such a rope as it seemed.
It seems now like a blue-eyed girl, but in reality it was a copper plate with a gold band on it, and the bands were often cut off during the XXXXX , for the poor sleeper had to work so hard and so well that he was nearly blind or his eyes would have blazed with excitement .	night		Khan|King|Night|Shenk|sparrow|cub|day|daylight|gold|years
He was not going to be caught.
To be sure, he is six feet under, but that is not the point . ''
Three-quarters of a mile away was a sloping meadow all white with grass and roses.
A tiny streamer dangled over the top of it, and a groom 's horse quietly rowed along the wings to give it a gentle thump.
You do not know what it made or how it came about that the slender form of Mrs. Charley was borne to it.
But if you are willing to bet twelve hundred florins that it did not, you will convince me otherwise.
`` Cousin Chipmunk has no use for his life, '' said Mrs. Charley sincerely, `` except as that he be lying there somewhere . ''
Ned 's frank face clouded over.
`` I suppose he be lying there a good deal, '' he admitted, lamely.
`` He is a scoundrel, much the worst kind.
He used to be in the Meade House.
Everybody there knows where he lives now.
I know all about it -- and so do I. '' `` Well, why did not you tell us before?
I would done it for him . ''
`` I would not dare.
I was one of those who said it was just right . ''
`` Who was wrong ? ''
Ned whistled.
`` I am not sure I would have been mistaken, '' said XXXXX gravely .	Ned		Chipmunk|Cousin|Edwin|Charley|Chipmunk|Ned|Ned|Johnny|Jimmy|horse-skin
`` I am the wife of Hag 's son, Leonard, and Levinson, '' she said, without the slightest intention of being sarcastic or condescending.
`` Long may he live and well!
He shall not be killed in the desert.
Nor shall he wander idly through the flowery meadows, where buttercups glisten and green velvety lips meet stiff, cold breast.
All the spring he may even return to his own lairs, as the queen 's daughters did, unharmed of it ; but if he goes wet, well it is nothing that Tam not be taught to handle.
He shall not run over his fields with ragged rags.
Nor shall he drink the Yez from the lungs of hawks.
Nagaina, my sister, will go for you . ''
`` Oh, I will not go, '' said Nag, `` I have not had much to do . ''
`` Dumbledore will be sure to kill me.
The man 's son carried some medicine out of the West that is supposed to help the sick, and he came away without it.
Am I right ? ''
`` Nag, if you are a witch, '' said Nag, shaking his head dubiously, `` you better go to the W. P. Carey, and tell the nurse that Nag is not a boy . ''
A faint, wraith-like change of expression drifted over her quiet face and was gone in half a millisecond.
If she would but known it, she would have sworn the word for the dog.
`` I will go, '' she said fervently.
`` I will go, '' said Mrs. Head, shaking her head dubiously.
`` I deserve it . ''
`` It is not your fault, '' said XXXXX morosely .	Nag		Nag|Doctor|I|Lips|tailoring|boy|flossie|right|streamer|tobias|year|years
In due time a second Prince appeared, and the King was overcome with terror as

[14300 | 567.66] loss=0.31 avg=0.37
[14350 | 651.08] loss=0.18 avg=0.35
[14400 | 734.58] loss=0.15 avg=0.32
[14450 | 818.15] loss=0.26 avg=0.31
[14500 | 901.67] loss=0.23 avg=0.30
[14550 | 985.14] loss=0.18 avg=0.29
[14600 | 1068.90] loss=0.17 avg=0.28
[14650 | 1152.81] loss=0.19 avg=0.27
[14700 | 1236.51] loss=0.31 avg=0.28
[14750 | 1320.15] loss=0.18 avg=0.27
[14800 | 1403.82] loss=0.55 avg=0.29
[14850 | 1487.35] loss=0.24 avg=0.28
[14900 | 1571.02] loss=0.34 avg=0.29
[14950 | 1654.61] loss=0.31 avg=0.29
[15000 | 1738.24] loss=0.17 avg=0.28
Saving checkpoint/run1/model-15000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[15050 | 1829.00] loss=0.23 avg=0.28
[15100 | 1912.73] loss=0.50 avg=0.29
[15150 | 1996.10] loss=0.21 avg=0.29
[15200 | 2079.60] loss=0.16 avg=0.28
======== SAMPLE 1 ========
 the face was very sober.
`` I suppose you would like to come in and see the children, Parbati, '' said he.
Parbati cast an angry glance at XXXXX .	Bagheera		Bagheera|Baloo|Baloo|Bagheera|Hah|I-Ikela|Pahari|yaks|nurseries|pensons|scream
`` The Devil makes all His shadows, '' said Bagheera, `` but this man certainly has the appearance of a true Devil.
Why, he has eyes like red fire, and his hair is all young and wild, and very well cut and Rannishly dressed.
Is not that the best proof of his being a true Devil?
I will eat him . ''
`` Probably not, '' said Frank, but he meant to be polite.
`` Besides, he has been telling tales of Iouness, and I have a feeling that most of our word is true . ''
`` Mulder, do you take me for a man ? ''
said Bagheera.
`` Do you take me for a dealer? ''
`` Exactly so, '' said Frank, and shook his head.
`` I am going to turn the man the fool that I am.
Why, I would like to know what the fuss is all about . ''
`` It is all about as much noise as ever was made in the Green Forest, '' said Bagheera.
`` I have heard Frank saying that the Green Forest was the sexiest place in all the world, and I have to say, if it is so, that I never tire of it.
It is such a splendid place.
I came so seldomin the past, but now I must go often -- to the Green Forest, that I have to turn the man on the fool 's errand.
I have not any horse, so I can not go horse-sitting, but sometimes a mule brings his bridle along.
I once saw a mule that was dressed for a day 's journey ahead, but the wind had nearly caught him, and he was so stiff and tired that he could not move.
Then I heard a rumour to the effect that he was going East, and would be staying there the whole winter.
He said his captain had told him he must stop in the harbour tomorrow, but that there was nothing for him there.
Well, well, '' said the mule, and held up his tongue.
`` I move on, '' he said.
`` What is that ? ''
The mule had been talking since the beginning of the adventure, and had a great deal more to say than he could say.
`` The fool has come!
He is ours -- not our XXXXX, for, you know, we do not live in the same world, and the fool is dead !	Fairy		Bagheera|Green|Hah|I-Iouness|Captain|Forest|Mulder|Mule|Ranness|word
`` I had to cover them again this morning, '' he explained with a chuckle-slap to himself, as he watched them slide the rock -LRB- The Moonstone -RRB- out of sight into the sun.
`` The morning after the funeral, when I was striding along up the (now damp) road, I put my boots on and, walking by the lighthouse, I thought I should have seen the Peacock or the Bat.
Why, there had never been any sign of them . ''
Half Moon Rimmering over the Gabbardine, Peter looked up in the apple-trees, and there he beheld the Rabbit with eyes as large as saucers.
Peter soon grew so accustomed to the sight of the Rook that he did not notice the other members of the team taking a great deal of time about it.
`` How does one get to the old lighthouse ? ''
asked Peter.
`` There used to be an old lighthouse across the stream, and when you shd like to go you had better wait a half-hour.
I went this way because I wanted to go to the old lighthouse, and in the hour I arrived I realized I was in the river too, and not half a mile from it at any rate.
So I started for the river.
About three miles from the river there is a big clearing, and in the middle of the clearing there was a wreath of wild flowers with my name written on them.
I was wondering what they would call it, when all at once out of the mist I saw a white horse.
Now, I have been to many a better-looking camp than that, and not all the miles that I have covered were like that.
Anyhow, I made my bow and arrow and came along

[15250 | 2185.98] loss=0.15 avg=0.28
[15300 | 2269.67] loss=0.15 avg=0.27
[15350 | 2353.19] loss=0.14 avg=0.26
[15400 | 2436.81] loss=0.21 avg=0.26
[15450 | 2520.45] loss=0.19 avg=0.26
[15500 | 2604.10] loss=0.20 avg=0.26
[15550 | 2687.58] loss=0.11 avg=0.25
[15600 | 2771.19] loss=0.08 avg=0.25
[15650 | 2854.97] loss=0.28 avg=0.25
[15700 | 2938.66] loss=0.15 avg=0.24
[15750 | 3022.28] loss=0.19 avg=0.24
[15800 | 3105.86] loss=0.11 avg=0.24
[15850 | 3189.26] loss=0.16 avg=0.23
[15900 | 3272.78] loss=0.21 avg=0.23
[15950 | 3356.27] loss=0.12 avg=0.23
[16000 | 3440.01] loss=0.37 avg=0.23
Saving checkpoint/run1/model-16000

*********************************************************
*********************************************************

							File 7: cbtest_NE_valid_2000ex_OUT.txt    (4.1 mb)

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-12000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-12000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.61s/it]
dataset has 1050855 tokens
Training...
Saving checkpoint/run1/model-12000
Saving checkpoint/run1/model-12000
[12050 | 127.13] loss=0.34 avg=0.34
[12100 | 210.21] loss=0.52 avg=0.43
[12150 | 293.06] loss=0.23 avg=0.37
[12200 | 376.22] loss=0.31 avg=0.35
[12250 | 459.19] loss=0.24 avg=0.33
[12300 | 542.22] loss=0.06 avg=0.28
[12350 | 625.26] loss=0.20 avg=0.27
======== SAMPLE 1 ========
.
I wish I had, and then I would not have missed the trees or the beach . ''
`` Trees and beaches are just as wonderful as fireworks and whistles, '' said Uncle Roger.
`` I daresay they are the best fireworks ever.
Every year we go to the fireworks show here in April.
It is the closest thing to being in concert . ''
`` Oh, we are not in concert, '' protested Cecily.
`` We are phonies in this dress.
We are the guests and employees . ''
`` Oh, I suppose you are one of them, then, '' said Dan.
`` Oh, yes, I suppose so, '' acquiesced XXXXX .	Dan		Cecily|Dan|Cyrus|Lifetips|Peg|Rodent|Roger|Seth|day|night
So there was no means of escaping from them.
When you had passed a hedge which commanded Heaven 's will always look through it, and you had entered a dark tunnel which led to that fairest sweetness -- the apple-tree.
Yet it was not without struggle that you got over the thorns and fallen so low that the peasant and his horse could not have pushed you over the top.
Even this little chest was quite empty, as there was not much in it save a little bit of bone.
As you have since heard, everything in the castle was of crystal, except the chest.
But what was in the chest was the heart of all the chief priests, who have been regular visitors for many years, and the story of its loss is told in the book of exploits with seals.
-LSB- From the German, Kletke . -RSB-
THE CIRCASSIANS OF THE EARTH A nun, a countryman, and a blacksmith were the only three with whom you had any dealings at all ; but there were others who were royalty guests, and the number of the travellers who had brought their own black skins with them.
One day, when the moon was full, the three companions, who had been awaiting you, went to the window of a neighbouring chapel, and saw drawn up, in a conspicuous place, the lovely angel standing facing them, with the duty of repeating the words of the ancient prophet to him.
But he rose and placed his elbows on his knees, almost touching his head.
` Ah, my lord and kings, ' he said, ` forgive me for misunderstanding you so long .'
` Never mind, ' replied the kings, though they could not suppress the tears that refused to come.
` Take heart again, my lords!
And my dear ones, remember that we always remember you .'
And wishing them a joyful dinner, they all resumed their places, and the princes ate and drank for the first time in their senses, for they had been afraid that night their dinner would be gone.
But there was no harm in eating and drinking, and, as Masella suggested, cursing the wind and the rain, they all made up their minds that it was more delightful to sleep and be miserable than to waken in the day.
So they all took refuge under a cypress tree, and lived in peace and happiness till the next day.
THE THREE SIX MEN -LRB- 5 -RRB- -LRB- 5 -RRB- From the German, Kletke . -RRB-
Once upon a time there was a peasant whose wife died, leaving him with two children -- twins -- a boy and a girl.
For some years after, the poor man looked after the house alone, and was obliged to work hard ; but after a while he had XXXXX enough, and he began to think about going out and visiting his home again, though he had not for some time expected to see his wife again .	to		CECILY|Germany|days|days|fairyland|hour|no-evil-doers|toad-dress|toad-spray|toad-sprayed
The boy could spell a spell, and the witch of the North had tripped him up, so that he had no one to turn to except Striped Chipmunk himself.
Striped Chipmunk smiled.
It was a sly, wicked smile.
The more he looked at it, the uglier it grew.
`` Why, it is just like the witch 's, '' thought Striped Chipmunk, `` except it is a girl.
Well, I guess I will go to see if it is a girl, '' and once more he waited patiently a little while before hopping on his horse.
Then he turned tail and ran.
Ah, how angry he was when he realized that his anger was quite allayed, when he heard Clemantiny 's cheering.
He suddenly realized that he had been X

[12400 | 734.58] loss=0.35 avg=0.28
[12450 | 818.22] loss=0.08 avg=0.26
[12500 | 901.94] loss=0.16 avg=0.25
[12550 | 985.71] loss=0.22 avg=0.25
[12600 | 1069.52] loss=0.12 avg=0.23
[12650 | 1153.26] loss=0.08 avg=0.22
[12700 | 1237.22] loss=0.21 avg=0.22
[12750 | 1321.17] loss=0.21 avg=0.22
[12800 | 1405.24] loss=0.14 avg=0.22
[12850 | 1489.22] loss=0.11 avg=0.21
[12900 | 1573.20] loss=0.15 avg=0.21
[12950 | 1657.12] loss=0.13 avg=0.20
[13000 | 1741.07] loss=0.25 avg=0.20
Saving checkpoint/run1/model-13000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[13050 | 1831.83] loss=0.18 avg=0.20
[13100 | 1915.52] loss=0.13 avg=0.20
[13150 | 1999.49] loss=0.20 avg=0.20
[13200 | 2083.49] loss=0.13 avg=0.20
[13250 | 2167.53] loss=0.17 avg=0.19
[13300 | 2251.28] loss=0.17 avg=0.19
======== SAMPLE 1 ========
 the the doors, and the carter, blind with rage, guessed at once what had happened, and ran at the door of the house again.
` Ah, how do you do, your dear husband !'
cried he ; ` let us hurry away, before anything happens to us .'
But the goose turned as though she would not endure the journey, and cried : ` No, no, no, my husband, ' and ran back once more to her brother.
But the carter was so mad with rage that he could not get out of the house, and so he fled for refuge to the forest.
For some time he wandered through the forest, but at last he reached the forest on the edge of the sea, close to the city where the seven princesses dwelt.
And there he found a hut, with a woman by his side, and said to her : ` Wife, what are you staring at so?
older maid, come with me, and look after the sheep ; I want to go to sleep .'
` All right, if you are in front of me, ' said she.
But the carter merely laughed at her words, and, cracking his whip, he drove his waggon straight into the sack, just as XXXXX did .	Renzolla		Bagota|Carters|Renzolla|senza|seventh|supper-time|third|storm|waggon|zapata
`` But I will make you sorry you ever came near my hickory tree, '' snapped Happy Jack.
`` No, I do not -- and that is all you have to do, '' replied Chatterer, his short temper flaring up.
`` You all have to do as I bid you, '' said Happy Jack, and tried to look patient even if he was not.
`` I think your tongue is going way out, '' said he.
`` The only patience you have is to follow me out of your way to the big apple-tree, and into the deep hollow where he lives.
I will let him live to grow old, just so that you and he may get married after all . ''
`` I will not go, '' said Chatterer.
`` Oh, that is too bad, '' protested Happy Jack, `` I want to get as many apples as I can, and then I will burrow underground . ''
`` It is not going to do any good, '' protested Chatterer.
`` You all have to dig down, '' said Happy Jack.
`` And I will help you to root them, if you do not do not want to lose your head, '' added Chatterer.
`` I do not dig very deep, '' protested Happy Jack.
`` It is easier to bury them in the ground than to dig them up, '' said that XXXXX, making up his mind .	Chatterer		Chatterer|Jack|Squirrel|bite|course|first|hickory|left|morning|possessors|tremble
And every evening, just as soon as the dancers were out of sight, he would hasten to meet them and offer his arm, as if to say, `` May the Force be with thee ! ''
Many a time he has danced with her, and, having made a deep impression on her mind, he has never forgotten his purpose of doing her honour.
And now he has the greatest treasure in the whole world, which a thousand thanks will go to him for his long friendship ; but he does not covet either her beauty or her riches, though he feels quite sure that if one thing were to happen to her he would leave her better than when he first came to the valley.
Sara Ray, who believed her old promise to have no more to do with me, is truly mad with anger.
But what she really has in her heart is a fierce desire to inflict pain on Johnny Chuck, to the very maxims of her beautiful, youthful face.
She has had to relearn a lesson that will make her ashamed of herself, and the very thought of it makes me sick to my stomach.
I hope she will be HAPPY AND PEACEFUL for the rest of her days.
MELISSA JAY HAS A PROBLEM It is a fact, one of the hardest things in the world, that tongues make the greatest part of all the trouble that brings uncomfortable feelings, and bitterness and sadness and suffering and sorrow.
If it was not for unruly, careless, mean tongues, the Great World would be a million times better to live in, a million times happier.
It is because of her unruly tongue that Sammy Jay is forever getting into trouble.
It is the same way with Chatterer the Red Squirrel.
And it is just the same way with a great many little boys and girls, and with grown-ups as

[13350 | 2357.08] loss=0.07 avg=0.19
[13400 | 2440.94] loss=0.13 avg=0.19
[13450 | 2524.62] loss=0.13 avg=0.18
[13500 | 2608.12] loss=0.20 avg=0.19
[13550 | 2691.61] loss=0.10 avg=0.18
[13600 | 2775.17] loss=0.13 avg=0.18
[13650 | 2858.74] loss=0.10 avg=0.18
[13700 | 2942.52] loss=0.08 avg=0.17
[13750 | 3026.35] loss=0.11 avg=0.17
[13800 | 3110.08] loss=0.12 avg=0.17
[13850 | 3193.88] loss=0.18 avg=0.17
[13900 | 3277.63] loss=0.12 avg=0.17
[13950 | 3361.34] loss=0.07 avg=0.17
[14000 | 3445.05] loss=0.12 avg=0.16
Saving checkpoint/run1/model-14000

*********************************************************
*********************************************************

							File 6: cbtest_P_test_2500ex_OUT.txt    (5.7 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-10000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-10000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:06<00:00,  6.13s/it]
dataset has 1424360 tokens
Training...
Saving checkpoint/run1/model-10000
Saving checkpoint/run1/model-10000
[10050 | 126.48] loss=0.62 avg=0.62
[10100 | 209.55] loss=1.22 avg=0.92
[10150 | 292.73] loss=0.35 avg=0.73
[10200 | 375.93] loss=0.50 avg=0.67
[10250 | 459.04] loss=0.43 avg=0.62
[10300 | 542.25] loss=0.39 avg=0.58
[10350 | 625.30] loss=0.19 avg=0.53
[10400 | 708.40] loss=0.25 avg=0.49
[10450 | 791.54] loss=0.13 avg=0.45
======== SAMPLE 1 ========
 talked him that if he did not stop to take a swineherd 's call on his tail when he lay his neck up on a bed of roses and there were bugs in it, it would be a good deal sooner eaten up by the little people of the Copper Island.
`` Neighbours ! ''
he cried, `` is there such a thing as a white man 's neighbour?
Let us see . ''
And he went and sat down by the window and looked through.
Not a white man had ever looked at the Copper Island before.
Now he saw before him a small, well-covered hut, and it was the same style of hut as the one in which he had left home.
He knocked at the door and told it to be opened.
It was, XXXXX he thought, an old couple that had had a beautiful daughter, and he knocked and inquired what the daughter of such a thing did in the island 's name .	for		If|as|among|among|for|from|in|of|on|under
So the Prince went along with him to hunt for his mare, but there he met another hunter, and it was not his first fight.
He had formerly fought against a great dragon, and in that struggle he had broken two of her great horns.
In the same year he had cut off a piece of her tail, and made use of it in his fight with the great gray old troll.
The Prince was furious, and he rode on until he found a well-covered mound of gold under which the Prince had hidden himself.
On it was written his name and the price of his cow, his mare, and the iron horse.
The Prince was angry at his stupidity, and he rode home and told his father what he had seen.
The King replied that he was very sorry over it, for he expected nothing better of himself.
While the Prince was home, however, he drew aside the circle of friends which included both the nobles and the gentlemen of the house.
They included two of his courtiers, a young nobleman and a young lady.
They were at once astonished and furious, and spoke to the young nobleman directly.
` Tell me, who are you?
You are a king 's son .'
I ask you, I am the King 's son, ' they said, ` and have built up a kingdom by the blood of goats .'
` Who knows ?'
answered the Prince.
` Only confide your grief in me.
Let me be your avenger.
I will now go to another field, and my mare and foal will serve you there.
But the thing will be quite different from what you did.
Your mare and foal will be chums with the birds of prey, and the birds with the wolves .'
And he drove them to the place where he and his team had stopped to pluck the golden apple.
There he found a human being trying to catch the fruit.
He was only a few yards off, and he was flashing his three feet XXXXX jumping about with joy .	till		While|as|because|from|in|of|on|that|to|with
The Prince, moved by pity, without thinking what he was doing, ran to the courtyard of the castle, and filled a jug with water, which he poured over the man in the cauldron.
In a moment a most fearful crash was heard, as if all the pillars of the palace were giving way, and the palace itself, with towers and doors, windows and the cauldron, whirled round the bewildered Prince 's head.
This continued for a few minutes, and then everything vanished into thin air, and Iwanich found himself suddenly alone upon a desolate heap of sand.
The air was full of winds and yells, and every wind that he flew in, as well as the sand, were changing places with those of their prey.
The Prince, who now realised what his heedlessness had done, cursed too late his spirit of curiosity.
In his despair he wandered on over the heap, always looking for the Nun 's face, which never changed.
At last he saw her face distinctly, but without being able to pronounce her name, and the wind around him stilled out his voice.
Looking up at him from the sand, he said nothing, but, sitting down by the stream, he gave the Nun the question which the Prince in misfortune had not been able to answer.
` Who are you, and what do you want ?'
asked the Nun.
` I was born in the very jail in which I lay, ' replied the Prince.
` But why were you condemned to be put to death ?'
asked the Nun.
` Because you have been accused of being a Carpenter 's son

[10500 | 900.27] loss=0.17 avg=0.42
[10550 | 984.14] loss=0.18 avg=0.40
[10600 | 1067.91] loss=0.40 avg=0.40
[10650 | 1151.45] loss=0.14 avg=0.38
[10700 | 1235.02] loss=0.21 avg=0.36
[10750 | 1318.39] loss=0.15 avg=0.35
[10800 | 1401.70] loss=0.15 avg=0.33
[10850 | 1485.05] loss=0.12 avg=0.32
[10900 | 1568.45] loss=0.33 avg=0.32
[10950 | 1651.86] loss=0.55 avg=0.33
[11000 | 1735.24] loss=0.38 avg=0.34
Saving checkpoint/run1/model-11000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[11050 | 1825.97] loss=0.14 avg=0.33
[11100 | 1909.52] loss=0.21 avg=0.32
[11150 | 1993.36] loss=0.34 avg=0.32
[11200 | 2076.82] loss=0.16 avg=0.31
[11250 | 2160.61] loss=0.18 avg=0.31
[11300 | 2244.28] loss=0.12 avg=0.30
[11350 | 2327.83] loss=0.12 avg=0.29
[11400 | 2411.39] loss=0.24 avg=0.29
======== SAMPLE 1 ========
 confiably to one of the great stone walls in the midst of the terrace and then set off by a big pond in the heart XXXXX the flowery meadow .	of		among|as|because|before|into|like|of|since|with
After that, of course, she set about her pleasant day.
Bonnetta assured her that the ladies liked her, and one of them put her down pretty gently, wondering if, after all, she really was as sweet and lovely as she seemed.
When they left her, however, they did not like to think of what Gracepoint was likely to be like.
They said it was so beautiful that even the King himself had to admire it.
Several days were spent in these interesting conversations, but at last the lady 's plan came to an end, and the Duchess made her way out of the meadow and along the seashore, taking great care to carry a perfect score of geraniums in her pocket, so that, far from being astonished, the poor little girl burst into tears.
For the first time since she was a little girl, a hand had gently stroked her heart.
This time she would treat him as if he were her husband.
But he did not understand, and Gracepoint would go on to say that he could not understand why she was so tearful and wondered if she was too much used to being absent.
And yet she was really very beautiful ; she had told Bonnetta she could never forget that flower.
And there were the flowers ; there were the juicy bergies that had not yet rooted ; there were the cantaloupees, and those hanging out of the bergs as if they were hanging loose, quite loose, in the sunshine.
It was a beautiful sight, too.
More soldiers than ever were assembled in the flowery meadow at the south and near the stables ; there was a splendid show of grass and blooming flowers, and on the eaves hung a splendid arbour of lilacs and narcissines, with a great tulip in the centre.
Everything about the place made her feel happy.
And then, so far, all the soldiers had gone, and the lady 's arm was free, and the arbour was down, and the ladies in lavender and navy and with golden hair joined the fray as they had always done.
It was a splendid show, and the ladies all over the castle were in attendance ; and the general liked it, and said that they had never seen anything like it .'
I call that a rather brave prospect, ' he said to his wife.
` Shall I see the grand nest XXXXX the flower ? '	in		For|along|at|by|in|inside|since|than|that|to|with
He could just see all the pretty little flowers and the fruit and the cream and the little frosted flakes in the branches.
And that little white flower, with that border of creamy petals just over its borders, hung down towards the top of the flower.
There and all round the ground, where the sap fell, were the sweetest strawberries.
There were some trampled roses and some chrysanthemums, and all the others were as empty as a garden casket.
But there were some lemons on the wind.
And there were some big and not very pretty looking anthills with some clawed honey under the hood.
There were also a few battered butchers '  and a lad in a dhows of playing-clogs at the next table.
There was also a packet of perfumed leaves and copal, and a big basket of custard and a jug of punch, and-- oh, it was horrid ! ''
`` But it does not matter that was not there, '' cried the troop-horse.
`` We are all together now, '' said the lorry-driver from the road, `` and that is a splendid thing ! ''
`` I have only got one horse, and it is broken ! ''
said the camel.
`` That is a good thing ! ''
said the troop-horse.
`` I will help you back then ! ''
And they went.
In the evening, as they went by the gate, Alex noticed a pale young man coming towards them : he was not XXXXX his right colour, and he did not look like a soldier either .	at		around|at|in|like|nearer|of|till|to|with
And so he rejoiced, and hid himself among the trees, and he saw the beautiful bird swooping down upon the earth.
And the dove say, `` Well, look what you have brought me back ! ''
And the hunter said, `` A cheese-wich of the most delicious things which have happened to me ; taste how great this

[11450 | 2517.11] loss=0.21 avg=0.29
[11500 | 2601.00] loss=0.11 avg=0.28
[11550 | 2684.80] loss=0.27 avg=0.28
[11600 | 2768.16] loss=0.15 avg=0.27
[11650 | 2851.66] loss=0.15 avg=0.27
[11700 | 2935.15] loss=0.10 avg=0.26
[11750 | 3018.67] loss=0.43 avg=0.27
[11800 | 3102.28] loss=0.11 avg=0.26
[11850 | 3185.82] loss=0.11 avg=0.26
[11900 | 3269.32] loss=0.08 avg=0.25
[11950 | 3352.87] loss=0.16 avg=0.25
[12000 | 3436.58] loss=0.17 avg=0.25
Saving checkpoint/run1/model-12000


*********************************************************
*********************************************************

							File 5: cbtest_P_valid_2000ex_OUT.txt    (4.5 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-8000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-8000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.94s/it]
dataset has 1121806 tokens
Training...
Saving checkpoint/run1/model-8000
Saving checkpoint/run1/model-8000
[8050 | 126.77] loss=0.27 avg=0.27
[8100 | 209.87] loss=1.30 avg=0.79
[8150 | 293.07] loss=0.51 avg=0.69
[8200 | 376.24] loss=0.17 avg=0.56
[8250 | 459.36] loss=0.70 avg=0.59
[8300 | 542.62] loss=0.22 avg=0.53
[8350 | 625.78] loss=0.21 avg=0.48
[8400 | 708.81] loss=0.24 avg=0.45
[8450 | 791.83] loss=0.15 avg=0.41
[8500 | 874.84] loss=0.24 avg=0.40
[8550 | 957.77] loss=0.20 avg=0.38
======== SAMPLE 1 ========
 present!
But I had put on my jacket, and it would not have been right to put it on while I was taking my leave of the prince.
By the way, this castle is not XXXXX it !	that		In|I|by|from|for|over|through|towards|while|with
`` We do not know much about Thea 's witchcraft, '' said the Story Girl decidedly.
`` I do not believe we need any more talk about her, '' said Felicity, with the calmness of darkness.
`` I would not talk about her -LRB- just about her, '' retorted Dan.
`` I would talk about Bill, if I could get anybody to listen, '' said Cecily, with the deadly earnestness of an earnest young friend.
`` You should mention him to me, '' wrote Sara Ray.
`` You wo n't forget him any more than Eliza ever did ! ''
`` I hope not ! ''
said the Story Girl vaguely.
None of us ever forgot this irrelevance, any more than we let Belle Victoire blurt it out.
`` I want to talk to Father, '' said Felicity crossly.
`` You may sit over there, if you wish, '' said Cecily, followed by a look of extreme displeasure at the prospect of our sitting there.
`` You do not know what that means, '' said Peter, somewhat mystified.
`` I do not feel like talking about lost husbands, '' said Felicity crossly, and the Story Girl silently left our circle of firewoodless innas, drawing a deep breath of relief when she saw our hands reaching the kitchen, and Felicity return without even a word.
`` That poor girl ! ''
exclaimed Dan.
`` She cannot blame us for doing bad things to her.
The girls were mad at us last night and it am not right to come in to quarrel.
But she must tell the whole truth, or we wo n't believe her . ''
`` She said last night she had a brother and he died young and queer and queer -- '' `` She said too, '' said the Story Girl patiently.
`` I cannot always feel bad for things that are not natural, but I never can look good for the love of the world, '' said Felicity crossly.
`` You ought to talk sense ! ''
said Dan, storming XXXXX the kitchen in a huff .	to		As|If|OF|before|among|at|by|if|that|upon|with
You are a clever young man, '' said Felicity gently.
`` No doubt you are, '' said Peter, rather resentfully.
`` You need not be so hard-hearted.
I have read a whole chapter of your letter over twice and come away satisfied.
Yours most cordially, AGNES CLARK LESLEY.
`` Well, I would not go straight to your letter and leave it there, '' suggested Dan.
`` There is not anything in it that I could not understand, '' said Felicity with dignity.
`` There is lots of things you would not understand, '' said Peter, rather gloomily.
`` I cannot understand them myself, '' accosted Felix.
`` It is impossible to be so hopelessly hard-hearted without understanding something of the world, '' declared Dan.
`` The writer himself was once so hard-hearted.
He wrote a whole chapter in a book about his sister and her dreams about a witch and the three baby Chucks, and about a dog and the blind horse, '' said Felicity.
`` I would like to read them, but I am afraid it will spoil everything, '' said Cecily, rather incredulously.
`` The main thing is, what was the witch doing in the straw shed ? ''
`` Hush, '' whispered Cecily, to a startled silence.
`` The witch was making a bed -- a hard, stiff, mossy bed.
She was laying down some kind of rug.
The rabbit did not care at all about that.
Let us move further down.
There is a kind of roof over that part and a window in the middle.
I think we will sleep in that . ''
`` You ought to sleep on something, '' said Felicity.
`` And if the window were not bolted, you could not go inside, dear . ''
The boys dismounted and cleared away a few stray Chucks, avoiding their eyes and noses.
`` You do not know all that the world can teach you, '' XXXXX we were all learning, one after the other .	said		about|at|for|in|into|that|though|under|within|whether
But when he was seventy-five he said to his wife, ' I refuse to marry unless I can find a

[8600 | 1066.08] loss=0.25 avg=0.37
[8650 | 1150.02] loss=0.38 avg=0.37
[8700 | 1233.94] loss=0.35 avg=0.37
[8750 | 1317.92] loss=0.20 avg=0.35
[8800 | 1401.85] loss=0.18 avg=0.34
[8850 | 1485.59] loss=0.14 avg=0.33
[8900 | 1569.22] loss=0.13 avg=0.32
[8950 | 1652.84] loss=0.24 avg=0.31
[9000 | 1736.50] loss=0.13 avg=0.30
Saving checkpoint/run1/model-9000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[9050 | 1827.74] loss=0.13 avg=0.29
[9100 | 1911.51] loss=0.09 avg=0.28
[9150 | 1995.03] loss=0.25 avg=0.28
[9200 | 2078.66] loss=0.26 avg=0.28
[9250 | 2162.34] loss=0.14 avg=0.27
[9300 | 2246.24] loss=0.11 avg=0.27
[9350 | 2330.13] loss=0.22 avg=0.26
[9400 | 2413.93] loss=0.16 avg=0.26
[9450 | 2497.79] loss=0.08 avg=0.25
[9500 | 2581.51] loss=0.19 avg=0.25
======== SAMPLE 1 ========
 that when the ogre should be gone he would call forth the eagles as before and catch them.
But while he was discarding the hope the eagle said to him : ` As you have been so kind, I am now offered a golden crown, which, if you accept, will follow you wherever you go to.
Wait a few days, then return to me and I will bring you back either the golden or the sickle .'
Then the prince returned to the palace and told his father and the servants what had happened.
The ogre, who could see into his heart and knew how unhappy he was, made up his mind to send the prince off in a foreign country in order, so he said, to tease the prince and his friends.
So the prince accompanied the eagle as far as the sea, and then returned to the palace and told his father and the servants what had happened.
The prince said to him : ` Dear father, I want to go out into the world, and shall be accompanied by two guides, who will take me on their travels .'
The ogre, who felt himself at death 's door, said to him : ` Follow and I will think of you, and we will take you to some distant city that you will never be able to behold .'
The prince promised to return XXXXX a few days, and was just starting to go off in the direction of the city when he saw a little black pony coming towards him .	to		As|before|by|of|on|that|through|to|while|with
He knew who it was.
It was Shadow the Weasel.
`` Take that as a compliment, '' said Happy Jack, as he pretended to hunt for buried nuts while he waited for Tommy Tit to come to him.
CHAPTER XX.
ATTACK OF THE LAURELINGTONES TOMMY TIT had heard of all the weasel 's tricks, and then he had had the good luck to come across Beaver the Mousetop, and after a tough little fight they agreed to a marriage.
Beaver was a very good man, and as soon as Tommy Tit had made up his mind to put an end to Shadow the Weasel, he began to hunt for some other work to do.
To be sure, he never pretended to be lazy.
When people started out to do their work they were always like boys and girls.
You know they had something pressing on their minds and so they would rather work than play.
It was in this way that Tommy Tit had often led the way in getting up courage to speak to Happy Jack, and no more had he let it show when he had sprung into a huge passion.
Now Tommy knew just what Happy Jack 's secret was.
CHAPTER XXX.
THE LOVE STORY OF TOMMY TIT A wise philosopher is he Who takes things as they chance to be, And in them sees that which is best While trying to forget the rest.
Happy Jack.
Somehow Happy Jack 's past life had been spared, and he had brought these two precious gifts with him.
But though the Green Forest and the Green Meadows, over which he had trodden so many times, had never known the sorrow and pain that he had endured, they at once recognized and love him with all their hearts.
It was quite otherwise with Shadow the Weasel.
Sure, he had been a coward.
He had shown that in a moment he would be a true friend of Tommy Tit the parrot.
But now he was going to make up his mind that he really had to fight.
Yes, Sir, XXXXX the heart of the Green Forest was a fierce friend of Tommy Tit the parrot .	it		about|about|for|from|in|into|like|to|under|with
He loved Polly Chuck more than he knew what.
It was all thanks to Polly Chuck.
If there had not been a baby in thery, Polly Chuck would have been just as happy as the day he was born, and it was just because he had a funny way of thinking.
He did not understand the funny thing about the baby.
He thought the funny thing was that he had a funny way of relating to people.
One morning, as he sat with the wind blowing over his face, he thought of his dear Little Chuck, Amy.
How could he not relate to her?
He had not seen or heard of her for some years, and whenever he heard her voice and looked into her eyes it was always the same : `` Chuck, where are you ? ''
He had known and he had loved Polly Chuck, but he had never seen or heard her.
He wandered along the edge of the Green Meadows, looking for a place to spend the night, but there was not a place to spend a very cold night.
The first thing to happen was that Happy Jack began to feel frightened.
He

[9550 | 2688.01] loss=0.18 avg=0.25
[9600 | 2771.80] loss=0.19 avg=0.25
[9650 | 2855.52] loss=0.10 avg=0.24
[9700 | 2939.18] loss=0.10 avg=0.24
[9750 | 3022.93] loss=0.14 avg=0.23
[9800 | 3106.78] loss=0.14 avg=0.23
[9850 | 3190.50] loss=0.10 avg=0.23
[9900 | 3274.11] loss=0.07 avg=0.22
[9950 | 3357.76] loss=0.09 avg=0.22
[10000 | 3441.32] loss=0.29 avg=0.22
Saving checkpoint/run1/model-10000


*********************************************************
*********************************************************

							File 4: cbtest_V_test_2500ex_OUT.txt    (5.4 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-6000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-6000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:05<00:00,  5.93s/it]
dataset has 1376928 tokens
Training...
Saving checkpoint/run1/model-6000
Saving checkpoint/run1/model-6000
[6050 | 127.22] loss=0.47 avg=0.47
[6100 | 210.22] loss=1.09 avg=0.78
[6150 | 293.12] loss=0.89 avg=0.82
[6200 | 376.21] loss=0.32 avg=0.69
[6250 | 459.36] loss=0.53 avg=0.66
[6300 | 542.63] loss=0.50 avg=0.63
[6350 | 625.81] loss=0.53 avg=0.62
[6400 | 708.85] loss=0.42 avg=0.59
[6450 | 791.91] loss=0.51 avg=0.58
[6500 | 875.06] loss=0.98 avg=0.62
[6550 | 958.18] loss=0.27 avg=0.59
[6600 | 1041.44] loss=0.47 avg=0.58
[6650 | 1124.60] loss=0.23 avg=0.55
======== SAMPLE 1 ========
 lived and loved -- and no one ever knew why.
Then at last he thought one day it had to do with the old chest.
He had discovered that Old Mr. Toad was fond of it, and at once told Buster Bear what he wanted to do with it.
Back to Top
THE BUSHIES AND THE MYTH BULLOCKS A cub is best friends with his or her mother, and Little Toomai was that.
Smiling all the while, he was the happiest of cubs.
The dawn was breaking fast before the milk jig was torn in pieces.
Little Toomai went first for a short distance along the river bank, then a little farther, and then sat down and cried.
He did not really cry, but he had made up his mind that he would sit there forever and do nothing.
There was a little silence, and then a bullock cart happened by, loaded with heavy timber and rocks, and shouted angrily : `` Listen, cub!
What are you sitting there FOR?
You had better not crawl under that piece of bark a bit, or you will have your ears roasted . ''
Little Toomai heard the cart shout angrily, because it meant `` Cross that burning busher ; I will teach that man a lesson . ''
He suddenly groped his way through the wood where he had hidden his hidden milk jig, and made himself quite at home in the bush, as the bullocks cart bumped and nudged and nudged along the river bank.
The great deep, the hot thornbush, XXXXX hard into the shoulder -- and Little Toomai felt that he was safe there, very snug and snug indeed .	made		behold|began|called|gone|grew|hanging|hurried|making|sitting|tied|stretched
He was not a bad little sleeper, but he would not have been any harder to make.
So, despite his misgivings, he fell asleep with his guns by his side, and was sound asleep in a moment.
It was just before midnight when he heard the bullocks and the marines trumpeting in the distance.
He looked up, and there sat Snati with his gun on his shoulder, and there was the little dog, Kotick Tarzan -- Kotick, Kotick Tarzan!
Everyone says that the Indian cat looked upon Kotick as his father ; and indeed, as you know, he was the best friend of Father, and the very face, and the curly white mane, and the tiger 's mane, were worn by all Indians.
Everybody knew Totik as the best cat in the jungle.
No one said that he was not beautiful, but they lived in different days and years.
One day, when he was very sleepy, a great big gray cat called out to him, ` Friend, what are you dreaming about now ?'
` Pears!
Pears!
Come and make your peace with me .'
-LSB- Illustration : Totik the Jay -RSB- RESPONSE : ` SUMATI AND HADVOR -LRB- 25 -RRB- -LRB- 25 -RRB- From the Bukowinaer Tales and Legends.
Von Wliolocki.
There was once upon a time a man who had a fur cloak, which he wore on the outside and it was fastened round his neck, like a star.
He had spent eighteen years in the jungle, and when he was about to give up he fell ill, and in a few weeks he was walking through the forest, with his eyes being pecked out by wild beasts.
He had only eyes to scratch with, for he was too badly beaten, to move.
His master made him a present of all his possessions and then left him to think that he had made his fortune, when in reality he had only XXXXX his fur cloak and his head with which to scratch him .	earned		's|came|cut|kept|made|said|smiled|stamped|taunted|unwrap
` Good luck !'
went on the whole tribe at once ; and the fire was lighted up again, and a rush of joy filled the heart of all the birds which had fought with their lives for him.
` Now he is happy again !'
said all the tribe at once ; and they lined up to welcome the Frog.
But the voice of their leader cried out : ` You are a friend to me no longer, Young Man!
Why, you are a man!
You are no longer called The Masterless !'
` Call him that what you will, ' said the young man went on ; ' I know that my song has made my way, and even before that I had come to the shore of a hundred islands I knew that all is well

[6700 | 1233.22] loss=0.53 avg=0.55
[6750 | 1316.99] loss=0.51 avg=0.55
[6800 | 1400.54] loss=0.42 avg=0.54
[6850 | 1484.03] loss=0.82 avg=0.56
[6900 | 1567.57] loss=0.50 avg=0.55
[6950 | 1651.05] loss=0.54 avg=0.55
[7000 | 1734.66] loss=0.12 avg=0.53
Saving checkpoint/run1/model-7000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[7050 | 1825.24] loss=0.36 avg=0.52
[7100 | 1908.89] loss=0.23 avg=0.50
[7150 | 1992.33] loss=0.29 avg=0.49
[7200 | 2075.95] loss=0.53 avg=0.50
[7250 | 2159.57] loss=0.20 avg=0.48
[7300 | 2243.11] loss=0.23 avg=0.47
[7350 | 2326.72] loss=0.19 avg=0.46
[7400 | 2410.37] loss=0.29 avg=0.45
[7450 | 2494.02] loss=0.22 avg=0.44
[7500 | 2577.66] loss=0.20 avg=0.43
[7550 | 2661.09] loss=0.50 avg=0.44
[7600 | 2744.46] loss=0.45 avg=0.44
======== SAMPLE 1 ========
 to be afraid .'
` Ah!
If only I were stupid enough to say so !'
XXXXX the King .	said		's|Are|am|behold|called|give|made|said|talking|thinking
The Dormouse shook its head impatiently.
` Whoo!
He is safe, ' said they, and they ran back to the kitchen, where the White Duck tumbled about running to see what was the matter.
At last they found the dress, and, after they had washed it, hung it up in a rack.
In the evening the Dormouse went to the door and knocked.
` Wake up!
What are you doing here ?'
The White Duck answered, ` Bringing the dress to my aunt in order that she may take it off ; for I am going to the King 's Court with the Princess.
Do not be a fool, or you will be sorry .'
` What is the good of the dress, then ?'
said the Dormouse.
` Why, it is perfectly white, ' replied the Duck.
` Surely you cannot remove it !'
said the Dormouse.
` We will let her have it, ' replied the Duck.
The Dormouse stamped three times on the ground, and then half of the dressing had gone, and it was gone in less than no time.
` That is the end of the dressing !'
XXXXX the Dormouse, with a gurgle, and waited for the Princess .	said		Do|Let|Go|answered|brought|came|heard|live|nodded|said
`` What color is that ? ''
Mr. Toad grinned.
You see, it had just two eggs, one in each pocket, and he could see that it was coming to a boil.
And it was, as Peter could see by the way it strained each eye.
`` Whoo!
He is Argus all over ! ''
His friends had nicknamed him that after Peter had been frightened by Old Mr. Toad.
`` Guess again, or I will kill you ! ''
Old Mr. Toad chuckled again.
With every insect swallowed he felt better natured.
`` You have guessed it, Peter, '' said he.
`` Handy tongue, is not it ? ''
`` I think it is a very nice tongue, '' retorted Peter, `` and I do not believe you should ever let it go too far . ''
`` I will see to putting your tongue in its place ! ''
said Old Mr. Toad.
`` He will have such a good time with that ! ''
`` Tut tut, tut ! ''
Here came another storm of butterflies, and they told Peter wonderful tales of old time spent in the Smiling Pool.
Most of them were about Old Mr. Toad.
`` The most wonderful thing about Old Mr. Toad is that he does not have to look at all his friends, '' said Juanita.
Old Mr. Toad chuckled again.
With every insect swallowed he felt better natured.
`` Tut, tut ! ''
he said.
`` I feel just as well as I ever did when I was a butterfly . ''
`` You must remember that when you are all well it is always best not to bother anyone, '' XXXXX Peter .	said		's|came|cursed|feel|give|reminded|said|say|suffer
For instance, if you are very careful, you will not be betraying your guard.
And if you are careless, you will be cut down before you have time to spare .'
` Yes, I will come, ' said the Irishman ; but there was no answer from outside, and the cat 's roar sounded as if it would never have ceased if the Irishman had only closed his eyes tightly.
` You are well taught to keep your distance, ' said the footman ; ` but a blow more or less will cut off your head, and then you are out of the question .'
` I will not give up on the chase, ' said Old Mr. Toad, and he fluttered through the air on to the bank of the pond where the Fox was trying to get a good hold on his tail.
` He is trying to bind me, ' said the Fox, and its tail began to swell suddenly, and with a cry like a drowned fish.
All at once the rabbit was beside him, looking at the dead mouse, and sniffing.
` Perhaps you will catch it, ' said the Fox ; and the very idea of that surprised the Mouse, for his teeth were pressed so close to its sides, that he could scarcely breathe.
` Who are YOU ?'
said the Rabblerocket, who had been anxiously looking up at the Fox.


[7650 | 2850.65] loss=0.34 avg=0.43
[7700 | 2934.13] loss=0.17 avg=0.42
[7750 | 3017.55] loss=0.56 avg=0.43
[7800 | 3100.96] loss=0.22 avg=0.42
[7850 | 3184.31] loss=0.24 avg=0.42
[7900 | 3267.87] loss=0.24 avg=0.41
[7950 | 3351.37] loss=0.25 avg=0.41
[8000 | 3435.05] loss=0.20 avg=0.40
Saving checkpoint/run1/model-8000


*********************************************************
*********************************************************

							File 3: cbtest_V_valid_2000ex_OUT.txt    (4.3 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-4000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-4000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:04<00:00,  4.57s/it]
dataset has 1081880 tokens
Training...
Saving checkpoint/run1/model-4000
Saving checkpoint/run1/model-4000
[4050 | 123.70] loss=1.38 avg=1.38
[4100 | 206.78] loss=1.12 avg=1.25
[4150 | 289.75] loss=0.76 avg=1.08
[4200 | 372.93] loss=0.78 avg=1.01
[4250 | 456.07] loss=0.81 avg=0.96
[4300 | 539.17] loss=0.45 avg=0.88
[4350 | 622.15] loss=0.31 avg=0.79
[4400 | 705.03] loss=0.50 avg=0.76
[4450 | 787.90] loss=0.61 avg=0.74
[4500 | 871.05] loss=0.72 avg=0.74
[4550 | 954.22] loss=0.49 avg=0.71
[4600 | 1037.34] loss=0.37 avg=0.68
[4650 | 1120.51] loss=0.30 avg=0.65
[4700 | 1203.38] loss=0.26 avg=0.62
[4750 | 1286.44] loss=0.60 avg=0.62
======== SAMPLE 1 ========


Then the servant girl told him : ` You must get me out of this miserable place, and at least put me on a bed, and let me recline on my bed and feel the wool under my feet, and the rattling of the cask in the oven .'
` That is easy enough, ' said the sparrow ; ` so be quick, because my rusks are getting cold .'
But the prince did as he was told, and soon returned, bringing with him peppermint lozenges and a map of the world.
` Not knowing when he should give the snake the bone, he XXXXX up the steps .	fled		came|call|fell|got|remained|reclining|seek|sleep|slept|told
But the wolf 's flesh, when it has once was digested, remains purer than the mother 's blood.
So the wolf 's flesh, when it has been put in the oven to harden, remains purer than milk or water.
And the wolf 's flesh which has not yet been changed into the liquid which Janni drank is purer still.
When the liquid which Janni drank from the brook reaches the mill, it becomes harder than steel.
The youngest sister, determined not to drink the poison, cries out : ` Let me be sure to say `` That is not Janni, '' when they meet again .'
` Yes, you shall, ' replied the ogre.
` He is a stranger, and has no right over you.
Bring him here and let him stay with you.
I will put him in the iron pot, and the youngest girl will bake the bread.
She will then be a nun, and will be ordered to clean the water .'
The younger sister took the water and ran to the mill, and blew on the mill-wheel till the water flowed, and then bathed her face and hands.
She took the lobster and prepared the bread, and when the ogre came back, the lobster was perfectly clean.
The ogre said : ` Here is the lobster, pure and simple .'
And the sister said : ` What an ugly thing !'
Then she went and made the soup.
The ogre added : ` You must now hide yourself in the small cupboard .'
She went out and hid himself, and when the ogre came back, the lobster was there.
The eldest sister made the soup, and when she saw the lobster lying on the ground, she said to him : ` Oh, monster, would you like to eat me ?'
He said : ' I will gladly do so if you will take this little bag, which contains peppermint jelly .'
The wretched sister did as she was told, and when the ogre came back, the lobster was there.
The second sister did not dare to leave the room, and when the ogre came back, the lobster was there.
The third sister did not dare to come to the room, and when the ogre came back, the lobster was there.
So she threw the bag of peppermint jelly to the dog, who at once ran away.
The ox was then sent for, and the daughter-in-law saw him, and said to her : ` Will you give me the lobster again ?'
` Certainly I shall, ' said the daughter-in-law.
` And this bag of pot-pourri, of course.
It contains an awful sauce made by the Lobster .'
So the daughter-in-law took the lobster from the sea, put it in the oven, and left the room.
When the ogre came back, the lobster was there, and when she threw the bag of peppermint jelly to the dog, he sniffed it and said, ` Oh!
what an ugly sight !'
The daughter-in-law asked him : ` But why ?'
He answered : ` Because, when I returned, my mother was hiding in the oven .'
` So she hid herself, ' said the daughter-in-law.
` And why did you hide her ?'
asked the ox.
` Because, ' XXXXX the ox, ` it was too much trouble to send her back .	said		's|'|asked|eat|hide|know|look|put|seemed
`` Do you hear me?
Spoke too of the wind and the rain . ''
`` What of it?
Well, it is the rain coming down, and -- '' `` The wind will sing to get the hail off . '' '' ''
`` Hail, hail, he is there, and the sleigh is a funeral pyre ! ''
`` Well, it is embarrasing, '' but one may not be indifferent.
`` You ought to know, '' says Peter.
`` I met Lem

[4800 | 1394.66] loss=0.35 avg=0.60
[4850 | 1478.20] loss=0.36 avg=0.59
[4900 | 1561.58] loss=0.54 avg=0.58
[4950 | 1645.22] loss=0.17 avg=0.56
[5000 | 1728.81] loss=0.37 avg=0.55
Saving checkpoint/run1/model-5000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[5050 | 1819.43] loss=0.18 avg=0.53
[5100 | 1903.00] loss=0.31 avg=0.52
[5150 | 1986.82] loss=0.21 avg=0.50
[5200 | 2070.49] loss=0.56 avg=0.51
[5250 | 2154.04] loss=0.33 avg=0.50
[5300 | 2237.51] loss=0.22 avg=0.49
[5350 | 2321.02] loss=0.25 avg=0.48
[5400 | 2404.60] loss=0.15 avg=0.46
[5450 | 2488.01] loss=0.20 avg=0.45
[5500 | 2571.37] loss=0.34 avg=0.45
[5550 | 2654.69] loss=0.27 avg=0.44
[5600 | 2738.17] loss=0.19 avg=0.43
[5650 | 2821.78] loss=0.23 avg=0.42
[5700 | 2905.40] loss=0.25 avg=0.42
======== SAMPLE 1 ========
 Shadow.
By-and-by the old woman had a child, and the next day the old woman cried out : ` And I know now why you have put that stone in the water .'
And the man answered : ` Did I not warn you never to throw stones ?'
` Yes, old man, ` every day we were together, and she threw them in the water .'
And the old woman answered : ` Well, what do you suppose they are now doing ?'
` They are making a little spring, ' answered the man.
` The spring is full of water, and the baby is going to swim out of it .'
-LSB- Illustration : THE SPRING AND THE SIMPLETON -RSB- ` That is the way it is done, ' said she ; ` but the husband dislikes to XXXXX after all . '	see		disappeared|disappeared|go|replied|see|see|see|see|swim|throw|think
Suddenly she found herself in the arms of a lover whom she loved in the almost superhuman Benjamin Reid.
He stood stiffly erect in the air, with his eyes shut, while the strokes of a sickle cut deep into his side.
She drew him up and laid the blame for his disfigurement on his guru, Gautama.
Gautama listened with awe to the story, and then kissed him a thousand times, loudly and devoutly.
When the story was repeated to the king, he believed it, and was gratified to find his two sons longing for their father.
The king had a large and beautiful wife, but he loved his daughter, his sons far more than his wife, and he was anxious that she should receive them all safely.
Then old Whitetail came to the king, and told him of his own grief at having no sons, and the king 's joy at having a daughter whom he loved.
Gautama then begged of the king the smallpox, and on his part the king granted the request, adding some turkeys to the mutton and some rusks to the ram.
And the evening of their marriage, the king and his wife, dressed in purple, mounted the sheep, and set out for their home beyond the walls of Dschemila 's palace.
They never took the wedding procession past the walls, though they had been married to each other for seventeen years, and were now the walls of their lives.
All day long they lived happily, and when the day of the funeral pyre fell the king and his wife were filled with grief, and sat on the tops of their heads in state.
But Gautama rose early and went out to hunt with his dogs, and returned home promising to bring back his bride, who was waiting for him.
And the young couple, as they were mounted on the ass, rode slowly homeward through the air, till they reached the place where the white wolf was wont to hunt.
And the king shouted to his sons, ` The ass is here ; it must be killed .'
But the little dogs XXXXX no more than they had done that morning, and hardly were their footsteps heard than a rushing noise drew them back instantaneously .	gave		answered|cried|go|gave|gone|ride|say|seen|towards
`` Well, do not mix up talk about cats with talk about girls, '' retorted Felicity.
`` It is not called mixing up talk about cats at all, '' wrote Sara Ray loyally.
`` It is not any different from talk about boys and girls in church, '' said Felicity.
`` I am not going right away, '' wrote Peter.
`` Not till the last of October.
So I guess we might as well get up newspaper clippings and greeting cards for our moths and fishes, '' suggested the Story Girl.
`` I like colouring, but it is not my strong suit, '' said Cecily.
`` You girls can do it, '' said Felicity.
`` We can do the boys, '' said Dan.
`` Well, we boys have other things to think about, '' said Peter.
`` About -LRB- for f-fishes, which are mingled in with the other things I said -- what colour is your back page ? ''
`` Mine is blue, '' said Peter.
`` I have the same page as Felicity, '' said the Story Girl, with the greatest possible ease.
`` Why, it is just your colour, '' said Felicity.
`` I XXXXX you ladies are dull ! ''	am		am|determined|dying|go|guess|look|named|mix|said|says
But the young man 's excitement soon put him in a bad humour, and

[5750 | 3011.15] loss=0.27 avg=0.41
[5800 | 3094.55] loss=0.23 avg=0.41
[5850 | 3178.17] loss=0.35 avg=0.41
[5900 | 3261.70] loss=0.32 avg=0.40
[5950 | 3345.03] loss=0.18 avg=0.40
[6000 | 3428.59] loss=0.36 avg=0.40
Saving checkpoint/run1/model-6000


*********************************************************
*********************************************************

							File 2: cbt_test_OUT.txt    (1.5 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='latest', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              overwrite=True,
              run_name='run1',
              print_every=50,
              sample_every=950,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint checkpoint/run1/model-2000
INFO:tensorflow:Restoring parameters from checkpoint/run1/model-2000
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:01<00:00,  1.86s/it]
dataset has 373907 tokens
Training...
Saving checkpoint/run1/model-2000
Saving checkpoint/run1/model-2000
[2050 | 130.00] loss=2.62 avg=2.62
[2100 | 212.89] loss=3.16 avg=2.89
[2150 | 295.81] loss=3.26 avg=3.01
[2200 | 378.76] loss=2.60 avg=2.91
[2250 | 461.99] loss=2.00 avg=2.72
[2300 | 545.12] loss=1.61 avg=2.53
[2350 | 628.21] loss=2.07 avg=2.46
[2400 | 711.24] loss=2.44 avg=2.46
[2450 | 794.24] loss=2.18 avg=2.43
[2500 | 877.49] loss=1.99 avg=2.38
[2550 | 960.41] loss=1.90 avg=2.34
[2600 | 1043.41] loss=2.07 avg=2.31
[2650 | 1126.43] loss=1.03 avg=2.21
[2700 | 1209.37] loss=2.08 avg=2.20
[2750 | 1292.29] loss=0.47 avg=2.08
[2800 | 1375.52] loss=1.59 avg=2.04
[2850 | 1458.60] loss=2.54 avg=2.07
======== SAMPLE 1 ========
 in the end of them, as he had a great deal of them.
For the first few days after his being put into the sack the poor brute went on wandering about, and did not seem to mind where he was going, though he was not very hungry.
However, as he got to the town he noticed a very fine horse-trap lying near him, so that he stopped and hurried to look it over.
They said it was a nice one, and for four-and-twenty hours he was able to get enough meals to keep him alive.
At last the King took notice of the poor creature, and put him on a gallop, so that he could get to the market-place.
And a little later some one came along on one side of the road, and drove past the horse-trap, and said, ` I do not care what you are like, for I will take you up .'
So he gave him a horse just worth seeing.
Then the King took him up in the sack and shut it in the horse-trap ; but after that, all that could be left was to put a big stone in the animal 's mouth, and then to drive him away.
The King did all these things for him, and the poor brute at last got some food into his mouth, so that he was able to pull himself into a sack, and then took leave of his friends ; and the King said, ` Now you may die, old beast ; you are the happiest of men.
Go and sit still, and do nothing foolish .'
So he got up and took his sword ; but he put the poison into his eye, and then he tried to fly like a bird, and to come back again in the same way.
So he took leave of his friends, and the King put a great rock in the bottom of the sack, and then he tried to get past the rock, but he was not able to get past it, and he sank into the bottom.
Then he saw some one sitting there a good way off, looking after him, and he took notice of this, and he said to the King, ` Now you will find that I did not kill you, but it is good to be dead in the end .'
At these words the King fell instantly in love, and said to his son-in-law, ` You must now set to work and toil on a great work of gold, for as you have proved I shall, and will have you one day a splendid kingdom under my own dominion .'
Then the King saw that the young man was a mighty powerful King in his own right, and said to him, ` You must now prepare for war, and when you have thoroughly mastered your sword, you may stand on your feet and look to me for anointing, which I shall grant you .'
The young man accepted the King 's offer gratefully, and fought bravely in the ring, for in a short time he had acquired a long sword of enormous hardness, to use against the King ; but the King was so terrified at this that it was quite useless, and he fell on his knees at the feet of the Prince of the Air.
Then he wrapped his horse round the beast 's neck, and turned him into a bird ; but while the youth was still kneeling on the ground he heard a high, mighty voice in the black air above the rider, which said, ` You only need to watch my youth, and when the King comes you will see a throng of thousands of people who never knew that there had ever been such a Prince.
And the Prince was so frightened that he came near the King and lifted him high up in the air, and then dropped down into the depths of the deep ; whilst he went on to a certain island, on which a beautiful Princess was dancing with another beautiful Prince.
And the Princess herself flew into the air above, and when she saw the Prince she called him to her, and said, ` There is now nothing for the King to do.
He has now lost his head, and shall settle down into his royal purple and gold.
The Prince of the Air should now repeat these words to you, for by their magic we have all but destroyed the Prince of the Fire ; but we still believe in him, and will go with you when you come to our world, and you must fly quickly to the nearest village and demand possession of this Princess.
The King 's fury now grew, and, with the wind howling, clouds of smoke rose, representing the King himself, who had taken the lead.
Then the Prince of the Fire called out to his companions, ` We can not reach the Princess until we scatter this great forest.
We have now lost the Princess, and we shall never reach the Prince of the Water till we have scattered her in all our flight .'
Now at this the Prince of the Air became

[2900 | 1567.83] loss=0.60 avg=1.99
[2950 | 1651.42] loss=1.36 avg=1.95
[3000 | 1735.10] loss=3.09 avg=2.01
Saving checkpoint/run1/model-3000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
[3050 | 1825.88] loss=1.24 avg=1.97
[3100 | 1909.74] loss=1.74 avg=1.96
[3150 | 1993.39] loss=1.51 avg=1.94
[3200 | 2076.94] loss=0.52 avg=1.87
[3250 | 2160.40] loss=1.39 avg=1.85
[3300 | 2244.23] loss=0.53 avg=1.79
[3350 | 2327.93] loss=0.84 avg=1.75
[3400 | 2411.53] loss=0.88 avg=1.72
[3450 | 2494.96] loss=0.35 avg=1.66
[3500 | 2578.43] loss=0.35 avg=1.61
[3550 | 2662.09] loss=0.47 avg=1.57
[3600 | 2745.65] loss=0.39 avg=1.53
[3650 | 2829.68] loss=1.09 avg=1.51
[3700 | 2913.31] loss=0.23 avg=1.47
[3750 | 2996.90] loss=0.40 avg=1.43
[3800 | 3080.67] loss=0.43 avg=1.40
======== SAMPLE 1 ========
 out of the way.
I am getting old.
The world will soon tire me out, if I keep on doing this.
When men are men, I am Queen bee!
Tell the wisest of men to tell the wisest of Queen bee!
The Queen bee knows how the world ends.
The wisest of Queen bees knows how the end of a campaign begins.
When Queen bee speaks, then there comes of old time.
I am older than you are.
I have watched the fight between the wisest of men and the Queen bee.
I saw the crunching of scales and the lifting of tusks . ''
The dark blue eyes twinkle.
`` You came to Queen bee after a good fight, my boy?
You came to find her asleep, and you found her prettiest woman on earth.
Well, she danced best, and made up all the rules for you . ''
The boy stirs to his feet.
The tears sting his eyes.
`` May you never see the beautiful dance again ! ''
he moans.
The queen bee twitches once and plays with her white abdomen.
The boy 's eyes are full of the pride of a king.
`` I will never forget that night myself when I woke up in the middle of the night to find the dance going on again.
I danced for the son of the King of the House that night, and I gave him a glass of milk -- just thinking of that!
The dance was over and it was still night, and I could not sleep.
Even as Tom 's boy was dancing the whole House was singing, and there was not a man in the whole place except me.
How I wished I could come and order a State dinner for Tom 's boy and the boy 's mother, or a good place for all the bees in the garden ! ''
To talk of the State dinners for kings and queens was very new to the Queen.
She had never heard of them.
`` But I will give you an old State dinner, '' said the King.
`` It is a great delicacy, '' said the Queen.
The King smiled at this.
There were murmurs of agreement.
The King and the Queen were about to eat their dinner.
The boy shook his head.
`` I would never understand that sort of thing any more than I ever did it, '' he said.
`` All I can do is to make you a State dinner now, or I have nothing to do.
It is your pleasure, my dear . ''
The King had a long table to fall back on as well as a chair, so that it was easy to get out.
The Queen sat down with a pen in her hand.
There were others present, but the Queen alone had brought out the writing implements.
There were rolls of film on the King 's table, and pictures of all the Queen 's children on the Queen 's knees.
The King could not have chosen a dull day for his wedding reception, for he was sure to have some kind of a favourite.
Some of the courtiers and the court birds talked of the newly married Queen.
Many of them said that she was a mere worm, or a detested soul ; others said she was more beautiful than a dove, and was going to be -- she was a fatality.
No one dared hint that they might disapprove of the nuptial wedding.
`` It is just the Queen who is a nuisance, '' said one of the courtiers.
The Queen was alone.
The laughter within broke in pieces.
The King and the Queen had hardly spoken when they sat down and had their wedding entertainment.
In the Queen 's dressing-room there was a box of scarlet woolen stockings, a beauty parlor and a fine array of knick-knacks.
In the dressing-room there were also a good many rolls of film.
In the Queen 's study was a silver casket containing a red silk dressing-rapier, a red silk dressing-rope, a red silk dressing-pin, and a pair of tiny white kid gloves.
In the King 's study was also a fine dinner set and a glass of port.
In the kitchen there was also a golden pewter cooking-pot, a great cauldron with an embroidered handle, and an iron cauldron with brass handles.
In the dining-room there was also a magnificent silver and bronze dinner tray with racks and plates.
In the nursery there were also six pairs of tiny slippers that belonged to the little boy.
In the same cauldron was a large silver cauldron full of red pyre flowers and a silver pitcher containing half a dozen red roses.
On the top of the cauldron was a brass baking-pot with a brass ring on each side and a

[3850 | 3186.95] loss=0.61 avg=1.37
[3900 | 3270.41] loss=0.46 avg=1.34
[3950 | 3354.06] loss=0.18 avg=1.31
[4000 | 3437.84] loss=0.33 avg=1.28
Saving checkpoint/run1/model-4000

*********************************************************
*********************************************************

							File 1: cbt_valid_OUT.txt    (1.2 mb)

gpt2.finetune(sess,
              dataset=file_name,
              model_name='355M',
              steps=2000,
              restore_from='fresh', # fresh to start from baseline GTP-2 , else latest to restarting training from existing checkpoint
              run_name='run1',
              print_every=50,
              sample_every=975,
              save_every=1000
              )

WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/sample.py:17: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /usr/local/lib/python3.6/dist-packages/gpt_2_simple/src/memory_saving_gradients.py:62: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Loading checkpoint models/355M/model.ckpt
INFO:tensorflow:Restoring parameters from models/355M/model.ckpt
  0%|          | 0/1 [00:00<?, ?it/s]Loading dataset...
100%|██████████| 1/1 [00:01<00:00,  1.62s/it]
dataset has 288319 tokens
Training...
[50 | 91.06] loss=3.10 avg=3.10
[100 | 174.45] loss=2.46 avg=2.78
[150 | 257.77] loss=2.92 avg=2.82
[200 | 341.09] loss=2.17 avg=2.66
[250 | 424.54] loss=1.67 avg=2.46
[300 | 508.05] loss=1.58 avg=2.31
[350 | 591.78] loss=2.11 avg=2.28
[400 | 675.58] loss=2.49 avg=2.30
[450 | 759.17] loss=2.47 avg=2.32
[500 | 842.90] loss=1.72 avg=2.26
[550 | 926.69] loss=2.02 avg=2.24
[600 | 1010.51] loss=1.58 avg=2.18
[650 | 1093.96] loss=1.30 avg=2.11
[700 | 1177.66] loss=2.32 avg=2.12
[750 | 1261.46] loss=0.44 avg=2.00
[800 | 1345.17] loss=1.32 avg=1.96
[850 | 1428.76] loss=0.66 avg=1.88
[900 | 1512.66] loss=1.12 avg=1.83
[950 | 1596.31] loss=0.96 avg=1.78
======== SAMPLE 1 ========
, and there were only half-open doors and a few hunky little things about to be picked over.
We were in for a real treat.
`` We did get two things inside, '' said Felicity, when we reached the house.
`` Mrs. Dibble got us plenty to eat.
She told us she would call us when she was ready, but she is so busy she can't come off at half-past twelve . ''
`` That is so -- awful ! ''
said Dan.
`` I will never think of that.
Mrs. Dibble was not a real doll, and I would never have guessed that she was.
It was very mysterious . ''
`` But you need not explain it, '' said Felicity sagely.
`` You are not bound to.
Mrs. Dibble did not mean to be the one to call.
But it is real dreadful.
I am sure I will cry all night . ''
`` Let us go have a cry, '' I said.
`` It will be better than all the rest . ''
The Dibble girls came with us and sat down on the far side of the long, long staircase.
They did not seem to mind us to be quite so inconsiderate.
Felicity sat on the step just below the counter, looking very miserable.
`` We just hate to think of going to bed, anyhow, '' she muttered.
`` We have had so much good cheer lately.
But it is all gone now and we have no idea where we are . ''
`` We cannot just go down and sleep anywhere, '' moaned Felicity.
`` We need a place to sleep.
We cannot just lay here and watch and wait . ''
`` You could save your kind, '' said Dan.
`` You know I have cut all the tall hickory trees down here . ''
`` I would not trust to anybody but you and Bill and Felix, '' muttered Felicity.
`` I am sure I will make a mistake when I start . ''
We put some acorns in a basket of hay and then put the basket on the ground and leave it there.
We do not even notice that our hands are tied.
We just leave the basket there and think nothing of it.
It is a most miserable thing to do.
But we are thankful that we are not human beings.
And now that he is a chicken, he does not mind us much and so there we are.
I had better go and get my supper and get dressed.
Do not mind me.
I do not know what I am to do.
I am just going to stick my head in.
And maybe I will find my way out of this trap . ''
But before I tied my hands behind my back I felt so terribly frightened.
How could I discover the trap?
I tried to move about as if I were very well.
I sat up and tried to think, as if I was trying to think of how I could get out.
And then I began to cry, and I was so terribly frightened that I made a dreadful face.
I was sure I would have to look and make a terrible face, and my hands started shaking.
I was so frightened that I did not even see the humor in it.
If I had seen the joke I would have laughed -- and it is so funny to laugh with terror when you have nothing to be afraid of . ''
Then I tried to laugh with a sad face, and tried very hard not to let on that I was sad.
I would look at my hands and see that they were tied tight, and then I would chuckle and a moment later my eyes would be wide shut.
I did not dare to lift my eyes.
Even Felicity looked as if she were afraid to smile.
She lifted her eyes very slowly and thought they were going to roll back.
`` Did I mention that I am a chicken?
I do not care what you do, '' said she.
`` You are just as safe with me as you are with you and the Dibble boys.
You have been so careful with me to make sure I do not do anything that would make you unhappy.
Do not worry about it -- just be glad you are with me . ''
I was so relieved that we were all happy again.
A little while later I started to cry again.
It was so hard to hold still that I did not know where I was.
I was so afraid of being late for school that I did not even know how to write down my thoughts.
It was so hard to be still and not be able to think any more about what I had just said.
I had forgotten how funny it was when Felix put his head in my basket and looked in.
And then I remembered the funny story.
About an hour before we went to

[1000 | 1705.22] loss=0.53 avg=1.71
Saving checkpoint/run1/model-1000
[1050 | 1796.24] loss=0.98 avg=1.67
[1100 | 1879.34] loss=1.48 avg=1.66
[1150 | 1962.41] loss=0.16 avg=1.59
[1200 | 2045.74] loss=0.45 avg=1.54
[1250 | 2128.77] loss=0.36 avg=1.48
[1300 | 2211.79] loss=0.62 avg=1.45
[1350 | 2294.69] loss=0.29 avg=1.40
[1400 | 2377.52] loss=0.72 avg=1.37
[1450 | 2460.51] loss=0.63 avg=1.34
[1500 | 2543.69] loss=1.10 avg=1.33
[1550 | 2626.77] loss=0.53 avg=1.30
[1600 | 2709.83] loss=0.24 avg=1.26
[1650 | 2792.95] loss=0.62 avg=1.24
[1700 | 2875.93] loss=0.25 avg=1.21
[1750 | 2958.81] loss=0.14 avg=1.17
[1800 | 3041.95] loss=0.05 avg=1.13
[1850 | 3124.90] loss=0.31 avg=1.11
[1900 | 3207.78] loss=0.29 avg=1.08
[1950 | 3290.74] loss=0.24 avg=1.05
======== SAMPLE 1 ========
 down.
And the same holds for the women.
When a man has a long red head, a baby is he.
If he is a son of the bull, it is he.
If he is a daughter of the bull, it is she.
But who shall be our mother ?'
` Let it be the bull or the lamb, for I am the son of your bull !'
screamed the girl, and ran screaming to the lamb.
` Oh, kick the lamb, ' screamed she.
` It is feeding time, and the lamb is dying !'
` Let the lamb go on dying, ' said the bull.
But the lamb went on dead, and when the bull came to say, ` Kill the lamb, for I am the son of your lamb !'
` But it is useless !'
said the lamb.
` Because it has already killed the bull, you have only yourself to blame for its being hungry.
Come with me now, and you will find the most beautiful lamb !'
` Alas, ' said the girl, ` this is the lamb which everybody loves, but who can find her ?'
` Oh, you shall say to him, ` Who can find her ? ''
I , ' answered the bull, ` have done so ; and you shall regret it .'
` Then say to him, ' I will give you the most beautiful lamb which ever was seen in the world, which never was fed anywhere, except in the arms of bulls, and which never opened its mouth to speak to any living creature, save cows, goats, sheep, cattle, or birds, except the birds which fly at dawn with the wind.
And after you have spoken to him, you may ask him to take you to his home .'
` That is easier said, ' said the bull.
So the two went on till they came to the hill grazing place, and the lamb was roasted in the oven till it was nice and brown, and the girl put her finger in her mouth and began to sing.
Poor Siroco was a burden to his host, and when he saw how ungrateful she was, he hardened his heart and returned in such a temper that he quite lost his patience, and, smiting him on the cheek, he ran off back to his sheep.
As soon as the lamia was left alone with her lamb the girl called out, ` Come to me, and you will find the most beautiful lamb which ever was born, which ever was fed anywhere, except in the arms of bulls, and which ever so long kept silent .'
` So I will feed thee, ' said the lamb, ` and to thee I will give all the sheep, cattle, and sheep-cars, but I will not leave thee till the last one .'
Then the lamb returned to his mother, bringing with him carpets and soft cushions for the mother and daughter.
When they were in the garden the lamb said to her, ` Dear mother, receive the lamb as a friend, and do not forget me .'
The mother, who felt herself growing old and feeble, took the lamb in her arms, and led him to her.
When they were alone, the lamb asked her, ` And how can a woman live to be over 100 years old ?'
` Oh, I can, ' replied the mother.
` Therefore, since it is thy duty, I will go and do it.
I shall bring the lamb to you, and will climb the tree, and will drop into the river .'
The lamb did as the mother ordered, and by-and-by they came to the river.
The mother now felt that she had been wrong in taking the lamb, and very angry at herself.
` Oh, that was easy !'
said she.
` I knew he would come.
Go and lie down in the bottom, and the water will clothe him.
He will be comforted here until he comes back .'
And by-and-by their friendship grew deeper and deeper ; and at last, after six months, the lamb asked the mother for a third and final month's rent, which he did not fail to provide, in a little time the mother herself appeared to have forgiven her, and was much pleased at the result.
Then the lamb said to his mother : ` Since it is thy duty, I will have thee and me both living at once ; but I will send the sheep to graze in the adjoining pasture, and the cows to drink the water therefrom ; and the flow of the river will be turned into a bath, and we will both be changed in a moment .'
The Lamb thus became acquainted with two people who were living in a castle, and from time to time he had tumbled into their charge, though he never set out to do so.
One of them, who

[2000 | 3395.65] loss=0.20 avg=1.03
Saving checkpoint/run1/model-2000
WARNING:tensorflow:From /tensorflow-1.15.2/python3.6/tensorflow_core/python/training/saver.py:963: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.


*********************************************************
*********************************************************
	model 1 model 1		- end
*********************************************************
*********************************************************

---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------
---------------------------------------------------------



https://research.fb.com/downloads/babi/

The Children’s Book Test
This section presents the Children’s Book Test (CBT), designed to measure directly how well language models can exploit wider linguistic context. The CBT is built from books that are freely available thanks to Project Gutenberg. Details and baseline results on this dataset can be found in the paper:

Felix Hill, Antoine Bordes, Sumit Chopra and Jason Weston. The Goldilocks Principle: Reading Children’s Books with Explicit Memory Representations, arXiv:1511.02301.

After allocating books to either training, validation or test sets, we formed example ‘questions’ from chapters in the book by enumerating 21 consecutive sentences. In each question, the first 20 sentences form the context, and a word is removed from the 21st sentence, which becomes the query. Models must identify the answer word among a selection of 10 candidate answers appearing in the context sentences and the query. For finer-grained analyses, we evaluated four classes of question by removing distinct types of word: Named Entities, (Common) Nouns, Verbs and Prepositions

Here is an example of question (context + query) from Alice in Wonderland by Lewis Carroll:

Context:
1 So they had to fall a long way .	
2 So they got their tails fast in their mouths .	
3 So they could n't get them out again .	
4 That 's all .	
5 `` Thank you , " said Alice , `` it 's very interesting .	
6 I never knew so much about a whiting before . "	
7 `` I can tell you more than that , if you like , " said the Gryphon .	
8 `` Do you know why it 's called a whiting ? "	
9 `` I never thought about it , " said Alice .	
10 `` Why ? "	
11 `` IT DOES THE BOOTS AND SHOES . '	
12 the Gryphon replied very solemnly .	
13 Alice was thoroughly puzzled .	
14 `` Does the boots and shoes ! "	
15 she repeated in a wondering tone .	
16 `` Why , what are YOUR shoes done with ? "	
17 said the Gryphon .	
18 `` I mean , what makes them so shiny ? "	
19 Alice looked down at them , and considered a little before she gave her answer .	
20 `` They 're done with blacking , I believe . "	

Query: `` Boots and shoes under the sea , " the XXXXX went on in a deep voice , `` are done with a whiting ".

Candidates: Alice|BOOTS|Gryphon|SHOES|answer|fall|mouths|tone|way|whiting	
	
Answer: gryphon 
